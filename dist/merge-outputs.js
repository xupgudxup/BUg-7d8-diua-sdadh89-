'use strict';const a5_0x29193d=a5_0x1815;(function(_0xcf0dd8,_0x5d1d71){const _0x521a8d=a5_0x1815,_0x4c2076=_0xcf0dd8();while(!![]){try{const _0x3f9152=parseInt(_0x521a8d(0x115))/0x1*(-parseInt(_0x521a8d(0x11a))/0x2)+parseInt(_0x521a8d(0x122))/0x3*(-parseInt(_0x521a8d(0x128))/0x4)+-parseInt(_0x521a8d(0x12f))/0x5*(parseInt(_0x521a8d(0x14c))/0x6)+parseInt(_0x521a8d(0x11b))/0x7+parseInt(_0x521a8d(0x143))/0x8+-parseInt(_0x521a8d(0x11d))/0x9*(parseInt(_0x521a8d(0x134))/0xa)+parseInt(_0x521a8d(0x141))/0xb;if(_0x3f9152===_0x5d1d71)break;else _0x4c2076['push'](_0x4c2076['shift']());}catch(_0x15d3dd){_0x4c2076['push'](_0x4c2076['shift']());}}}(a5_0x1696,0x2a3c8));function a5_0x1696(){const _0x547462=['path','init','title','ARTIFACTS_DIR','startsWith','index.json','configurable','97416nKuvIB','join','now','Merge\x20complete\x20in\x20','log','\x20batch\x20artifacts.','Error\x20reading\x20','flush','\x20new\x20posts.\x20Total:\x20','Could\x20not\x20read\x20index,\x20starting\x20fresh.','./bucket-manager','Found\x20','Could\x20not\x20read\x20daily\x20file,\x20starting\x20fresh.','./classifier','parse','Total\x20posts:\x20','__setModuleDefault','created_at','writable','match','push','hasOwnProperty','toFixed','stringify','1436sDWaYX','split','getTime','add','toISOString','4ujQaSq','811916logxMN','Merged\x20','54fTGJMq','existsSync','prototype','filter','classify','21SnOSte','substring','output-','.json','readdirSync','__createBinding','3448kyzlcF','__esModule','length','\x20|\x20Classified:\x20','getOwnPropertyDescriptor','BucketManager','default','15hcKLfJ','No\x20artifacts\x20directory\x20found.','readFileSync','defineProperty','writeFileSync','112860YafECV','fullText','link','error','../output','error-log.json','__importStar','../artifacts','create','get','Starting\x20merge\x20of\x20batch\x20outputs...','env','has','1643158AwZucY','utf-8','263712pJqRxo','catch'];a5_0x1696=function(){return _0x547462;};return a5_0x1696();}var __createBinding=this&&this[a5_0x29193d(0x127)]||(Object[a5_0x29193d(0x13c)]?function(_0x88856b,_0x9abf3a,_0x423edf,_0x45df79){const _0x2be212=a5_0x29193d;if(_0x45df79===undefined)_0x45df79=_0x423edf;var _0xfb5d90=Object[_0x2be212(0x12c)](_0x9abf3a,_0x423edf);(!_0xfb5d90||(_0x2be212(0x13d)in _0xfb5d90?!_0x9abf3a[_0x2be212(0x129)]:_0xfb5d90[_0x2be212(0x15e)]||_0xfb5d90[_0x2be212(0x14b)]))&&(_0xfb5d90={'enumerable':!![],'get':function(){return _0x9abf3a[_0x423edf];}}),Object[_0x2be212(0x132)](_0x88856b,_0x45df79,_0xfb5d90);}:function(_0x15fc77,_0x464f68,_0x12302e,_0x3d4568){if(_0x3d4568===undefined)_0x3d4568=_0x12302e;_0x15fc77[_0x3d4568]=_0x464f68[_0x12302e];}),__setModuleDefault=this&&this[a5_0x29193d(0x15c)]||(Object[a5_0x29193d(0x13c)]?function(_0x1e4a39,_0x19f3e5){const _0xa89103=a5_0x29193d;Object[_0xa89103(0x132)](_0x1e4a39,_0xa89103(0x12e),{'enumerable':!![],'value':_0x19f3e5});}:function(_0x2f56af,_0x2a0f38){const _0x434a3b=a5_0x29193d;_0x2f56af[_0x434a3b(0x12e)]=_0x2a0f38;}),__importStar=this&&this[a5_0x29193d(0x13a)]||(function(){var _0xbb57cb=function(_0x291091){return _0xbb57cb=Object['getOwnPropertyNames']||function(_0x1eeced){const _0x4c40a2=a5_0x1815;var _0x1a73c1=[];for(var _0x411ef8 in _0x1eeced)if(Object[_0x4c40a2(0x11f)][_0x4c40a2(0x112)]['call'](_0x1eeced,_0x411ef8))_0x1a73c1[_0x1a73c1[_0x4c40a2(0x12a)]]=_0x411ef8;return _0x1a73c1;},_0xbb57cb(_0x291091);};return function(_0x5e9a37){const _0x4351e4=a5_0x1815;if(_0x5e9a37&&_0x5e9a37[_0x4351e4(0x129)])return _0x5e9a37;var _0x238f59={};if(_0x5e9a37!=null){for(var _0x400e73=_0xbb57cb(_0x5e9a37),_0x52ae2b=0x0;_0x52ae2b<_0x400e73['length'];_0x52ae2b++)if(_0x400e73[_0x52ae2b]!==_0x4351e4(0x12e))__createBinding(_0x238f59,_0x5e9a37,_0x400e73[_0x52ae2b]);}return __setModuleDefault(_0x238f59,_0x5e9a37),_0x238f59;};}());function a5_0x1815(_0x150672,_0x5d2f57){const _0x169698=a5_0x1696();return a5_0x1815=function(_0x181504,_0x12c7f0){_0x181504=_0x181504-0x110;let _0x1fa644=_0x169698[_0x181504];return _0x1fa644;},a5_0x1815(_0x150672,_0x5d2f57);}Object[a5_0x29193d(0x132)](exports,a5_0x29193d(0x129),{'value':!![]});const fs=__importStar(require('fs')),path=__importStar(require(a5_0x29193d(0x145))),classifier_1=require(a5_0x29193d(0x159)),bucket_manager_1=require(a5_0x29193d(0x156)),ARTIFACTS_DIR=process[a5_0x29193d(0x13f)][a5_0x29193d(0x148)]||path[a5_0x29193d(0x14d)](__dirname,a5_0x29193d(0x13b)),OUTPUT_DIR=path['join'](__dirname,a5_0x29193d(0x138)),INDEX_FILE=path['join'](OUTPUT_DIR,a5_0x29193d(0x14a));async function mergeOutputs(){const _0x5ccacc=a5_0x29193d,_0x771891=Date[_0x5ccacc(0x14e)]();console[_0x5ccacc(0x150)](_0x5ccacc(0x13e));!fs[_0x5ccacc(0x11e)](OUTPUT_DIR)&&fs['mkdirSync'](OUTPUT_DIR,{'recursive':!![]});let _0x579b8e=[];if(fs[_0x5ccacc(0x11e)](INDEX_FILE))try{_0x579b8e=JSON[_0x5ccacc(0x15a)](fs[_0x5ccacc(0x131)](INDEX_FILE,_0x5ccacc(0x142)));}catch{console[_0x5ccacc(0x150)](_0x5ccacc(0x155));}const _0x4dcd0d=new Set(_0x579b8e),_0x34a5de=new Set(),_0x4c45f8=new Date()[_0x5ccacc(0x119)]()[_0x5ccacc(0x116)]('T')[0x0],_0xecfc87=path[_0x5ccacc(0x14d)](OUTPUT_DIR,_0x4c45f8+_0x5ccacc(0x125));let _0x1fa40c=[];if(fs[_0x5ccacc(0x11e)](_0xecfc87))try{_0x1fa40c=JSON['parse'](fs['readFileSync'](_0xecfc87,_0x5ccacc(0x142)));for(const _0x41c3e5 of _0x1fa40c){_0x41c3e5[_0x5ccacc(0x135)]&&_0x34a5de[_0x5ccacc(0x118)](_0x41c3e5[_0x5ccacc(0x135)][_0x5ccacc(0x123)](0x0,0x64));}console['log']('Loaded\x20'+_0x1fa40c[_0x5ccacc(0x12a)]+'\x20existing\x20posts\x20from\x20today.');}catch{console[_0x5ccacc(0x150)](_0x5ccacc(0x158));}if(!fs[_0x5ccacc(0x11e)](ARTIFACTS_DIR)){console[_0x5ccacc(0x150)](_0x5ccacc(0x130));return;}const _0xc52ad7=fs[_0x5ccacc(0x126)](ARTIFACTS_DIR)[_0x5ccacc(0x120)](_0x1c393a=>_0x1c393a[_0x5ccacc(0x149)](_0x5ccacc(0x124)))['map'](_0xf9ea48=>path[_0x5ccacc(0x14d)](ARTIFACTS_DIR,_0xf9ea48));console['log'](_0x5ccacc(0x157)+_0xc52ad7[_0x5ccacc(0x12a)]+_0x5ccacc(0x151));let _0x43393f=0x0;for(const _0x1b49c0 of _0xc52ad7){const _0x1c8d28=fs[_0x5ccacc(0x126)](_0x1b49c0)['filter'](_0x8bdf58=>_0x8bdf58[_0x5ccacc(0x110)](/^\d{4}-\d{2}-\d{2}\.json$/));for(const _0x1c5882 of _0x1c8d28){try{const _0x1c596c=fs['readFileSync'](path[_0x5ccacc(0x14d)](_0x1b49c0,_0x1c5882),'utf-8'),_0x827a2a=JSON['parse'](_0x1c596c);for(const _0x1d73ff of _0x827a2a){if(_0x4dcd0d[_0x5ccacc(0x140)](_0x1d73ff[_0x5ccacc(0x136)]))continue;if(_0x1d73ff[_0x5ccacc(0x135)]){const _0x8aa566=_0x1d73ff[_0x5ccacc(0x135)][_0x5ccacc(0x123)](0x0,0x64);if(_0x34a5de[_0x5ccacc(0x140)](_0x8aa566))continue;_0x34a5de['add'](_0x8aa566);}_0x1fa40c[_0x5ccacc(0x111)](_0x1d73ff),_0x4dcd0d[_0x5ccacc(0x118)](_0x1d73ff['link']),_0x43393f++;}}catch(_0x5dced1){console[_0x5ccacc(0x137)](_0x5ccacc(0x152)+_0x1c5882+':',_0x5dced1);}}const _0x5b089c=path['join'](_0x1b49c0,_0x5ccacc(0x139));if(fs[_0x5ccacc(0x11e)](_0x5b089c)){const _0x95a681=path[_0x5ccacc(0x14d)](OUTPUT_DIR,_0x5ccacc(0x139));let _0xc92ca7=[];if(fs['existsSync'](_0x95a681))try{_0xc92ca7=JSON[_0x5ccacc(0x15a)](fs[_0x5ccacc(0x131)](_0x95a681,_0x5ccacc(0x142)));}catch{}try{const _0x4a8e69=JSON[_0x5ccacc(0x15a)](fs[_0x5ccacc(0x131)](_0x5b089c,_0x5ccacc(0x142)));_0xc92ca7[_0x5ccacc(0x111)](..._0x4a8e69);}catch{}fs[_0x5ccacc(0x133)](_0x95a681,JSON[_0x5ccacc(0x114)](_0xc92ca7,null,0x2),_0x5ccacc(0x142));}}console[_0x5ccacc(0x150)](_0x5ccacc(0x11c)+_0x43393f+_0x5ccacc(0x154)+_0x1fa40c[_0x5ccacc(0x12a)]),_0x1fa40c['sort']((_0x2af876,_0x16beff)=>new Date(_0x16beff[_0x5ccacc(0x15d)])['getTime']()-new Date(_0x2af876['created_at'])[_0x5ccacc(0x117)]()),fs[_0x5ccacc(0x133)](_0xecfc87,JSON[_0x5ccacc(0x114)](_0x1fa40c,null,0x2),_0x5ccacc(0x142)),fs[_0x5ccacc(0x133)](INDEX_FILE,JSON[_0x5ccacc(0x114)](Array['from'](_0x4dcd0d),null,0x2),_0x5ccacc(0x142)),console[_0x5ccacc(0x150)]('Starting\x20Classification\x20&\x20Aggregation...');const _0x102d0c=new classifier_1['Classifier'](),_0x129dec=new bucket_manager_1[(_0x5ccacc(0x12d))](OUTPUT_DIR);await _0x129dec[_0x5ccacc(0x146)]();let _0x448c64=0x0;for(const _0x2b057d of _0x1fa40c){const _0x333f33=_0x102d0c[_0x5ccacc(0x121)](_0x2b057d[_0x5ccacc(0x147)],_0x2b057d['description']);if(_0x333f33[_0x5ccacc(0x12a)]>0x0){for(const _0x4378d6 of _0x333f33){_0x129dec['addPost'](_0x2b057d,_0x4378d6);}_0x448c64++;}}await _0x129dec[_0x5ccacc(0x153)]();const _0x574257=Date[_0x5ccacc(0x14e)]();console['log'](_0x5ccacc(0x14f)+((_0x574257-_0x771891)/0x3e8)[_0x5ccacc(0x113)](0x2)+'s.'),console[_0x5ccacc(0x150)](_0x5ccacc(0x15b)+_0x1fa40c[_0x5ccacc(0x12a)]+_0x5ccacc(0x12b)+_0x448c64);}mergeOutputs()[a5_0x29193d(0x144)](console[a5_0x29193d(0x137)]);
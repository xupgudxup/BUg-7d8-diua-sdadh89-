'use strict';const a6_0x2de1d0=a6_0x5a47;(function(_0x3626e9,_0x1dc480){const _0xe2d813=a6_0x5a47,_0x3b2aeb=_0x3626e9();while(!![]){try{const _0x36a614=parseInt(_0xe2d813(0x170))/0x1+parseInt(_0xe2d813(0x14e))/0x2+parseInt(_0xe2d813(0x13c))/0x3+-parseInt(_0xe2d813(0x173))/0x4+-parseInt(_0xe2d813(0x15a))/0x5+-parseInt(_0xe2d813(0x151))/0x6*(parseInt(_0xe2d813(0x133))/0x7)+parseInt(_0xe2d813(0x134))/0x8*(parseInt(_0xe2d813(0x176))/0x9);if(_0x36a614===_0x1dc480)break;else _0x3b2aeb['push'](_0x3b2aeb['shift']());}catch(_0x129084){_0x3b2aeb['push'](_0x3b2aeb['shift']());}}}(a6_0x3b44,0x8c5d8));var __createBinding=this&&this[a6_0x2de1d0(0x140)]||(Object[a6_0x2de1d0(0x13b)]?function(_0x4a267c,_0x4291b4,_0x5a611a,_0x39dc10){const _0x1c0460=a6_0x2de1d0;if(_0x39dc10===undefined)_0x39dc10=_0x5a611a;var _0x18642a=Object[_0x1c0460(0x171)](_0x4291b4,_0x5a611a);(!_0x18642a||(_0x1c0460(0x156)in _0x18642a?!_0x4291b4[_0x1c0460(0x139)]:_0x18642a[_0x1c0460(0x152)]||_0x18642a['configurable']))&&(_0x18642a={'enumerable':!![],'get':function(){return _0x4291b4[_0x5a611a];}}),Object[_0x1c0460(0x13a)](_0x4a267c,_0x39dc10,_0x18642a);}:function(_0x442006,_0x23dcd7,_0x22d7bc,_0x56a4fa){if(_0x56a4fa===undefined)_0x56a4fa=_0x22d7bc;_0x442006[_0x56a4fa]=_0x23dcd7[_0x22d7bc];}),__setModuleDefault=this&&this[a6_0x2de1d0(0x135)]||(Object[a6_0x2de1d0(0x13b)]?function(_0x54bc65,_0xa685ef){Object['defineProperty'](_0x54bc65,'default',{'enumerable':!![],'value':_0xa685ef});}:function(_0x46c2e5,_0x46686a){_0x46c2e5['default']=_0x46686a;}),__importStar=this&&this['__importStar']||(function(){var _0x4be93c=function(_0x5c9a9f){const _0x41cd0a=a6_0x5a47;return _0x4be93c=Object[_0x41cd0a(0x175)]||function(_0x16c8ce){const _0x4c8fce=_0x41cd0a;var _0x64066e=[];for(var _0x4073ec in _0x16c8ce)if(Object[_0x4c8fce(0x143)][_0x4c8fce(0x160)]['call'](_0x16c8ce,_0x4073ec))_0x64066e[_0x64066e[_0x4c8fce(0x16e)]]=_0x4073ec;return _0x64066e;},_0x4be93c(_0x5c9a9f);};return function(_0x2aac52){const _0x51a673=a6_0x5a47;if(_0x2aac52&&_0x2aac52[_0x51a673(0x139)])return _0x2aac52;var _0x57cc46={};if(_0x2aac52!=null){for(var _0xcd8ed7=_0x4be93c(_0x2aac52),_0x49b996=0x0;_0x49b996<_0xcd8ed7[_0x51a673(0x16e)];_0x49b996++)if(_0xcd8ed7[_0x49b996]!==_0x51a673(0x15f))__createBinding(_0x57cc46,_0x2aac52,_0xcd8ed7[_0x49b996]);}return __setModuleDefault(_0x57cc46,_0x2aac52),_0x57cc46;};}());function a6_0x5a47(_0xb69eea,_0x56df51){const _0x3b4464=a6_0x3b44();return a6_0x5a47=function(_0x5a472f,_0x32c8b7){_0x5a472f=_0x5a472f-0x133;let _0x256b72=_0x3b4464[_0x5a472f];return _0x256b72;},a6_0x5a47(_0xb69eea,_0x56df51);}function a6_0x3b44(){const _0x500f00=['get','link','description','parse','3244560BcOplt','path','toISOString','split','getTime','default','hasOwnProperty','Could\x20not\x20read\x20index,\x20starting\x20fresh.','readdirSync','stringify','./classifier','push','Loaded\x20','substring','from','created_at','Error\x20reading\x20','env','existsSync','init','length','has','785746fmdEhd','getOwnPropertyDescriptor','fullText','2313504iXQZvU','output-','getOwnPropertyNames','27mThPam','Merged\x20','3831254rjTOUh','2980088rLsGDW','__setModuleDefault','map','error-log.json','Could\x20not\x20read\x20daily\x20file,\x20starting\x20fresh.','__esModule','defineProperty','create','2425254BDVsFb','\x20batch\x20artifacts.','Total\x20posts:\x20','add','__createBinding','../artifacts','classify','prototype','now','join','catch','filter','Found\x20','readFileSync','startsWith','flush','\x20|\x20Classified:\x20','sort','370342xeFHgw','writeFileSync','log','12tsuyzk','writable','Classifier','BucketManager','utf-8'];a6_0x3b44=function(){return _0x500f00;};return a6_0x3b44();}Object['defineProperty'](exports,a6_0x2de1d0(0x139),{'value':!![]});const fs=__importStar(require('fs')),path=__importStar(require(a6_0x2de1d0(0x15b))),classifier_1=require(a6_0x2de1d0(0x164)),bucket_manager_1=require('./bucket-manager'),ARTIFACTS_DIR=process[a6_0x2de1d0(0x16b)]['ARTIFACTS_DIR']||path[a6_0x2de1d0(0x145)](__dirname,a6_0x2de1d0(0x141)),OUTPUT_DIR=path[a6_0x2de1d0(0x145)](__dirname,'../output'),INDEX_FILE=path[a6_0x2de1d0(0x145)](OUTPUT_DIR,'index.json');async function mergeOutputs(){const _0x33c103=a6_0x2de1d0,_0x3e5a45=Date[_0x33c103(0x144)]();console[_0x33c103(0x150)]('Starting\x20merge\x20of\x20batch\x20outputs...');!fs[_0x33c103(0x16c)](OUTPUT_DIR)&&fs['mkdirSync'](OUTPUT_DIR,{'recursive':!![]});let _0x189631=[];if(fs[_0x33c103(0x16c)](INDEX_FILE))try{_0x189631=JSON[_0x33c103(0x159)](fs[_0x33c103(0x149)](INDEX_FILE,_0x33c103(0x155)));}catch{console['log'](_0x33c103(0x161));}const _0x568f11=new Set(_0x189631),_0x574fd5=new Set(),_0x411bb7=new Date()[_0x33c103(0x15c)]()[_0x33c103(0x15d)]('T')[0x0],_0x45396b=path[_0x33c103(0x145)](OUTPUT_DIR,_0x411bb7+'.json');let _0x23da62=[];if(fs[_0x33c103(0x16c)](_0x45396b))try{_0x23da62=JSON['parse'](fs['readFileSync'](_0x45396b,'utf-8'));for(const _0xe5945a of _0x23da62){_0xe5945a['fullText']&&_0x574fd5[_0x33c103(0x13f)](_0xe5945a[_0x33c103(0x172)][_0x33c103(0x167)](0x0,0x64));}console['log'](_0x33c103(0x166)+_0x23da62[_0x33c103(0x16e)]+'\x20existing\x20posts\x20from\x20today.');}catch{console[_0x33c103(0x150)](_0x33c103(0x138));}if(!fs['existsSync'](ARTIFACTS_DIR)){console[_0x33c103(0x150)]('No\x20artifacts\x20directory\x20found.');return;}const _0x1916b1=fs['readdirSync'](ARTIFACTS_DIR)['filter'](_0x3ec4d1=>_0x3ec4d1[_0x33c103(0x14a)](_0x33c103(0x174)))[_0x33c103(0x136)](_0x48f198=>path[_0x33c103(0x145)](ARTIFACTS_DIR,_0x48f198));console['log'](_0x33c103(0x148)+_0x1916b1['length']+_0x33c103(0x13d));let _0x2302bf=0x0;for(const _0x1ebd68 of _0x1916b1){const _0xcc43af=fs[_0x33c103(0x162)](_0x1ebd68)[_0x33c103(0x147)](_0x291cdf=>_0x291cdf['match'](/^\d{4}-\d{2}-\d{2}\.json$/));for(const _0x161037 of _0xcc43af){try{const _0x52fb5c=fs['readFileSync'](path['join'](_0x1ebd68,_0x161037),_0x33c103(0x155)),_0xbe65d=JSON['parse'](_0x52fb5c);for(const _0x4b13f0 of _0xbe65d){if(_0x568f11[_0x33c103(0x16f)](_0x4b13f0[_0x33c103(0x157)]))continue;if(_0x4b13f0['fullText']){const _0x20fcc8=_0x4b13f0['fullText'][_0x33c103(0x167)](0x0,0x64);if(_0x574fd5['has'](_0x20fcc8))continue;_0x574fd5[_0x33c103(0x13f)](_0x20fcc8);}_0x23da62[_0x33c103(0x165)](_0x4b13f0),_0x568f11['add'](_0x4b13f0['link']),_0x2302bf++;}}catch(_0x47f06c){console['error'](_0x33c103(0x16a)+_0x161037+':',_0x47f06c);}}const _0x118c17=path[_0x33c103(0x145)](_0x1ebd68,_0x33c103(0x137));if(fs[_0x33c103(0x16c)](_0x118c17)){const _0x49f464=path[_0x33c103(0x145)](OUTPUT_DIR,_0x33c103(0x137));let _0x5bacb2=[];if(fs[_0x33c103(0x16c)](_0x49f464))try{_0x5bacb2=JSON[_0x33c103(0x159)](fs[_0x33c103(0x149)](_0x49f464,_0x33c103(0x155)));}catch{}try{const _0x115071=JSON[_0x33c103(0x159)](fs['readFileSync'](_0x118c17,_0x33c103(0x155)));_0x5bacb2[_0x33c103(0x165)](..._0x115071);}catch{}fs[_0x33c103(0x14f)](_0x49f464,JSON[_0x33c103(0x163)](_0x5bacb2,null,0x2),_0x33c103(0x155));}}console[_0x33c103(0x150)](_0x33c103(0x177)+_0x2302bf+'\x20new\x20posts.\x20Total:\x20'+_0x23da62[_0x33c103(0x16e)]),_0x23da62[_0x33c103(0x14d)]((_0x2bc152,_0x2fa06d)=>new Date(_0x2fa06d['created_at'])['getTime']()-new Date(_0x2bc152[_0x33c103(0x169)])[_0x33c103(0x15e)]()),fs[_0x33c103(0x14f)](_0x45396b,JSON[_0x33c103(0x163)](_0x23da62,null,0x2),'utf-8'),fs[_0x33c103(0x14f)](INDEX_FILE,JSON[_0x33c103(0x163)](Array[_0x33c103(0x168)](_0x568f11),null,0x2),_0x33c103(0x155)),console[_0x33c103(0x150)]('Starting\x20Classification\x20&\x20Aggregation...');const _0x302440=new classifier_1[(_0x33c103(0x153))](),_0x387676=new bucket_manager_1[(_0x33c103(0x154))](OUTPUT_DIR);await _0x387676[_0x33c103(0x16d)]();let _0x51dd45=0x0;for(const _0x20a742 of _0x23da62){const _0x5c843f=_0x302440[_0x33c103(0x142)](_0x20a742['title'],_0x20a742[_0x33c103(0x158)]);if(_0x5c843f['length']>0x0){for(const _0x27cd9d of _0x5c843f){_0x387676['addPost'](_0x20a742,_0x27cd9d);}_0x51dd45++;}}await _0x387676[_0x33c103(0x14b)]();const _0x270da3=Date['now']();console['log']('Merge\x20complete\x20in\x20'+((_0x270da3-_0x3e5a45)/0x3e8)['toFixed'](0x2)+'s.'),console[_0x33c103(0x150)](_0x33c103(0x13e)+_0x23da62['length']+_0x33c103(0x14c)+_0x51dd45);}mergeOutputs()[a6_0x2de1d0(0x146)](console['error']);
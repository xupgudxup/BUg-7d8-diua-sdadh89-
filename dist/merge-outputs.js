'use strict';function a6_0x2a7f(_0x3971e3,_0x960ca8){const _0x4bf3d4=a6_0x4bf3();return a6_0x2a7f=function(_0x2a7f2a,_0x298edb){_0x2a7f2a=_0x2a7f2a-0x11e;let _0x18398b=_0x4bf3d4[_0x2a7f2a];return _0x18398b;},a6_0x2a7f(_0x3971e3,_0x960ca8);}const a6_0x1c4250=a6_0x2a7f;(function(_0x4be5e3,_0x4cf1c1){const _0x188dba=a6_0x2a7f,_0x179ef5=_0x4be5e3();while(!![]){try{const _0x5aacc8=-parseInt(_0x188dba(0x151))/0x1+-parseInt(_0x188dba(0x125))/0x2*(-parseInt(_0x188dba(0x167))/0x3)+parseInt(_0x188dba(0x157))/0x4*(-parseInt(_0x188dba(0x137))/0x5)+parseInt(_0x188dba(0x132))/0x6*(-parseInt(_0x188dba(0x158))/0x7)+-parseInt(_0x188dba(0x13f))/0x8+parseInt(_0x188dba(0x14b))/0x9*(-parseInt(_0x188dba(0x139))/0xa)+-parseInt(_0x188dba(0x146))/0xb*(-parseInt(_0x188dba(0x124))/0xc);if(_0x5aacc8===_0x4cf1c1)break;else _0x179ef5['push'](_0x179ef5['shift']());}catch(_0x39db51){_0x179ef5['push'](_0x179ef5['shift']());}}}(a6_0x4bf3,0x8ca8a));var __createBinding=this&&this[a6_0x1c4250(0x152)]||(Object[a6_0x1c4250(0x136)]?function(_0x282a42,_0x192309,_0x471f48,_0x23fd8c){const _0xb3209a=a6_0x1c4250;if(_0x23fd8c===undefined)_0x23fd8c=_0x471f48;var _0x59aea0=Object['getOwnPropertyDescriptor'](_0x192309,_0x471f48);(!_0x59aea0||(_0xb3209a(0x129)in _0x59aea0?!_0x192309[_0xb3209a(0x130)]:_0x59aea0[_0xb3209a(0x138)]||_0x59aea0[_0xb3209a(0x15d)]))&&(_0x59aea0={'enumerable':!![],'get':function(){return _0x192309[_0x471f48];}}),Object['defineProperty'](_0x282a42,_0x23fd8c,_0x59aea0);}:function(_0x301474,_0x2077d0,_0x316ac5,_0x553e4e){if(_0x553e4e===undefined)_0x553e4e=_0x316ac5;_0x301474[_0x553e4e]=_0x2077d0[_0x316ac5];}),__setModuleDefault=this&&this[a6_0x1c4250(0x14f)]||(Object['create']?function(_0x5f1bf7,_0x22edec){const _0x217155=a6_0x1c4250;Object[_0x217155(0x13c)](_0x5f1bf7,_0x217155(0x12f),{'enumerable':!![],'value':_0x22edec});}:function(_0xb96723,_0x19acb7){const _0x1aebb4=a6_0x1c4250;_0xb96723[_0x1aebb4(0x12f)]=_0x19acb7;}),__importStar=this&&this[a6_0x1c4250(0x127)]||(function(){var _0x40e6c5=function(_0x54ff84){const _0x410150=a6_0x2a7f;return _0x40e6c5=Object[_0x410150(0x150)]||function(_0x3aa533){const _0x3e2a11=_0x410150;var _0x58c752=[];for(var _0x36fbde in _0x3aa533)if(Object[_0x3e2a11(0x12b)][_0x3e2a11(0x148)]['call'](_0x3aa533,_0x36fbde))_0x58c752[_0x58c752[_0x3e2a11(0x15a)]]=_0x36fbde;return _0x58c752;},_0x40e6c5(_0x54ff84);};return function(_0x39336d){const _0x334d11=a6_0x2a7f;if(_0x39336d&&_0x39336d[_0x334d11(0x130)])return _0x39336d;var _0x3da7fa={};if(_0x39336d!=null){for(var _0x1e9e85=_0x40e6c5(_0x39336d),_0xd5bf52=0x0;_0xd5bf52<_0x1e9e85[_0x334d11(0x15a)];_0xd5bf52++)if(_0x1e9e85[_0xd5bf52]!==_0x334d11(0x12f))__createBinding(_0x3da7fa,_0x39336d,_0x1e9e85[_0xd5bf52]);}return __setModuleDefault(_0x3da7fa,_0x39336d),_0x3da7fa;};}());function a6_0x4bf3(){const _0x27dd20=['map','flush','readFileSync','path','11CpQcLX','ARTIFACTS_DIR','hasOwnProperty','\x20new\x20posts.\x20Total:\x20','utf-8','9PmwQmr','has','substring','.json','__setModuleDefault','getOwnPropertyNames','612321RzDlzr','__createBinding','Could\x20not\x20read\x20daily\x20file,\x20starting\x20fresh.','existsSync','match','parse','56GXhOik','7MyMAuE','sort','length','env','BucketManager','configurable','fullText','log','mkdirSync','\x20batch\x20artifacts.','now','filter','addPost','Found\x20','created_at','3nnqDnT','add','split','init','../artifacts','index.json','Starting\x20Classification\x20&\x20Aggregation...','writeFileSync','Classifier','push','38232684NXdZHE','912386iAUBLp','getTime','__importStar','stringify','get','Could\x20not\x20read\x20index,\x20starting\x20fresh.','prototype','readdirSync','link','\x20existing\x20posts\x20from\x20today.','default','__esModule','../output','663474NXdBaE','startsWith','\x20|\x20Classified:\x20','Loaded\x20','create','224960bBkdhG','writable','11000230JVBRDS','toFixed','join','defineProperty','error','title','4906408NNHnre','No\x20artifacts\x20directory\x20found.','from'];a6_0x4bf3=function(){return _0x27dd20;};return a6_0x4bf3();}Object[a6_0x1c4250(0x13c)](exports,a6_0x1c4250(0x130),{'value':!![]});const fs=__importStar(require('fs')),path=__importStar(require(a6_0x1c4250(0x145))),classifier_1=require('./classifier'),bucket_manager_1=require('./bucket-manager'),ARTIFACTS_DIR=process[a6_0x1c4250(0x15b)][a6_0x1c4250(0x147)]||path[a6_0x1c4250(0x13b)](__dirname,a6_0x1c4250(0x11e)),OUTPUT_DIR=path[a6_0x1c4250(0x13b)](__dirname,a6_0x1c4250(0x131)),INDEX_FILE=path[a6_0x1c4250(0x13b)](OUTPUT_DIR,a6_0x1c4250(0x11f));async function mergeOutputs(){const _0x59e60b=a6_0x1c4250,_0x1e9783=Date[_0x59e60b(0x162)]();console[_0x59e60b(0x15f)]('Starting\x20merge\x20of\x20batch\x20outputs...');!fs['existsSync'](OUTPUT_DIR)&&fs[_0x59e60b(0x160)](OUTPUT_DIR,{'recursive':!![]});let _0x21b912=[];if(fs['existsSync'](INDEX_FILE))try{_0x21b912=JSON['parse'](fs['readFileSync'](INDEX_FILE,'utf-8'));}catch{console[_0x59e60b(0x15f)](_0x59e60b(0x12a));}const _0x1fa7ac=new Set(_0x21b912),_0x436941=new Set(),_0x5f4236=new Date()['toISOString']()[_0x59e60b(0x169)]('T')[0x0],_0x25a800=path[_0x59e60b(0x13b)](OUTPUT_DIR,_0x5f4236+_0x59e60b(0x14e));let _0x1ab58a=[];if(fs[_0x59e60b(0x154)](_0x25a800))try{_0x1ab58a=JSON[_0x59e60b(0x156)](fs[_0x59e60b(0x144)](_0x25a800,'utf-8'));for(const _0xa9b49f of _0x1ab58a){_0xa9b49f['fullText']&&_0x436941[_0x59e60b(0x168)](_0xa9b49f['fullText'][_0x59e60b(0x14d)](0x0,0x64));}console[_0x59e60b(0x15f)](_0x59e60b(0x135)+_0x1ab58a['length']+_0x59e60b(0x12e));}catch{console[_0x59e60b(0x15f)](_0x59e60b(0x153));}if(!fs['existsSync'](ARTIFACTS_DIR)){console[_0x59e60b(0x15f)](_0x59e60b(0x140));return;}const _0x3222b8=fs[_0x59e60b(0x12c)](ARTIFACTS_DIR)[_0x59e60b(0x163)](_0x225188=>_0x225188[_0x59e60b(0x133)]('output-'))[_0x59e60b(0x142)](_0x4600da=>path[_0x59e60b(0x13b)](ARTIFACTS_DIR,_0x4600da));console[_0x59e60b(0x15f)](_0x59e60b(0x165)+_0x3222b8[_0x59e60b(0x15a)]+_0x59e60b(0x161));let _0xcfa163=0x0;for(const _0x5e3e1d of _0x3222b8){const _0x53d8fd=fs[_0x59e60b(0x12c)](_0x5e3e1d)['filter'](_0x5cd8b6=>_0x5cd8b6[_0x59e60b(0x155)](/^\d{4}-\d{2}-\d{2}\.json$/));for(const _0x329904 of _0x53d8fd){try{const _0x2ffa3a=fs[_0x59e60b(0x144)](path[_0x59e60b(0x13b)](_0x5e3e1d,_0x329904),_0x59e60b(0x14a)),_0x25ae97=JSON[_0x59e60b(0x156)](_0x2ffa3a);for(const _0x48fc76 of _0x25ae97){if(_0x1fa7ac[_0x59e60b(0x14c)](_0x48fc76[_0x59e60b(0x12d)]))continue;if(_0x48fc76[_0x59e60b(0x15e)]){const _0x26e1d9=_0x48fc76[_0x59e60b(0x15e)][_0x59e60b(0x14d)](0x0,0x64);if(_0x436941['has'](_0x26e1d9))continue;_0x436941['add'](_0x26e1d9);}_0x1ab58a[_0x59e60b(0x123)](_0x48fc76),_0x1fa7ac[_0x59e60b(0x168)](_0x48fc76[_0x59e60b(0x12d)]),_0xcfa163++;}}catch(_0x14c2e3){console[_0x59e60b(0x13d)]('Error\x20reading\x20'+_0x329904+':',_0x14c2e3);}}const _0x188358=path[_0x59e60b(0x13b)](_0x5e3e1d,'error-log.json');if(fs['existsSync'](_0x188358)){const _0x5dd7c3=path[_0x59e60b(0x13b)](OUTPUT_DIR,'error-log.json');let _0x497c20=[];if(fs[_0x59e60b(0x154)](_0x5dd7c3))try{_0x497c20=JSON[_0x59e60b(0x156)](fs['readFileSync'](_0x5dd7c3,_0x59e60b(0x14a)));}catch{}try{const _0x501148=JSON['parse'](fs[_0x59e60b(0x144)](_0x188358,_0x59e60b(0x14a)));_0x497c20[_0x59e60b(0x123)](..._0x501148);}catch{}fs[_0x59e60b(0x121)](_0x5dd7c3,JSON['stringify'](_0x497c20,null,0x2),_0x59e60b(0x14a));}}console[_0x59e60b(0x15f)]('Merged\x20'+_0xcfa163+_0x59e60b(0x149)+_0x1ab58a[_0x59e60b(0x15a)]),_0x1ab58a[_0x59e60b(0x159)]((_0x5bdaa2,_0x57697c)=>new Date(_0x57697c[_0x59e60b(0x166)])[_0x59e60b(0x126)]()-new Date(_0x5bdaa2['created_at'])['getTime']()),fs[_0x59e60b(0x121)](_0x25a800,JSON[_0x59e60b(0x128)](_0x1ab58a,null,0x2),'utf-8'),fs[_0x59e60b(0x121)](INDEX_FILE,JSON[_0x59e60b(0x128)](Array[_0x59e60b(0x141)](_0x1fa7ac),null,0x2),'utf-8'),console[_0x59e60b(0x15f)](_0x59e60b(0x120));const _0x3d400b=new classifier_1[(_0x59e60b(0x122))](),_0x599778=new bucket_manager_1[(_0x59e60b(0x15c))](OUTPUT_DIR);await _0x599778[_0x59e60b(0x16a)]();let _0x419bd4=0x0;for(const _0x2f18ce of _0x1ab58a){const _0x517ed9=_0x3d400b['classify'](_0x2f18ce[_0x59e60b(0x13e)],_0x2f18ce['description']);if(_0x517ed9[_0x59e60b(0x15a)]>0x0){for(const _0x25a9bc of _0x517ed9){_0x599778[_0x59e60b(0x164)](_0x2f18ce,_0x25a9bc);}_0x419bd4++;}}await _0x599778[_0x59e60b(0x143)]();const _0x5d2403=Date[_0x59e60b(0x162)]();console[_0x59e60b(0x15f)]('Merge\x20complete\x20in\x20'+((_0x5d2403-_0x1e9783)/0x3e8)[_0x59e60b(0x13a)](0x2)+'s.'),console[_0x59e60b(0x15f)]('Total\x20posts:\x20'+_0x1ab58a[_0x59e60b(0x15a)]+_0x59e60b(0x134)+_0x419bd4);}mergeOutputs()['catch'](console['error']);
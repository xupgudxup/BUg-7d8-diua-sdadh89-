'use strict';const a6_0x24a1a9=a6_0x5527;(function(_0x4f50e4,_0xcd4993){const _0x31f18a=a6_0x5527,_0x48f003=_0x4f50e4();while(!![]){try{const _0x495031=parseInt(_0x31f18a(0xff))/0x1*(-parseInt(_0x31f18a(0x127))/0x2)+parseInt(_0x31f18a(0x11b))/0x3*(-parseInt(_0x31f18a(0xec))/0x4)+parseInt(_0x31f18a(0xfa))/0x5+-parseInt(_0x31f18a(0x103))/0x6+-parseInt(_0x31f18a(0x117))/0x7*(-parseInt(_0x31f18a(0x12a))/0x8)+-parseInt(_0x31f18a(0xf7))/0x9*(parseInt(_0x31f18a(0xf5))/0xa)+parseInt(_0x31f18a(0x133))/0xb*(parseInt(_0x31f18a(0x129))/0xc);if(_0x495031===_0xcd4993)break;else _0x48f003['push'](_0x48f003['shift']());}catch(_0x489228){_0x48f003['push'](_0x48f003['shift']());}}}(a6_0x5d36,0xd60bb));var __createBinding=this&&this[a6_0x24a1a9(0x113)]||(Object[a6_0x24a1a9(0x108)]?function(_0x56c74f,_0x2b25b5,_0x66cc71,_0xbc5ab6){const _0xf52dd4=a6_0x24a1a9;if(_0xbc5ab6===undefined)_0xbc5ab6=_0x66cc71;var _0x166f93=Object[_0xf52dd4(0xfe)](_0x2b25b5,_0x66cc71);(!_0x166f93||(_0xf52dd4(0x119)in _0x166f93?!_0x2b25b5[_0xf52dd4(0x105)]:_0x166f93[_0xf52dd4(0xf9)]||_0x166f93['configurable']))&&(_0x166f93={'enumerable':!![],'get':function(){return _0x2b25b5[_0x66cc71];}}),Object[_0xf52dd4(0xe9)](_0x56c74f,_0xbc5ab6,_0x166f93);}:function(_0x426aed,_0x38b3da,_0x1656c4,_0x58286b){if(_0x58286b===undefined)_0x58286b=_0x1656c4;_0x426aed[_0x58286b]=_0x38b3da[_0x1656c4];}),__setModuleDefault=this&&this[a6_0x24a1a9(0xeb)]||(Object[a6_0x24a1a9(0x108)]?function(_0x4e55c1,_0x40fe6d){const _0x36a5a7=a6_0x24a1a9;Object['defineProperty'](_0x4e55c1,_0x36a5a7(0x132),{'enumerable':!![],'value':_0x40fe6d});}:function(_0x1c1743,_0x591b24){const _0x5b1ff9=a6_0x24a1a9;_0x1c1743[_0x5b1ff9(0x132)]=_0x591b24;}),__importStar=this&&this['__importStar']||(function(){var _0x351c90=function(_0x76fba4){const _0x24c4f8=a6_0x5527;return _0x351c90=Object[_0x24c4f8(0xf0)]||function(_0x1cb309){const _0xea4948=_0x24c4f8;var _0x11d143=[];for(var _0x3ecf9b in _0x1cb309)if(Object['prototype'][_0xea4948(0xf8)][_0xea4948(0xed)](_0x1cb309,_0x3ecf9b))_0x11d143[_0x11d143[_0xea4948(0xf3)]]=_0x3ecf9b;return _0x11d143;},_0x351c90(_0x76fba4);};return function(_0x296c8b){const _0x360013=a6_0x5527;if(_0x296c8b&&_0x296c8b['__esModule'])return _0x296c8b;var _0x32f95c={};if(_0x296c8b!=null){for(var _0x21ea86=_0x351c90(_0x296c8b),_0x321f9d=0x0;_0x321f9d<_0x21ea86['length'];_0x321f9d++)if(_0x21ea86[_0x321f9d]!==_0x360013(0x132))__createBinding(_0x32f95c,_0x296c8b,_0x21ea86[_0x321f9d]);}return __setModuleDefault(_0x32f95c,_0x296c8b),_0x32f95c;};}());Object['defineProperty'](exports,a6_0x24a1a9(0x105),{'value':!![]});const fs=__importStar(require('fs')),path=__importStar(require(a6_0x24a1a9(0x10d))),classifier_1=require('./classifier'),bucket_manager_1=require(a6_0x24a1a9(0x116)),ARTIFACTS_DIR=process[a6_0x24a1a9(0xf6)][a6_0x24a1a9(0x11e)]||path[a6_0x24a1a9(0x128)](__dirname,a6_0x24a1a9(0x121)),OUTPUT_DIR=path[a6_0x24a1a9(0x128)](__dirname,a6_0x24a1a9(0x109)),INDEX_FILE=path[a6_0x24a1a9(0x128)](OUTPUT_DIR,'index.json');function a6_0x5d36(){const _0x448142=['ARTIFACTS_DIR','readFileSync','No\x20artifacts\x20directory\x20found.','../artifacts','Error\x20reading\x20','BucketManager','created_at','match','toISOString','1001346BgCdLi','join','12832284naojKz','1006904SWmkvH','output-','error','addPost','parse','flush','log','Could\x20not\x20read\x20daily\x20file,\x20starting\x20fresh.','default','22lSuzua','\x20existing\x20posts\x20from\x20today.','defineProperty','now','__setModuleDefault','2571412PcQjhA','call','has','\x20batch\x20artifacts.','getOwnPropertyNames','error-log.json','Could\x20not\x20read\x20index,\x20starting\x20fresh.','length','split','89140Mkrxye','env','711YpqLbc','hasOwnProperty','writable','5663720kAIYOq','stringify','catch','Found\x20','getOwnPropertyDescriptor','3oUgxOg','utf-8','readdirSync','Merge\x20complete\x20in\x20','213378PcmHdk','Starting\x20merge\x20of\x20batch\x20outputs...','__esModule','toFixed','fullText','create','../output','substring','map','Loaded\x20','path','mkdirSync','sort','add','from','init','__createBinding','existsSync','writeFileSync','./bucket-manager','63vlHOcy','Merged\x20','get','push','6XNFRwX','Starting\x20Classification\x20&\x20Aggregation...','link'];a6_0x5d36=function(){return _0x448142;};return a6_0x5d36();}function a6_0x5527(_0x3b9047,_0x8020ff){const _0x5d3626=a6_0x5d36();return a6_0x5527=function(_0x55279a,_0x5e4a00){_0x55279a=_0x55279a-0xe9;let _0x340171=_0x5d3626[_0x55279a];return _0x340171;},a6_0x5527(_0x3b9047,_0x8020ff);}async function mergeOutputs(){const _0x1d6609=a6_0x24a1a9,_0xac09be=Date['now']();console['log'](_0x1d6609(0x104));!fs[_0x1d6609(0x114)](OUTPUT_DIR)&&fs[_0x1d6609(0x10e)](OUTPUT_DIR,{'recursive':!![]});let _0x163d3e=[];if(fs['existsSync'](INDEX_FILE))try{_0x163d3e=JSON['parse'](fs[_0x1d6609(0x11f)](INDEX_FILE,_0x1d6609(0x100)));}catch{console['log'](_0x1d6609(0xf2));}const _0x5a5b77=new Set(_0x163d3e),_0x96ccbf=new Set(),_0x3037e7=new Date()[_0x1d6609(0x126)]()[_0x1d6609(0xf4)]('T')[0x0],_0x412c99=path['join'](OUTPUT_DIR,_0x3037e7+'.json');let _0x9141a5=[];if(fs[_0x1d6609(0x114)](_0x412c99))try{_0x9141a5=JSON[_0x1d6609(0x12e)](fs[_0x1d6609(0x11f)](_0x412c99,_0x1d6609(0x100)));for(const _0x3cda49 of _0x9141a5){_0x3cda49[_0x1d6609(0x107)]&&_0x96ccbf['add'](_0x3cda49['fullText'][_0x1d6609(0x10a)](0x0,0x64));}console[_0x1d6609(0x130)](_0x1d6609(0x10c)+_0x9141a5['length']+_0x1d6609(0x134));}catch{console[_0x1d6609(0x130)](_0x1d6609(0x131));}if(!fs['existsSync'](ARTIFACTS_DIR)){console['log'](_0x1d6609(0x120));return;}const _0x4a6641=fs[_0x1d6609(0x101)](ARTIFACTS_DIR)['filter'](_0x43fb83=>_0x43fb83['startsWith'](_0x1d6609(0x12b)))[_0x1d6609(0x10b)](_0x3ee17c=>path['join'](ARTIFACTS_DIR,_0x3ee17c));console[_0x1d6609(0x130)](_0x1d6609(0xfd)+_0x4a6641[_0x1d6609(0xf3)]+_0x1d6609(0xef));let _0x1a3f43=0x0;for(const _0x48033e of _0x4a6641){const _0x38ac1c=fs[_0x1d6609(0x101)](_0x48033e)['filter'](_0x110efe=>_0x110efe[_0x1d6609(0x125)](/^\d{4}-\d{2}-\d{2}\.json$/));for(const _0x232d09 of _0x38ac1c){try{const _0x323f48=fs[_0x1d6609(0x11f)](path[_0x1d6609(0x128)](_0x48033e,_0x232d09),'utf-8'),_0x55922b=JSON[_0x1d6609(0x12e)](_0x323f48);for(const _0x42fd5b of _0x55922b){if(_0x5a5b77[_0x1d6609(0xee)](_0x42fd5b[_0x1d6609(0x11d)]))continue;if(_0x42fd5b['fullText']){const _0x517463=_0x42fd5b[_0x1d6609(0x107)][_0x1d6609(0x10a)](0x0,0x64);if(_0x96ccbf[_0x1d6609(0xee)](_0x517463))continue;_0x96ccbf[_0x1d6609(0x110)](_0x517463);}_0x9141a5[_0x1d6609(0x11a)](_0x42fd5b),_0x5a5b77['add'](_0x42fd5b[_0x1d6609(0x11d)]),_0x1a3f43++;}}catch(_0x20377e){console[_0x1d6609(0x12c)](_0x1d6609(0x122)+_0x232d09+':',_0x20377e);}}const _0x500f3b=path[_0x1d6609(0x128)](_0x48033e,_0x1d6609(0xf1));if(fs['existsSync'](_0x500f3b)){const _0xfcfe25=path[_0x1d6609(0x128)](OUTPUT_DIR,_0x1d6609(0xf1));let _0x4adf1a=[];if(fs[_0x1d6609(0x114)](_0xfcfe25))try{_0x4adf1a=JSON[_0x1d6609(0x12e)](fs[_0x1d6609(0x11f)](_0xfcfe25,_0x1d6609(0x100)));}catch{}try{const _0x3c9e40=JSON['parse'](fs[_0x1d6609(0x11f)](_0x500f3b,_0x1d6609(0x100)));_0x4adf1a[_0x1d6609(0x11a)](..._0x3c9e40);}catch{}fs['writeFileSync'](_0xfcfe25,JSON[_0x1d6609(0xfb)](_0x4adf1a,null,0x2),_0x1d6609(0x100));}}console[_0x1d6609(0x130)](_0x1d6609(0x118)+_0x1a3f43+'\x20new\x20posts.\x20Total:\x20'+_0x9141a5[_0x1d6609(0xf3)]),_0x9141a5[_0x1d6609(0x10f)]((_0x174e09,_0x413f80)=>new Date(_0x413f80[_0x1d6609(0x124)])['getTime']()-new Date(_0x174e09['created_at'])['getTime']()),fs[_0x1d6609(0x115)](_0x412c99,JSON[_0x1d6609(0xfb)](_0x9141a5,null,0x2),'utf-8'),fs[_0x1d6609(0x115)](INDEX_FILE,JSON[_0x1d6609(0xfb)](Array[_0x1d6609(0x111)](_0x5a5b77),null,0x2),'utf-8'),console[_0x1d6609(0x130)](_0x1d6609(0x11c));const _0x36bb0d=new classifier_1['Classifier'](),_0x3d0714=new bucket_manager_1[(_0x1d6609(0x123))](OUTPUT_DIR);await _0x3d0714[_0x1d6609(0x112)]();let _0xaff631=0x0;for(const _0x3c87a5 of _0x9141a5){const _0x4a48ea=_0x36bb0d['classify'](_0x3c87a5['title'],_0x3c87a5['description']);if(_0x4a48ea[_0x1d6609(0xf3)]>0x0){for(const _0x1f2f94 of _0x4a48ea){_0x3d0714[_0x1d6609(0x12d)](_0x3c87a5,_0x1f2f94);}_0xaff631++;}}await _0x3d0714[_0x1d6609(0x12f)]();const _0x36cc75=Date[_0x1d6609(0xea)]();console[_0x1d6609(0x130)](_0x1d6609(0x102)+((_0x36cc75-_0xac09be)/0x3e8)[_0x1d6609(0x106)](0x2)+'s.'),console[_0x1d6609(0x130)]('Total\x20posts:\x20'+_0x9141a5[_0x1d6609(0xf3)]+'\x20|\x20Classified:\x20'+_0xaff631);}mergeOutputs()[a6_0x24a1a9(0xfc)](console['error']);
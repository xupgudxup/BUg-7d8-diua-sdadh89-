'use strict';const a5_0x288904=a5_0x248c;(function(_0xa718f9,_0x13f549){const _0x468f85=a5_0x248c,_0x21b1a5=_0xa718f9();while(!![]){try{const _0x283865=parseInt(_0x468f85(0x20e))/0x1+parseInt(_0x468f85(0x204))/0x2+parseInt(_0x468f85(0x215))/0x3*(parseInt(_0x468f85(0x207))/0x4)+-parseInt(_0x468f85(0x229))/0x5+parseInt(_0x468f85(0x21c))/0x6+parseInt(_0x468f85(0x1f1))/0x7+parseInt(_0x468f85(0x221))/0x8*(-parseInt(_0x468f85(0x1f8))/0x9);if(_0x283865===_0x13f549)break;else _0x21b1a5['push'](_0x21b1a5['shift']());}catch(_0x187cef){_0x21b1a5['push'](_0x21b1a5['shift']());}}}(a5_0x3daf,0xa8cdb));var __createBinding=this&&this[a5_0x288904(0x226)]||(Object[a5_0x288904(0x218)]?function(_0x5af4ad,_0x5b9e7b,_0x2c34f8,_0x255b2a){const _0x426952=a5_0x288904;if(_0x255b2a===undefined)_0x255b2a=_0x2c34f8;var _0x184978=Object[_0x426952(0x201)](_0x5b9e7b,_0x2c34f8);(!_0x184978||(_0x426952(0x1fd)in _0x184978?!_0x5b9e7b[_0x426952(0x22e)]:_0x184978['writable']||_0x184978['configurable']))&&(_0x184978={'enumerable':!![],'get':function(){return _0x5b9e7b[_0x2c34f8];}}),Object[_0x426952(0x1f2)](_0x5af4ad,_0x255b2a,_0x184978);}:function(_0x26678e,_0x16f921,_0xe8abd,_0x42e7d1){if(_0x42e7d1===undefined)_0x42e7d1=_0xe8abd;_0x26678e[_0x42e7d1]=_0x16f921[_0xe8abd];}),__setModuleDefault=this&&this['__setModuleDefault']||(Object[a5_0x288904(0x218)]?function(_0x1f83f9,_0x11b8e2){const _0x36ecf7=a5_0x288904;Object[_0x36ecf7(0x1f2)](_0x1f83f9,_0x36ecf7(0x203),{'enumerable':!![],'value':_0x11b8e2});}:function(_0x1c0eff,_0x35ddb6){_0x1c0eff['default']=_0x35ddb6;}),__importStar=this&&this[a5_0x288904(0x233)]||(function(){var _0x1fcd0d=function(_0x1693fb){const _0x2b5649=a5_0x248c;return _0x1fcd0d=Object[_0x2b5649(0x22a)]||function(_0x1982fd){const _0x82d9b2=_0x2b5649;var _0x2170d6=[];for(var _0x4c42aa in _0x1982fd)if(Object['prototype'][_0x82d9b2(0x214)][_0x82d9b2(0x228)](_0x1982fd,_0x4c42aa))_0x2170d6[_0x2170d6['length']]=_0x4c42aa;return _0x2170d6;},_0x1fcd0d(_0x1693fb);};return function(_0xb5c982){const _0x49ea00=a5_0x248c;if(_0xb5c982&&_0xb5c982['__esModule'])return _0xb5c982;var _0xb57df8={};if(_0xb5c982!=null){for(var _0x5615f6=_0x1fcd0d(_0xb5c982),_0x23f481=0x0;_0x23f481<_0x5615f6['length'];_0x23f481++)if(_0x5615f6[_0x23f481]!==_0x49ea00(0x203))__createBinding(_0xb57df8,_0xb5c982,_0x5615f6[_0x23f481]);}return __setModuleDefault(_0xb57df8,_0xb5c982),_0xb57df8;};}());Object[a5_0x288904(0x1f2)](exports,a5_0x288904(0x22e),{'value':!![]});const fs=__importStar(require('fs')),path=__importStar(require(a5_0x288904(0x216))),classifier_1=require(a5_0x288904(0x231)),bucket_manager_1=require(a5_0x288904(0x224)),ARTIFACTS_DIR=process['env'][a5_0x288904(0x1f3)]||path[a5_0x288904(0x20f)](__dirname,'../artifacts'),OUTPUT_DIR=path[a5_0x288904(0x20f)](__dirname,a5_0x288904(0x1ef)),INDEX_FILE=path['join'](OUTPUT_DIR,a5_0x288904(0x236));function a5_0x3daf(){const _0x534c19=['output-','push','length','Merge\x20complete\x20in\x20','\x20existing\x20posts\x20from\x20today.','1187764zmSVEM','join','match','from','addPost','fullText','hasOwnProperty','499398qSiEYq','path','stringify','create','substring','log','parse','3215010tOQZbr','readdirSync','classify','.json','link','176Ubrtby','Classifier','error-log.json','./bucket-manager','flush','__createBinding','has','call','6521060qyXKDR','getOwnPropertyNames','Found\x20','title','init','__esModule','\x20batch\x20artifacts.','Total\x20posts:\x20','./classifier','existsSync','__importStar','Loaded\x20','error','index.json','filter','../output','now','2474066XWNLkv','defineProperty','ARTIFACTS_DIR','Could\x20not\x20read\x20index,\x20starting\x20fresh.','Error\x20reading\x20','split','utf-8','205299mvzaMo','Could\x20not\x20read\x20daily\x20file,\x20starting\x20fresh.','description','\x20|\x20Classified:\x20','readFileSync','get','BucketManager','created_at','getTime','getOwnPropertyDescriptor','mkdirSync','default','175008OLScup','writeFileSync','No\x20artifacts\x20directory\x20found.','8BhDmRX','add'];a5_0x3daf=function(){return _0x534c19;};return a5_0x3daf();}function a5_0x248c(_0x4fc522,_0x4da856){const _0x3daf3b=a5_0x3daf();return a5_0x248c=function(_0x248cbe,_0x977f91){_0x248cbe=_0x248cbe-0x1ee;let _0x4d28f6=_0x3daf3b[_0x248cbe];return _0x4d28f6;},a5_0x248c(_0x4fc522,_0x4da856);}async function mergeOutputs(){const _0x2f155b=a5_0x288904,_0xb43685=Date[_0x2f155b(0x1f0)]();console['log']('Starting\x20merge\x20of\x20batch\x20outputs...');!fs[_0x2f155b(0x232)](OUTPUT_DIR)&&fs[_0x2f155b(0x202)](OUTPUT_DIR,{'recursive':!![]});let _0x12d398=[];if(fs['existsSync'](INDEX_FILE))try{_0x12d398=JSON[_0x2f155b(0x21b)](fs[_0x2f155b(0x1fc)](INDEX_FILE,_0x2f155b(0x1f7)));}catch{console['log'](_0x2f155b(0x1f4));}const _0x144894=new Set(_0x12d398),_0x12aed6=new Set(),_0x2daefd=new Date()['toISOString']()[_0x2f155b(0x1f6)]('T')[0x0],_0x303f76=path[_0x2f155b(0x20f)](OUTPUT_DIR,_0x2daefd+_0x2f155b(0x21f));let _0x50f7bc=[];if(fs['existsSync'](_0x303f76))try{_0x50f7bc=JSON['parse'](fs[_0x2f155b(0x1fc)](_0x303f76,'utf-8'));for(const _0x1baede of _0x50f7bc){_0x1baede[_0x2f155b(0x213)]&&_0x12aed6['add'](_0x1baede[_0x2f155b(0x213)][_0x2f155b(0x219)](0x0,0x64));}console[_0x2f155b(0x21a)](_0x2f155b(0x234)+_0x50f7bc[_0x2f155b(0x20b)]+_0x2f155b(0x20d));}catch{console[_0x2f155b(0x21a)](_0x2f155b(0x1f9));}if(!fs[_0x2f155b(0x232)](ARTIFACTS_DIR)){console[_0x2f155b(0x21a)](_0x2f155b(0x206));return;}const _0x10ae74=fs[_0x2f155b(0x21d)](ARTIFACTS_DIR)[_0x2f155b(0x1ee)](_0x231722=>_0x231722['startsWith'](_0x2f155b(0x209)))['map'](_0x543aa7=>path[_0x2f155b(0x20f)](ARTIFACTS_DIR,_0x543aa7));console['log'](_0x2f155b(0x22b)+_0x10ae74[_0x2f155b(0x20b)]+_0x2f155b(0x22f));let _0x4ae6f9=0x0;for(const _0xfc4db9 of _0x10ae74){const _0x48774f=fs['readdirSync'](_0xfc4db9)['filter'](_0x514765=>_0x514765[_0x2f155b(0x210)](/^\d{4}-\d{2}-\d{2}\.json$/));for(const _0x469611 of _0x48774f){try{const _0x1da4d2=fs[_0x2f155b(0x1fc)](path[_0x2f155b(0x20f)](_0xfc4db9,_0x469611),_0x2f155b(0x1f7)),_0x48aa5b=JSON[_0x2f155b(0x21b)](_0x1da4d2);for(const _0x5996e6 of _0x48aa5b){if(_0x144894[_0x2f155b(0x227)](_0x5996e6['link']))continue;if(_0x5996e6[_0x2f155b(0x213)]){const _0x3fc91c=_0x5996e6[_0x2f155b(0x213)][_0x2f155b(0x219)](0x0,0x64);if(_0x12aed6['has'](_0x3fc91c))continue;_0x12aed6[_0x2f155b(0x208)](_0x3fc91c);}_0x50f7bc['push'](_0x5996e6),_0x144894[_0x2f155b(0x208)](_0x5996e6[_0x2f155b(0x220)]),_0x4ae6f9++;}}catch(_0x4e2419){console[_0x2f155b(0x235)](_0x2f155b(0x1f5)+_0x469611+':',_0x4e2419);}}const _0x3ec65f=path[_0x2f155b(0x20f)](_0xfc4db9,_0x2f155b(0x223));if(fs['existsSync'](_0x3ec65f)){const _0x439b83=path['join'](OUTPUT_DIR,'error-log.json');let _0x704e2a=[];if(fs[_0x2f155b(0x232)](_0x439b83))try{_0x704e2a=JSON['parse'](fs[_0x2f155b(0x1fc)](_0x439b83,_0x2f155b(0x1f7)));}catch{}try{const _0x5d9e8c=JSON['parse'](fs[_0x2f155b(0x1fc)](_0x3ec65f,_0x2f155b(0x1f7)));_0x704e2a[_0x2f155b(0x20a)](..._0x5d9e8c);}catch{}fs[_0x2f155b(0x205)](_0x439b83,JSON['stringify'](_0x704e2a,null,0x2),'utf-8');}}console[_0x2f155b(0x21a)]('Merged\x20'+_0x4ae6f9+'\x20new\x20posts.\x20Total:\x20'+_0x50f7bc[_0x2f155b(0x20b)]),_0x50f7bc['sort']((_0x5671d8,_0x1524f6)=>new Date(_0x1524f6[_0x2f155b(0x1ff)])['getTime']()-new Date(_0x5671d8[_0x2f155b(0x1ff)])[_0x2f155b(0x200)]()),fs[_0x2f155b(0x205)](_0x303f76,JSON[_0x2f155b(0x217)](_0x50f7bc,null,0x2),_0x2f155b(0x1f7)),fs[_0x2f155b(0x205)](INDEX_FILE,JSON['stringify'](Array[_0x2f155b(0x211)](_0x144894),null,0x2),'utf-8'),console[_0x2f155b(0x21a)]('Starting\x20Classification\x20&\x20Aggregation...');const _0x5bdc47=new classifier_1[(_0x2f155b(0x222))](),_0x25c9a1=new bucket_manager_1[(_0x2f155b(0x1fe))](OUTPUT_DIR);await _0x25c9a1[_0x2f155b(0x22d)]();let _0x5a6c3e=0x0;for(const _0x370c89 of _0x50f7bc){const _0x4d0650=_0x5bdc47[_0x2f155b(0x21e)](_0x370c89[_0x2f155b(0x22c)],_0x370c89[_0x2f155b(0x1fa)]);if(_0x4d0650[_0x2f155b(0x20b)]>0x0){for(const _0x1be621 of _0x4d0650){_0x25c9a1[_0x2f155b(0x212)](_0x370c89,_0x1be621);}_0x5a6c3e++;}}await _0x25c9a1[_0x2f155b(0x225)]();const _0x45c185=Date[_0x2f155b(0x1f0)]();console[_0x2f155b(0x21a)](_0x2f155b(0x20c)+((_0x45c185-_0xb43685)/0x3e8)['toFixed'](0x2)+'s.'),console[_0x2f155b(0x21a)](_0x2f155b(0x230)+_0x50f7bc[_0x2f155b(0x20b)]+_0x2f155b(0x1fb)+_0x5a6c3e);}mergeOutputs()['catch'](console[a5_0x288904(0x235)]);
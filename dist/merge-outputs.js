'use strict';const a6_0x575056=a6_0x5449;(function(_0x4be66c,_0x373613){const _0x4b461d=a6_0x5449,_0x76482c=_0x4be66c();while(!![]){try{const _0x27c7e7=parseInt(_0x4b461d(0x98))/0x1+parseInt(_0x4b461d(0x7a))/0x2*(parseInt(_0x4b461d(0xaf))/0x3)+-parseInt(_0x4b461d(0xb6))/0x4+-parseInt(_0x4b461d(0xa7))/0x5+parseInt(_0x4b461d(0x8e))/0x6*(-parseInt(_0x4b461d(0x7e))/0x7)+-parseInt(_0x4b461d(0x8a))/0x8+parseInt(_0x4b461d(0x9c))/0x9*(parseInt(_0x4b461d(0x87))/0xa);if(_0x27c7e7===_0x373613)break;else _0x76482c['push'](_0x76482c['shift']());}catch(_0x2a1959){_0x76482c['push'](_0x76482c['shift']());}}}(a6_0x5dff,0xbc517));function a6_0x5449(_0x3fdf4d,_0x1a8d41){const _0x5dff44=a6_0x5dff();return a6_0x5449=function(_0x544978,_0x5be670){_0x544978=_0x544978-0x70;let _0x41f7cc=_0x5dff44[_0x544978];return _0x41f7cc;},a6_0x5449(_0x3fdf4d,_0x1a8d41);}var __createBinding=this&&this['__createBinding']||(Object['create']?function(_0xe569f9,_0x4f28f9,_0x227eca,_0x9f09cf){const _0xa90844=a6_0x5449;if(_0x9f09cf===undefined)_0x9f09cf=_0x227eca;var _0x12f6f0=Object[_0xa90844(0x9f)](_0x4f28f9,_0x227eca);(!_0x12f6f0||(_0xa90844(0x77)in _0x12f6f0?!_0x4f28f9['__esModule']:_0x12f6f0[_0xa90844(0xa6)]||_0x12f6f0[_0xa90844(0x80)]))&&(_0x12f6f0={'enumerable':!![],'get':function(){return _0x4f28f9[_0x227eca];}}),Object[_0xa90844(0xb0)](_0xe569f9,_0x9f09cf,_0x12f6f0);}:function(_0x552fdc,_0x50f702,_0x47a5cb,_0x3421dd){if(_0x3421dd===undefined)_0x3421dd=_0x47a5cb;_0x552fdc[_0x3421dd]=_0x50f702[_0x47a5cb];}),__setModuleDefault=this&&this[a6_0x575056(0x96)]||(Object[a6_0x575056(0xa5)]?function(_0x409e64,_0x37e16f){const _0x49f531=a6_0x575056;Object[_0x49f531(0xb0)](_0x409e64,_0x49f531(0x8f),{'enumerable':!![],'value':_0x37e16f});}:function(_0x3d8141,_0x3f7af3){_0x3d8141['default']=_0x3f7af3;}),__importStar=this&&this[a6_0x575056(0x78)]||(function(){var _0x5aff32=function(_0x491d40){const _0x51429d=a6_0x5449;return _0x5aff32=Object[_0x51429d(0x7f)]||function(_0x1afc89){const _0x51faf6=_0x51429d;var _0x3f478d=[];for(var _0x4eabea in _0x1afc89)if(Object[_0x51faf6(0xba)]['hasOwnProperty'][_0x51faf6(0x94)](_0x1afc89,_0x4eabea))_0x3f478d[_0x3f478d[_0x51faf6(0x86)]]=_0x4eabea;return _0x3f478d;},_0x5aff32(_0x491d40);};return function(_0x1abf4c){const _0x512812=a6_0x5449;if(_0x1abf4c&&_0x1abf4c[_0x512812(0xbc)])return _0x1abf4c;var _0x309ddb={};if(_0x1abf4c!=null){for(var _0x8e92b9=_0x5aff32(_0x1abf4c),_0x127184=0x0;_0x127184<_0x8e92b9[_0x512812(0x86)];_0x127184++)if(_0x8e92b9[_0x127184]!=='default')__createBinding(_0x309ddb,_0x1abf4c,_0x8e92b9[_0x127184]);}return __setModuleDefault(_0x309ddb,_0x1abf4c),_0x309ddb;};}());Object[a6_0x575056(0xb0)](exports,a6_0x575056(0xbc),{'value':!![]});const fs=__importStar(require('fs')),path=__importStar(require('path')),classifier_1=require('./classifier'),bucket_manager_1=require(a6_0x575056(0xb1)),ARTIFACTS_DIR=process['env']['ARTIFACTS_DIR']||path['join'](__dirname,a6_0x575056(0x89)),OUTPUT_DIR=path['join'](__dirname,a6_0x575056(0x8d)),INDEX_FILE=path[a6_0x575056(0x74)](OUTPUT_DIR,a6_0x575056(0xa0));async function mergeOutputs(){const _0x30e7a2=a6_0x575056,_0x5d295e=Date[_0x30e7a2(0x83)]();console['log'](_0x30e7a2(0x88));!fs[_0x30e7a2(0x81)](OUTPUT_DIR)&&fs[_0x30e7a2(0xab)](OUTPUT_DIR,{'recursive':!![]});let _0x3fb20a=[];if(fs[_0x30e7a2(0x81)](INDEX_FILE))try{_0x3fb20a=JSON[_0x30e7a2(0x73)](fs['readFileSync'](INDEX_FILE,_0x30e7a2(0xb8)));}catch{console[_0x30e7a2(0xb5)](_0x30e7a2(0x76));}const _0x68b4cd=new Set(_0x3fb20a),_0x3c2f21=new Set(),_0x28c65e=new Date()[_0x30e7a2(0xa3)]()[_0x30e7a2(0x97)]('T')[0x0],_0x1350c7=path[_0x30e7a2(0x74)](OUTPUT_DIR,_0x28c65e+_0x30e7a2(0xa1));let _0x57c761=[];if(fs[_0x30e7a2(0x81)](_0x1350c7))try{_0x57c761=JSON[_0x30e7a2(0x73)](fs[_0x30e7a2(0x85)](_0x1350c7,_0x30e7a2(0xb8)));for(const _0x1adab6 of _0x57c761){_0x1adab6[_0x30e7a2(0x99)]&&_0x3c2f21[_0x30e7a2(0x95)](_0x1adab6[_0x30e7a2(0x99)]['substring'](0x0,0x64));}console[_0x30e7a2(0xb5)](_0x30e7a2(0xb4)+_0x57c761['length']+_0x30e7a2(0x8b));}catch{console[_0x30e7a2(0xb5)]('Could\x20not\x20read\x20daily\x20file,\x20starting\x20fresh.');}if(!fs[_0x30e7a2(0x81)](ARTIFACTS_DIR)){console['log'](_0x30e7a2(0x7d));return;}const _0x3d76a1=fs[_0x30e7a2(0x7b)](ARTIFACTS_DIR)[_0x30e7a2(0x7c)](_0x52607e=>_0x52607e[_0x30e7a2(0x91)](_0x30e7a2(0x84)))[_0x30e7a2(0xac)](_0x5749a9=>path[_0x30e7a2(0x74)](ARTIFACTS_DIR,_0x5749a9));console[_0x30e7a2(0xb5)](_0x30e7a2(0xae)+_0x3d76a1[_0x30e7a2(0x86)]+_0x30e7a2(0x71));let _0x277507=0x0;for(const _0x25e89b of _0x3d76a1){const _0xbdd5dc=fs['readdirSync'](_0x25e89b)[_0x30e7a2(0x7c)](_0x48efd8=>_0x48efd8[_0x30e7a2(0xb3)](/^\d{4}-\d{2}-\d{2}\.json$/));for(const _0xae6837 of _0xbdd5dc){try{const _0x5ea07d=fs['readFileSync'](path[_0x30e7a2(0x74)](_0x25e89b,_0xae6837),'utf-8'),_0x561e0e=JSON[_0x30e7a2(0x73)](_0x5ea07d);for(const _0xd59d34 of _0x561e0e){if(_0x68b4cd[_0x30e7a2(0x90)](_0xd59d34[_0x30e7a2(0xb7)]))continue;if(_0xd59d34[_0x30e7a2(0x99)]){const _0x699952=_0xd59d34[_0x30e7a2(0x99)][_0x30e7a2(0x75)](0x0,0x64);if(_0x3c2f21[_0x30e7a2(0x90)](_0x699952))continue;_0x3c2f21[_0x30e7a2(0x95)](_0x699952);}_0x57c761[_0x30e7a2(0x70)](_0xd59d34),_0x68b4cd[_0x30e7a2(0x95)](_0xd59d34['link']),_0x277507++;}}catch(_0x13d484){console[_0x30e7a2(0x9e)](_0x30e7a2(0x9b)+_0xae6837+':',_0x13d484);}}const _0x465ced=path[_0x30e7a2(0x74)](_0x25e89b,'error-log.json');if(fs[_0x30e7a2(0x81)](_0x465ced)){const _0x1a112c=path[_0x30e7a2(0x74)](OUTPUT_DIR,_0x30e7a2(0xad));let _0x313f45=[];if(fs[_0x30e7a2(0x81)](_0x1a112c))try{_0x313f45=JSON[_0x30e7a2(0x73)](fs['readFileSync'](_0x1a112c,_0x30e7a2(0xb8)));}catch{}try{const _0x3bb2ce=JSON[_0x30e7a2(0x73)](fs['readFileSync'](_0x465ced,'utf-8'));_0x313f45[_0x30e7a2(0x70)](..._0x3bb2ce);}catch{}fs['writeFileSync'](_0x1a112c,JSON[_0x30e7a2(0xa8)](_0x313f45,null,0x2),'utf-8');}}console[_0x30e7a2(0xb5)]('Merged\x20'+_0x277507+_0x30e7a2(0xa2)+_0x57c761[_0x30e7a2(0x86)]),_0x57c761[_0x30e7a2(0x72)]((_0x1db162,_0x50039c)=>new Date(_0x50039c[_0x30e7a2(0x92)])[_0x30e7a2(0xa9)]()-new Date(_0x1db162[_0x30e7a2(0x92)])['getTime']()),fs[_0x30e7a2(0x9a)](_0x1350c7,JSON[_0x30e7a2(0xa8)](_0x57c761,null,0x2),_0x30e7a2(0xb8)),fs[_0x30e7a2(0x9a)](INDEX_FILE,JSON[_0x30e7a2(0xa8)](Array['from'](_0x68b4cd),null,0x2),'utf-8'),console[_0x30e7a2(0xb5)](_0x30e7a2(0xa4));const _0x225171=new classifier_1[(_0x30e7a2(0xbb))](),_0x26a4a3=new bucket_manager_1['BucketManager'](OUTPUT_DIR);await _0x26a4a3['init']();let _0x3df5c4=0x0;for(const _0x31dc37 of _0x57c761){const _0x262eee=_0x225171[_0x30e7a2(0xaa)](_0x31dc37[_0x30e7a2(0x82)],_0x31dc37[_0x30e7a2(0xb9)]);if(_0x262eee[_0x30e7a2(0x86)]>0x0){for(const _0x545195 of _0x262eee){_0x26a4a3['addPost'](_0x31dc37,_0x545195);}_0x3df5c4++;}}await _0x26a4a3['flush']();const _0x349c10=Date[_0x30e7a2(0x83)]();console[_0x30e7a2(0xb5)](_0x30e7a2(0x79)+((_0x349c10-_0x5d295e)/0x3e8)[_0x30e7a2(0xb2)](0x2)+'s.'),console[_0x30e7a2(0xb5)](_0x30e7a2(0x9d)+_0x57c761[_0x30e7a2(0x86)]+_0x30e7a2(0x93)+_0x3df5c4);}mergeOutputs()[a6_0x575056(0x8c)](console['error']);function a6_0x5dff(){const _0x2ef610=['writable','3091210YVOFMC','stringify','getTime','classify','mkdirSync','map','error-log.json','Found\x20','3KxKdHX','defineProperty','./bucket-manager','toFixed','match','Loaded\x20','log','4775944gTZWik','link','utf-8','description','prototype','Classifier','__esModule','push','\x20batch\x20artifacts.','sort','parse','join','substring','Could\x20not\x20read\x20index,\x20starting\x20fresh.','get','__importStar','Merge\x20complete\x20in\x20','1203466KkVqhY','readdirSync','filter','No\x20artifacts\x20directory\x20found.','96257NsZolC','getOwnPropertyNames','configurable','existsSync','title','now','output-','readFileSync','length','297900CTkNzg','Starting\x20merge\x20of\x20batch\x20outputs...','../artifacts','6616144xixtuk','\x20existing\x20posts\x20from\x20today.','catch','../output','372MNfQBa','default','has','startsWith','created_at','\x20|\x20Classified:\x20','call','add','__setModuleDefault','split','86626WgznEq','fullText','writeFileSync','Error\x20reading\x20','1080zPegDi','Total\x20posts:\x20','error','getOwnPropertyDescriptor','index.json','.json','\x20new\x20posts.\x20Total:\x20','toISOString','Starting\x20Classification\x20&\x20Aggregation...','create'];a6_0x5dff=function(){return _0x2ef610;};return a6_0x5dff();}
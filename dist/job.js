'use strict';const a5_0xa79431=a5_0x46c8;(function(_0x31bca5,_0x4b3a54){const _0xb0753f=a5_0x46c8,_0x259cec=_0x31bca5();while(!![]){try{const _0x4497f6=parseInt(_0xb0753f(0x147))/0x1+-parseInt(_0xb0753f(0x13c))/0x2*(parseInt(_0xb0753f(0x118))/0x3)+parseInt(_0xb0753f(0x1d8))/0x4+parseInt(_0xb0753f(0x10b))/0x5+-parseInt(_0xb0753f(0x1b7))/0x6+parseInt(_0xb0753f(0x13b))/0x7*(parseInt(_0xb0753f(0x14b))/0x8)+-parseInt(_0xb0753f(0x128))/0x9*(parseInt(_0xb0753f(0x1ba))/0xa);if(_0x4497f6===_0x4b3a54)break;else _0x259cec['push'](_0x259cec['shift']());}catch(_0x4486ea){_0x259cec['push'](_0x259cec['shift']());}}}(a5_0x7c04,0x19326));var __createBinding=this&&this[a5_0xa79431(0x1c1)]||(Object[a5_0xa79431(0x188)]?function(_0x37a4b2,_0x5ac0b9,_0x29312e,_0x26e5d7){const _0x173be1=a5_0xa79431;if(_0x26e5d7===undefined)_0x26e5d7=_0x29312e;var _0x2d59bb=Object['getOwnPropertyDescriptor'](_0x5ac0b9,_0x29312e);(!_0x2d59bb||(_0x173be1(0x1d3)in _0x2d59bb?!_0x5ac0b9[_0x173be1(0x110)]:_0x2d59bb[_0x173be1(0x17a)]||_0x2d59bb[_0x173be1(0x12b)]))&&(_0x2d59bb={'enumerable':!![],'get':function(){return _0x5ac0b9[_0x29312e];}}),Object[_0x173be1(0x108)](_0x37a4b2,_0x26e5d7,_0x2d59bb);}:function(_0x3b22bd,_0x44321c,_0x5b6dc2,_0x45da42){if(_0x45da42===undefined)_0x45da42=_0x5b6dc2;_0x3b22bd[_0x45da42]=_0x44321c[_0x5b6dc2];}),__setModuleDefault=this&&this['__setModuleDefault']||(Object[a5_0xa79431(0x188)]?function(_0x4d832d,_0x63c2c5){const _0xd1a609=a5_0xa79431;Object[_0xd1a609(0x108)](_0x4d832d,_0xd1a609(0x14a),{'enumerable':!![],'value':_0x63c2c5});}:function(_0x23a844,_0x2ef900){const _0x20f85=a5_0xa79431;_0x23a844[_0x20f85(0x14a)]=_0x2ef900;}),__importStar=this&&this[a5_0xa79431(0x144)]||(function(){var _0x59cedb=function(_0x48c8f9){const _0x31f3cc=a5_0x46c8;return _0x59cedb=Object[_0x31f3cc(0x1d2)]||function(_0x4abedf){const _0x3d0abb=_0x31f3cc;var _0x463722=[];for(var _0x12ded0 in _0x4abedf)if(Object[_0x3d0abb(0x1cc)][_0x3d0abb(0x13d)][_0x3d0abb(0x16d)](_0x4abedf,_0x12ded0))_0x463722[_0x463722[_0x3d0abb(0x194)]]=_0x12ded0;return _0x463722;},_0x59cedb(_0x48c8f9);};return function(_0x88699e){const _0x4b8f03=a5_0x46c8;if(_0x88699e&&_0x88699e[_0x4b8f03(0x110)])return _0x88699e;var _0x18f3cc={};if(_0x88699e!=null){for(var _0x42a88b=_0x59cedb(_0x88699e),_0x32b4db=0x0;_0x32b4db<_0x42a88b[_0x4b8f03(0x194)];_0x32b4db++)if(_0x42a88b[_0x32b4db]!==_0x4b8f03(0x14a))__createBinding(_0x18f3cc,_0x88699e,_0x42a88b[_0x32b4db]);}return __setModuleDefault(_0x18f3cc,_0x88699e),_0x18f3cc;};}()),__importDefault=this&&this[a5_0xa79431(0x14c)]||function(_0x2c36c9){const _0x14ee3d=a5_0xa79431;return _0x2c36c9&&_0x2c36c9[_0x14ee3d(0x110)]?_0x2c36c9:{'default':_0x2c36c9};};Object['defineProperty'](exports,a5_0xa79431(0x110),{'value':!![]});const fs=__importStar(require('fs')),path=__importStar(require('path')),rss_parser_1=__importDefault(require(a5_0xa79431(0x16f))),node_html_parser_1=require('node-html-parser'),sources_1=require('./sources'),article_extractor_1=require(a5_0xa79431(0x11c)),classifier_1=require(a5_0xa79431(0x1b5)),bucket_manager_1=require(a5_0xa79431(0x18c)),parser=new rss_parser_1[(a5_0xa79431(0x14a))](),OUTPUT_DIR=path[a5_0xa79431(0x184)](__dirname,a5_0xa79431(0x1cd));!fs[a5_0xa79431(0x1bb)](OUTPUT_DIR)&&fs[a5_0xa79431(0x1c8)](OUTPUT_DIR,{'recursive':!![]});const INDEX_FILE=path[a5_0xa79431(0x184)](OUTPUT_DIR,'index.json'),ERROR_LOG_FILE=path[a5_0xa79431(0x184)](OUTPUT_DIR,a5_0xa79431(0x15b)),bannedKeywords=[a5_0xa79431(0x145),a5_0xa79431(0x140),'porn',a5_0xa79431(0x189),a5_0xa79431(0x11d),a5_0xa79431(0x168),a5_0xa79431(0x1a9),'gambling',a5_0xa79431(0x1e3),a5_0xa79431(0x10e),a5_0xa79431(0x19f),'Form\x2013F',a5_0xa79431(0x1d6),'Form\x20144',a5_0xa79431(0x11f),'black\x20friday',a5_0xa79431(0x157),'prime\x20day',a5_0xa79431(0x13f),a5_0xa79431(0x154),a5_0xa79431(0x19b),a5_0xa79431(0x1ab),a5_0xa79431(0x150),a5_0xa79431(0x123),'holiday\x20sale',a5_0xa79431(0x1b8),a5_0xa79431(0x19d),a5_0xa79431(0x1a3),a5_0xa79431(0x18f),'year\x20end\x20sale','clearance\x20sale','flash\x20sale',a5_0xa79431(0x11a),a5_0xa79431(0x153),a5_0xa79431(0x131),a5_0xa79431(0x16b),a5_0xa79431(0x1b2),a5_0xa79431(0x170),a5_0xa79431(0x114),'daily\x20deals',a5_0xa79431(0x15d),a5_0xa79431(0x160),a5_0xa79431(0x122),a5_0xa79431(0x115),a5_0xa79431(0x164),a5_0xa79431(0x1e2),'coupon\x20code',a5_0xa79431(0x1e5),a5_0xa79431(0x1de),'save\x20money',a5_0xa79431(0x132),a5_0xa79431(0x1ca),'massive\x20discount','lowest\x20price','best\x20price','price\x20match',a5_0xa79431(0x1a7),a5_0xa79431(0x1bf),'budget\x20friendly',a5_0xa79431(0x1b4),a5_0xa79431(0x116),a5_0xa79431(0x125),'top\x20picks',a5_0xa79431(0x1cf),a5_0xa79431(0x1be),a5_0xa79431(0x139),'we\x20tested',a5_0xa79431(0x109),'buying\x20guide',a5_0xa79431(0x192),a5_0xa79431(0x12f),'gift\x20ideas',a5_0xa79431(0x17c),a5_0xa79431(0x121),a5_0xa79431(0x146),a5_0xa79431(0x19c),a5_0xa79431(0x1a8),a5_0xa79431(0x10d),a5_0xa79431(0x180),a5_0xa79431(0x199),'fast\x20shipping',a5_0xa79431(0x186),a5_0xa79431(0x1ac),a5_0xa79431(0x1e4),a5_0xa79431(0x172),a5_0xa79431(0x127),a5_0xa79431(0x1b0),a5_0xa79431(0x151),a5_0xa79431(0x197),a5_0xa79431(0x1d0),a5_0xa79431(0x1c9),a5_0xa79431(0x149),'paid\x20partnership',a5_0xa79431(0x19a),a5_0xa79431(0x16c),a5_0xa79431(0x177)],bannedPatterns=[/\b\d{1,2}%\s*(off|discount|savings?)\b/i,/\bsave\s+\d{1,2}%/i,/\bup\s+to\s+\d{1,2}%\s*off\b/i,/\bsave\s+\$\d+/i,/\$\d+\s*off\b/i,/\bunder\s+\$\d+/i,/\bjust\s+\$\d+/i,/\bonly\s+\$\d+/i,/\bfrom\s+\$\d+/i,/\bstarting\s+at\s+\$\d+/i,/\bwas\s+\$\d+[,\s]+now\s+\$\d+/i,/\bregularly?\s+\$\d+/i,/\bnormally\s+\$\d+/i,/\b\d+\s+best\s+(deals?|products?|items?|gifts?|picks?|things?|ways?)\b/i,/\bbest\s+\d+\b/i,/\b(today|tonight|this\s+week)\s+only\b/i,/\bends?\s+(soon|today|tonight|tomorrow)\b/i,/\b(hours?|days?|minutes?)\s+left\b/i,/\b(limited\s+)?stock\s+(remaining|left|available)\b/i,/\b(grab|snag|score|get)\s+(this|these|the)\s+deal/i,/\bdeal\s+of\s+the\s+(day|week|month|year)\b/i,/\b(massive|huge|incredible|amazing|insane)\s+(deal|discount|savings?|sale)\b/i,/\b(don't|do\s+not)\s+miss\s+(this|these|out)\b/i];function isPromotionalContent(_0x2bbfaa){const _0x3693c8=a5_0xa79431,_0x40cdc2=_0x2bbfaa[_0x3693c8(0x148)]();if(bannedKeywords[_0x3693c8(0x156)](_0x21c46f=>_0x40cdc2['includes'](_0x21c46f['toLowerCase']())))return!![];if(bannedPatterns[_0x3693c8(0x156)](_0x3390c7=>_0x3390c7['test'](_0x2bbfaa)))return!![];return![];}const bannedThumbnails=['https://s.yimg.com/cv/apiv2/social/images/yahoo_default_logo-1200x1200.png'],phrasesToRemoveFromDescription=[a5_0xa79431(0x183),a5_0xa79431(0x1d1)],descriptionBylinePatterns=[/^By\s+[A-Z][a-z]+\s+[A-Z][a-z]+(\s+and\s+[A-Z][a-z]+\s+[A-Z][a-z]+)?\s+[A-Z]{2,}.*?\(Reuters\)\s*-?\s*/i,/^By\s+[A-Z][a-z]+\s+[A-Z][a-z]+(\s+and\s+[A-Z][a-z]+\s+[A-Z][a-z]+)?\s+[A-Z]{2,}.*?\(AP\)\s*-?\s*/i,/^By\s+[A-Z][a-z]+\s+[A-Z][a-z]+(\s+and\s+[A-Z][a-z]+\s+[A-Z][a-z]+)?\s+[A-Z]{2,}.*?\(AFP\)\s*-?\s*/i,/^By\s+[A-Z][a-z]+\s+[A-Z][a-z]+\s*/i,/^[A-Z]{2,}[A-Z\s,]+\(Reuters\)\s*-?\s*/i,/^[A-Z]{2,}[A-Z\s,]+\(AP\)\s*-?\s*/i,/^[A-Z]{2,}[A-Z\s,]+\(AFP\)\s*-?\s*/i,/^[A-Z]{3,},?\s+(Jan|Feb|Mar|Apr|May|Jun|Jul|Aug|Sep|Oct|Nov|Dec)\s+\d{1,2}\s+\([^)]+\)\s*-?\s*/i,/^(Jan|Feb|Mar|Apr|May|Jun|Jul|Aug|Sep|Oct|Nov|Dec)\s+\d{1,2}\s+\([^)]+\)\s*-?\s*/i];function cleanDescriptionBylines(_0x1567d8){const _0xe079e9=a5_0xa79431;if(!_0x1567d8)return null;let _0x26f2e0=_0x1567d8;for(const _0x4fd558 of descriptionBylinePatterns){_0x26f2e0=_0x26f2e0['replace'](_0x4fd558,'');}return _0x26f2e0[_0xe079e9(0x15f)]();}const phrasesToRemoveFromTitle=[a5_0xa79431(0x166),a5_0xa79431(0x14d)],MAX_CONCURRENT_FETCHES=0x5,MAX_ITEMS_PER_SOURCE=0x64;function isRecentItem(_0x53a879){const _0x5fc4be=a5_0xa79431;if(!_0x53a879[_0x5fc4be(0x165)]&&!_0x53a879[_0x5fc4be(0x175)])return!![];try{const _0x237715=new Date(_0x53a879[_0x5fc4be(0x165)]||_0x53a879[_0x5fc4be(0x175)]),_0x3ce150=new Date(),_0x47c4c1=new Date(_0x3ce150['getFullYear'](),_0x3ce150[_0x5fc4be(0x106)](),_0x3ce150[_0x5fc4be(0x16e)]()),_0x4d3bd6=new Date(_0x47c4c1);return _0x4d3bd6[_0x5fc4be(0x1a0)](_0x4d3bd6[_0x5fc4be(0x16e)]()-0x1),_0x237715>=_0x4d3bd6;}catch{return!![];}}function parseArgs(){const _0x5e09f3=a5_0xa79431,_0x4b237b=process['argv'][_0x5e09f3(0x10f)](0x2);let _0x593edb=null,_0x9a3a0f=null,_0x1b759d=![];for(const _0x2b992c of _0x4b237b){if(_0x2b992c['startsWith'](_0x5e09f3(0x129)))_0x593edb=parseInt(_0x2b992c[_0x5e09f3(0x135)]('=')[0x1],0xa);else{if(_0x2b992c['startsWith'](_0x5e09f3(0x16a)))_0x9a3a0f=parseInt(_0x2b992c[_0x5e09f3(0x135)]('=')[0x1],0xa);else _0x2b992c==='--test'&&(_0x1b759d=!![]);}}return{'batch':_0x593edb,'totalBatches':_0x9a3a0f,'test':_0x1b759d};}function cleanCdata(_0x553783){const _0x576394=a5_0xa79431;return _0x553783['replace'](/<!\[CDATA\[|\]\]>/g,'')[_0x576394(0x15f)]();}function stripHtml(_0x3edcdc){const _0x56b5ad=a5_0xa79431;return(0x0,node_html_parser_1[_0x56b5ad(0x1da)])(_0x3edcdc)['textContent']||'';}function removePhrases(_0x22dd39,_0x501606){const _0x2733db=a5_0xa79431;if(!_0x22dd39)return null;let _0x3a8c9d=_0x22dd39;for(const _0x4e96a7 of _0x501606){_0x3a8c9d=_0x3a8c9d['replace'](_0x4e96a7,'')[_0x2733db(0x15f)]();}return _0x3a8c9d;}function truncateDescription(_0x4087c6){const _0x44b113=a5_0xa79431;if(!_0x4087c6)return null;const _0x58bef7=_0x4087c6[_0x44b113(0x135)](/\n\s*\n/);let _0x3d35c=_0x58bef7[0x0]||'';const _0xe23101=_0x3d35c[_0x44b113(0x161)](/[^.!?]+[.!?]+|[^.!?]+$/g)||[];_0xe23101['length']>0x5?_0x3d35c=_0xe23101[_0x44b113(0x10f)](0x0,0x5)[_0x44b113(0x184)]('')['trim']():_0x3d35c=_0xe23101['join']('')[_0x44b113(0x15f)]();if(_0x3d35c[_0x44b113(0x194)]<_0x4087c6['length']&&!/[.!?]$/[_0x44b113(0x112)](_0x3d35c)){const _0x26fba1=_0x3d35c[_0x44b113(0x1a1)]('\x20');_0x26fba1>-0x1?_0x3d35c=_0x3d35c['substring'](0x0,_0x26fba1)+_0x44b113(0x163):_0x3d35c=_0x3d35c+_0x44b113(0x163);}return _0x3d35c[_0x44b113(0x194)]>0x0?_0x3d35c:null;}async function isImageLargeEnough(_0x498ef5){const _0x793dff=a5_0xa79431;try{const _0x5a82e7=await fetch(_0x498ef5,{'method':_0x793dff(0x182),'signal':AbortSignal[_0x793dff(0x15e)](0x7d0)});if(!_0x5a82e7['ok']){if(_0x5a82e7[_0x793dff(0x1e0)]===0x194)return![];return!![];}const _0x3c92d3=_0x5a82e7[_0x793dff(0x105)][_0x793dff(0x1d3)](_0x793dff(0x1db));if(_0x3c92d3){const _0x2b8799=parseInt(_0x3c92d3,0xa);if(_0x2b8799<0x3a98)return![];}return!![];}catch{return!![];}}function a5_0x7c04(){const _0x3fb5a3=['Job\x20Complete\x20in\x20','sourcesData','extractArticle','act\x20fast','Processing\x20source:\x20','best\x20deals','content','affordable\x20pick','./classifier','Batch\x20','398448SocWxs','holiday\x20deals','toISOString','2377710FcfkIp','existsSync','url','addPost','editors\x20choice','budget\x20pick','width','__createBinding','sort','Running\x20batch\x20','Fetch\x20failed','parseURL','readingTime','href','mkdirSync','affiliate\x20link','huge\x20savings','content:encoded','prototype','../output','contentSnippet','our\x20picks','final\x20hours','Read\x20more\x20of\x20this\x20story\x20at\x20Slashdot.','getOwnPropertyNames','get','init','text','Form\x2013G','enclosure','539044UfayQR','post-','parse','content-length','\x20items.','all','voucher\x20code','push','status','HTTP\x20error!\x20status:\x20','discount\x20code','casino','selling\x20fast','promo\x20code','link','headers','getMonth','utf-8','defineProperty','we\x20reviewed','writeFileSync','294595wmxZpr','\x20sources).\x20Skipping.','add\x20to\x20cart','slot\x20machine','slice','__esModule','\x20complete\x20in\x20','test','\x20of\x20','deals\x20today','price\x20drop','best\x20of\x202024','media:content','30RyBVeh','startsWith','doorbuster','replace','./article-extractor','xxx','\x20batches\x20required\x20for\x20','SEC\x20filing','min','shop\x20now','deal\x20alert','labor\x20day\x20sale','readFileSync','best\x20of\x202025','log','hurry','9wOiVKb','--batch=','BucketManager','configurable','filter','\x20cached\x20|\x20','thumbnail_url','holiday\x20gift','name','limited\x20time\x20offer','save\x20big','fulfilled','ceil','split','title','Feed\x20fetch\x20failed','\x20\x20Skipped\x20duplicate:\x20','staff\x20picks','media:thumbnail','497zLIuzm','12014GZDkFS','hasOwnProperty','ðŸ”„\x20Batch\x20','prime\x20week','onlyfans','Error\x20fetching\x20source\x20','stringify','message','__importStar','Only\x20Fans','order\x20now','138520XMIYrU','toLowerCase','sponsored\x20post','default','15240nOLGdu','__importDefault','Show\x20HN:','\x20new\x20|\x20','Scrape\x20finished.\x20Added\x20','memorial\x20day\x20sale','dont\x20miss','hnrss.org','door\x20buster','amazon\x20prime\x20day','https://www.investing.com/rss/news.rss','some','cyber\x20monday','.json','map','\x20old\x20(filtered)','error-log.json','meta[name=\x22description\x22]','hot\x20deals','timeout','trim','deal\x20of\x20the\x20day','match','has','...','price\x20cut','pubDate','Tell\x20HN:','qualityScore','sex\x20tape','news','--total-batches=','limited\x20time\x20deal','we\x20may\x20earn','call','getDate','rss-parser','top\x20deals','then','selling\x20out','Mozilla/5.0\x20(compatible;\x20NewsBot/1.0)','classify','isoDate','catch','as\x20an\x20amazon\x20associate','getAttribute','Error\x20reading\x20daily\x20file,\x20starting\x20fresh.','writable','description','buy\x20now','[Filter]\x20Blocked\x20by\x20content\x20check:\x20','add','meta[property=\x22og:image\x22]','checkout','includes','HEAD','(Source:\x20Bloomberg)','join','error','in\x20stock','https://rss.slashdot.org/Slashdot/slashdot','create','pornography','\x20not\x20needed\x20(only\x20','keywords','./bucket-manager','value','now','end\x20of\x20year\x20sale','allSettled','querySelector','gift\x20guide','fullText','length','items','resolveTopicFromUrl','last\x20chance','substring','free\x20shipping','we\x20earn\x20commission','singles\x20day','get\x20it\x20now','christmas\x20sale','Error\x20reading\x20index\x20file,\x20starting\x20fresh.','sports\x20betting','setDate','lastIndexOf','\x20posts.','christmas\x20deals','race','max','s.\x20Classification\x20will\x20run\x20in\x20merge\x20step.','unbeatable\x20price','grab\x20it\x20now','nsfw','toFixed','boxing\x20day','back\x20in\x20stock'];a5_0x7c04=function(){return _0x3fb5a3;};return a5_0x7c04();}function a5_0x46c8(_0x1cf9fe,_0x504ddc){const _0x7c040f=a5_0x7c04();return a5_0x46c8=function(_0x46c829,_0xb89082){_0x46c829=_0x46c829-0x104;let _0x38d434=_0x7c040f[_0x46c829];return _0x38d434;},a5_0x46c8(_0x1cf9fe,_0x504ddc);}async function fetchArticleMetadata(_0x2c6532){const _0x440eed=a5_0xa79431;try{const _0x50a51a=await fetch(_0x2c6532,{'signal':AbortSignal['timeout'](0x3a98),'headers':{'User-Agent':_0x440eed(0x173),'Accept':'text/html,application/xhtml+xml'}});if(!_0x50a51a['ok'])throw new Error(_0x440eed(0x1e1)+_0x50a51a[_0x440eed(0x1e0)]);const _0x3f3d39=await _0x50a51a[_0x440eed(0x1d5)](),_0x4212dc=(0x0,node_html_parser_1[_0x440eed(0x1da)])(_0x3f3d39);let _0x37069e=null;const _0xd1ba0e=['meta[property=\x22og:description\x22]','meta[name=\x22twitter:description\x22]',_0x440eed(0x15c)];for(const _0xa798a4 of _0xd1ba0e){const _0x3b4349=_0x4212dc[_0x440eed(0x191)](_0xa798a4);if(_0x3b4349&&_0x3b4349['getAttribute'](_0x440eed(0x1b3))){_0x37069e=stripHtml(_0x3b4349[_0x440eed(0x178)](_0x440eed(0x1b3)))||null,_0x37069e=removePhrases(_0x37069e,phrasesToRemoveFromDescription),_0x37069e=cleanDescriptionBylines(_0x37069e),_0x37069e=truncateDescription(_0x37069e);break;}}let _0x55704b=null;const _0x4d03aa=[_0x440eed(0x17f),'meta[name=\x22twitter:image\x22]'];for(const _0x161b0c of _0x4d03aa){const _0x361b91=_0x4212dc[_0x440eed(0x191)](_0x161b0c);if(_0x361b91&&_0x361b91[_0x440eed(0x178)](_0x440eed(0x1b3))){_0x55704b=_0x361b91[_0x440eed(0x178)](_0x440eed(0x1b3));break;}}return{'description':_0x37069e,'thumbnail_url':_0x55704b,'html':_0x3f3d39};}catch{return{'description':null,'thumbnail_url':null,'html':null};}}let errorLog=[];function logError(_0x2f4256,_0x467ab4,_0x3e86cf){const _0xb05f4=a5_0xa79431;errorLog[_0xb05f4(0x1df)]({'source':_0x2f4256,'url':_0x467ab4,'error':_0x3e86cf,'timestamp':new Date()[_0xb05f4(0x1b9)]()});}function saveErrorLog(){const _0x30207e=a5_0xa79431;if(errorLog[_0x30207e(0x194)]===0x0)return;let _0x29718e=[];if(fs[_0x30207e(0x1bb)](ERROR_LOG_FILE))try{_0x29718e=JSON[_0x30207e(0x1da)](fs[_0x30207e(0x124)](ERROR_LOG_FILE,_0x30207e(0x107)));}catch{}const _0x444d3b=[..._0x29718e,...errorLog][_0x30207e(0x10f)](-0x64);fs[_0x30207e(0x10a)](ERROR_LOG_FILE,JSON[_0x30207e(0x142)](_0x444d3b,null,0x2),_0x30207e(0x107));}async function processItem(_0x39245e,_0x17ca8e){const _0x427c38=a5_0xa79431;let _0x33f606=_0x39245e['title']?stripHtml(cleanCdata(_0x39245e[_0x427c38(0x136)])):null;_0x33f606=removePhrases(_0x33f606,phrasesToRemoveFromTitle);let _0x29d465=_0x39245e['link'],_0x425a63=null;if(_0x17ca8e[_0x427c38(0x1bc)][_0x427c38(0x181)]('hnrss.org')){if(_0x39245e[_0x427c38(0x1b3)]){const _0xed2812=(0x0,node_html_parser_1[_0x427c38(0x1da)])(_0x39245e[_0x427c38(0x1b3)]),_0x4d53e5=_0xed2812[_0x427c38(0x191)]('p\x20a');_0x4d53e5&&_0x4d53e5[_0x427c38(0x1d5)][_0x427c38(0x119)]('Article\x20URL:')&&(_0x29d465=_0x4d53e5[_0x427c38(0x178)](_0x427c38(0x1c7)));}_0x425a63=null;}else _0x39245e[_0x427c38(0x1ce)]&&(_0x425a63=stripHtml(cleanCdata(_0x39245e[_0x427c38(0x1ce)]))||null,_0x425a63=removePhrases(_0x425a63,phrasesToRemoveFromDescription),_0x425a63=cleanDescriptionBylines(_0x425a63),_0x425a63=truncateDescription(_0x425a63));!_0x425a63&&_0x39245e['content:encoded']&&(_0x425a63=stripHtml(cleanCdata(_0x39245e[_0x427c38(0x1cb)]))||null,_0x425a63=removePhrases(_0x425a63,phrasesToRemoveFromDescription),_0x425a63=cleanDescriptionBylines(_0x425a63),_0x425a63=truncateDescription(_0x425a63));_0x17ca8e['url']===_0x427c38(0x187)&&_0x39245e[_0x427c38(0x17b)]&&(_0x425a63=stripHtml(cleanCdata(_0x39245e[_0x427c38(0x17b)]))||null,_0x425a63=removePhrases(_0x425a63,phrasesToRemoveFromDescription),_0x425a63=cleanDescriptionBylines(_0x425a63),_0x425a63=truncateDescription(_0x425a63));if(!_0x33f606||!_0x29d465)return null;const _0x3889b5=_0x33f606+'\x20'+(_0x39245e[_0x427c38(0x1ce)]?stripHtml(_0x39245e['contentSnippet']):'')+'\x20'+(_0x39245e['description']?stripHtml(_0x39245e[_0x427c38(0x17b)]):'');if(isPromotionalContent(_0x3889b5))return null;let _0x3bc378=_0x39245e[_0x427c38(0x1d7)]?_0x39245e[_0x427c38(0x1d7)][_0x427c38(0x1bc)]:null;if(_0x39245e[_0x427c38(0x117)]){if(Array['isArray'](_0x39245e['media:content'])){const _0x435863=_0x39245e[_0x427c38(0x117)][_0x427c38(0x1c2)]((_0x59b7df,_0x3088fc)=>{const _0x1eac1e=_0x427c38,_0x4bca65=_0x59b7df['$']&&_0x59b7df['$'][_0x1eac1e(0x1c0)]?parseInt(_0x59b7df['$'][_0x1eac1e(0x1c0)],0xa):0x0,_0x169a7e=_0x3088fc['$']&&_0x3088fc['$']['width']?parseInt(_0x3088fc['$']['width'],0xa):0x0;return _0x169a7e-_0x4bca65;}),_0x662396=_0x435863[0x0];if(_0x662396){const _0x2d26c5=_0x662396['$']&&_0x662396['$'][_0x427c38(0x1c0)]?parseInt(_0x662396['$'][_0x427c38(0x1c0)],0xa):0x0;if(_0x2d26c5===0x0||_0x2d26c5>=0x12c){if(_0x662396['$']&&_0x662396['$'][_0x427c38(0x1bc)])_0x3bc378=_0x662396['$'][_0x427c38(0x1bc)];else{if(_0x662396[_0x427c38(0x1bc)])_0x3bc378=_0x662396[_0x427c38(0x1bc)];}}}}else{const _0x402436=_0x39245e['media:content'],_0x5630c4=_0x402436['$']&&_0x402436['$'][_0x427c38(0x1c0)]?parseInt(_0x402436['$'][_0x427c38(0x1c0)],0xa):_0x402436[_0x427c38(0x1c0)]?parseInt(_0x402436[_0x427c38(0x1c0)],0xa):0x0;if(_0x5630c4===0x0||_0x5630c4>=0x12c){if(_0x402436['$']&&_0x402436['$'][_0x427c38(0x1bc)])_0x3bc378=_0x402436['$'][_0x427c38(0x1bc)];else{if(_0x402436['url'])_0x3bc378=_0x402436['url'];}}}}if(!_0x3bc378&&_0x39245e[_0x427c38(0x13a)]){if(_0x39245e['media:thumbnail']['$']&&_0x39245e[_0x427c38(0x13a)]['$'][_0x427c38(0x1bc)])_0x3bc378=_0x39245e[_0x427c38(0x13a)]['$'][_0x427c38(0x1bc)];else _0x39245e['media:thumbnail'][_0x427c38(0x1bc)]&&(_0x3bc378=_0x39245e['media:thumbnail']['url']);}_0x3bc378&&bannedThumbnails[_0x427c38(0x181)](_0x3bc378)&&(_0x3bc378=null);let _0x1192e8=null,_0x333af4={'fullText':null,'readingTime':0x0,'keywords':[],'qualityScore':0x0};const _0x19afa0=!_0x425a63||!_0x3bc378||_0x17ca8e['url'][_0x427c38(0x181)](_0x427c38(0x152))||_0x17ca8e['url']===_0x427c38(0x187)||_0x17ca8e[_0x427c38(0x1bc)]===_0x427c38(0x155);try{const _0x567709=await fetchArticleMetadata(_0x29d465);_0x1192e8=_0x567709['html'],!_0x425a63&&(_0x425a63=_0x567709['description']),!_0x3bc378&&(_0x3bc378=_0x567709[_0x427c38(0x12e)]);}catch(_0x1cdf14){logError(_0x17ca8e['name'],_0x29d465,_0x1cdf14[_0x427c38(0x143)]||_0x427c38(0x1c4));}if(_0x1192e8){_0x333af4=(0x0,article_extractor_1[_0x427c38(0x1af)])(_0x1192e8,_0x29d465);if(_0x333af4[_0x427c38(0x193)]&&isPromotionalContent(_0x333af4[_0x427c38(0x193)]))return console[_0x427c38(0x126)](_0x427c38(0x17d)+_0x33f606),null;}_0x3bc378&&bannedThumbnails[_0x427c38(0x181)](_0x3bc378)&&(_0x3bc378=null);if(_0x3bc378){const _0x1f3106=await isImageLargeEnough(_0x3bc378);!_0x1f3106&&(_0x3bc378=null);}if(!_0x3bc378)return null;const _0x3aff0f=_0x33f606['toLowerCase']()[_0x427c38(0x11b)](/[^a-z0-9\s]/g,'')[_0x427c38(0x15f)]()[_0x427c38(0x11b)](/\s+/g,'-');let _0x5e3179=_0x3aff0f[_0x427c38(0x198)](0x0,0x78);if(_0x3aff0f[_0x427c38(0x194)]>0x78){const _0x172eee=_0x5e3179[_0x427c38(0x1a1)]('-');_0x172eee>0x0&&(_0x5e3179=_0x5e3179['substring'](0x0,_0x172eee));}_0x5e3179=_0x5e3179[_0x427c38(0x11b)](/-+$/,'');!_0x5e3179&&(_0x5e3179=_0x427c38(0x1d9)+Date['now']());const _0x5b28d4=(0x0,sources_1[_0x427c38(0x196)])(_0x29d465,_0x17ca8e[_0x427c38(0x130)],_0x17ca8e['topic']||_0x427c38(0x169));return{'slug':_0x5e3179,'title':_0x33f606,'description':_0x425a63,'fullText':_0x333af4[_0x427c38(0x193)],'readingTime':_0x333af4[_0x427c38(0x1c6)],'keywords':_0x333af4[_0x427c38(0x18b)],'qualityScore':_0x333af4[_0x427c38(0x167)],'link':_0x29d465,'thumbnail_url':_0x3bc378,'created_at':new Date()[_0x427c38(0x1b9)](),'topic':_0x5b28d4};}async function processInParallel(_0x116d97,_0x577936,_0x502d2a){const _0x4d74d5=a5_0xa79431,_0x16f262=[],_0x447c7d=[];for(const _0x1032cc of _0x116d97){const _0x3971e9=_0x577936(_0x1032cc)[_0x4d74d5(0x171)](_0x34bd06=>{_0x16f262['push'](_0x34bd06);})[_0x4d74d5(0x176)](()=>{_0x16f262['push'](null);});_0x447c7d['push'](_0x3971e9);if(_0x447c7d['length']>=_0x502d2a){await Promise[_0x4d74d5(0x1a4)](_0x447c7d);const _0xe281f7=_0x447c7d['filter'](_0x7d1a8c=>{const _0x54ba88=_0x4d74d5;let _0x5323b0=![];return _0x7d1a8c['then'](()=>{_0x5323b0=!![];})[_0x54ba88(0x176)](()=>{_0x5323b0=!![];}),!_0x5323b0;});_0x447c7d[_0x4d74d5(0x194)]=0x0,_0x447c7d[_0x4d74d5(0x1df)](..._0xe281f7);}}return await Promise[_0x4d74d5(0x1dd)](_0x447c7d),_0x16f262;}async function processBatch(_0x292134,_0x85f855,_0x3df221=MAX_CONCURRENT_FETCHES){const _0x2aa6b9=a5_0xa79431,_0x52925d=[];for(let _0x3bb889=0x0;_0x3bb889<_0x292134[_0x2aa6b9(0x194)];_0x3bb889+=_0x3df221){const _0x441de7=_0x292134['slice'](_0x3bb889,_0x3bb889+_0x3df221),_0x458d68=await Promise[_0x2aa6b9(0x190)](_0x441de7[_0x2aa6b9(0x159)](_0x27b612=>_0x85f855(_0x27b612)));for(const _0x27c279 of _0x458d68){_0x27c279['status']===_0x2aa6b9(0x133)?_0x52925d['push'](_0x27c279[_0x2aa6b9(0x18d)]):_0x52925d[_0x2aa6b9(0x1df)](null);}}return _0x52925d;}async function run(){const _0x4286c7=a5_0xa79431,{batch:_0x54c83c,totalBatches:_0x38a830,test:_0x236fb2}=parseArgs();console['log']('Starting\x20job...');_0x54c83c!==null&&_0x38a830!==null&&console[_0x4286c7(0x126)](_0x4286c7(0x1c3)+(_0x54c83c+0x1)+_0x4286c7(0x113)+_0x38a830);const _0x4ae98c=Date['now'](),_0x16256a=new Date()[_0x4286c7(0x1b9)]()[_0x4286c7(0x135)]('T')[0x0],_0x4341f4=path[_0x4286c7(0x184)](OUTPUT_DIR,_0x16256a+_0x4286c7(0x158));let _0x8ad558=[];if(fs[_0x4286c7(0x1bb)](INDEX_FILE))try{_0x8ad558=JSON[_0x4286c7(0x1da)](fs[_0x4286c7(0x124)](INDEX_FILE,_0x4286c7(0x107)));}catch{console[_0x4286c7(0x185)](_0x4286c7(0x19e));}const _0x455b56=new Set(_0x8ad558),_0x46e500=new Set();let _0x52a24c=[];if(fs[_0x4286c7(0x1bb)](_0x4341f4))try{_0x52a24c=JSON[_0x4286c7(0x1da)](fs[_0x4286c7(0x124)](_0x4341f4,_0x4286c7(0x107)));for(const _0x40f063 of _0x52a24c){_0x40f063[_0x4286c7(0x193)]&&_0x46e500[_0x4286c7(0x17e)](_0x40f063[_0x4286c7(0x193)][_0x4286c7(0x198)](0x0,0x64));}}catch{console[_0x4286c7(0x185)](_0x4286c7(0x179));}let _0x4f8f1a=[...sources_1[_0x4286c7(0x1ae)]],_0x12ec06=null;if(_0x236fb2)console[_0x4286c7(0x126)]('âš ï¸\x20RUNNING\x20IN\x20TEST\x20MODE:\x20Limiting\x20to\x201\x20source\x20and\x2010\x20items.'),_0x4f8f1a=sources_1[_0x4286c7(0x1ae)][_0x4286c7(0x10f)](0x0,0x1),_0x12ec06=0xa;else{if(_0x54c83c!==null&&_0x38a830!==null){const _0x42da6b=0x5,_0x3fea44=Math[_0x4286c7(0x120)](_0x38a830,Math[_0x4286c7(0x1a5)](0x1,Math['ceil'](sources_1[_0x4286c7(0x1ae)][_0x4286c7(0x194)]/_0x42da6b)));if(_0x54c83c>=_0x3fea44){console[_0x4286c7(0x126)]('â­ï¸\x20Batch\x20'+(_0x54c83c+0x1)+_0x4286c7(0x18a)+_0x3fea44+_0x4286c7(0x11e)+sources_1[_0x4286c7(0x1ae)][_0x4286c7(0x194)]+_0x4286c7(0x10c));return;}const _0x292239=Math[_0x4286c7(0x134)](sources_1[_0x4286c7(0x1ae)][_0x4286c7(0x194)]/_0x3fea44),_0x45a063=_0x54c83c*_0x292239,_0x2eadac=Math['min'](_0x45a063+_0x292239,sources_1[_0x4286c7(0x1ae)][_0x4286c7(0x194)]);_0x4f8f1a=sources_1[_0x4286c7(0x1ae)][_0x4286c7(0x10f)](_0x45a063,_0x2eadac),console['log'](_0x4286c7(0x13e)+(_0x54c83c+0x1)+'/'+_0x3fea44+'\x20|\x20Processing\x20sources\x20'+(_0x45a063+0x1)+'-'+_0x2eadac+'\x20of\x20'+sources_1[_0x4286c7(0x1ae)][_0x4286c7(0x194)]);}}let _0x235f17=0x0;for(const _0x1c8ebe of _0x4f8f1a){console[_0x4286c7(0x126)](_0x4286c7(0x1b1)+_0x1c8ebe[_0x4286c7(0x130)]);try{const _0x2b9e65=await parser[_0x4286c7(0x1c5)](_0x1c8ebe[_0x4286c7(0x1bc)]),_0x563b5e=_0x12ec06||MAX_ITEMS_PER_SOURCE,_0x19c271=_0x2b9e65[_0x4286c7(0x195)][_0x4286c7(0x12c)](isRecentItem)['slice'](0x0,_0x563b5e),_0x334f4d=_0x2b9e65['items']['length']-_0x19c271[_0x4286c7(0x194)]-(_0x2b9e65['items'][_0x4286c7(0x194)]>_0x563b5e?_0x2b9e65[_0x4286c7(0x195)][_0x4286c7(0x194)]-_0x563b5e:0x0),_0x29cc14=_0x19c271['filter'](_0x1592ea=>{const _0x38bec4=_0x4286c7,_0x513441=_0x1592ea[_0x38bec4(0x104)];return _0x513441&&!_0x455b56[_0x38bec4(0x162)](_0x513441);}),_0x1f524f=_0x19c271['length']-_0x29cc14['length'];console[_0x4286c7(0x126)]('\x20\x20'+_0x29cc14[_0x4286c7(0x194)]+_0x4286c7(0x14e)+_0x1f524f+_0x4286c7(0x12d)+_0x334f4d+_0x4286c7(0x15a));const _0x3e1e7b=await processBatch(_0x29cc14,_0x5e7877=>processItem(_0x5e7877,_0x1c8ebe),MAX_CONCURRENT_FETCHES);for(const _0x431f34 of _0x3e1e7b){if(_0x431f34&&_0x431f34[_0x4286c7(0x104)]){if(_0x431f34[_0x4286c7(0x193)]){const _0x45044f=_0x431f34[_0x4286c7(0x193)][_0x4286c7(0x198)](0x0,0x64);if(_0x46e500['has'](_0x45044f)){console[_0x4286c7(0x126)](_0x4286c7(0x138)+_0x431f34[_0x4286c7(0x136)][_0x4286c7(0x198)](0x0,0x28)+_0x4286c7(0x163));continue;}_0x46e500['add'](_0x45044f);}_0x52a24c['push'](_0x431f34),_0x455b56[_0x4286c7(0x17e)](_0x431f34[_0x4286c7(0x104)]),_0x235f17++;}}}catch(_0x494cfa){console[_0x4286c7(0x185)](_0x4286c7(0x141)+_0x1c8ebe[_0x4286c7(0x130)]+':',_0x494cfa[_0x4286c7(0x143)]),logError(_0x1c8ebe[_0x4286c7(0x130)],_0x1c8ebe[_0x4286c7(0x1bc)],_0x494cfa[_0x4286c7(0x143)]||_0x4286c7(0x137));}}fs['writeFileSync'](_0x4341f4,JSON['stringify'](_0x52a24c,null,0x2),_0x4286c7(0x107)),fs[_0x4286c7(0x10a)](INDEX_FILE,JSON['stringify'](Array['from'](_0x455b56),null,0x2),'utf-8'),saveErrorLog(),console[_0x4286c7(0x126)](_0x4286c7(0x14f)+_0x235f17+_0x4286c7(0x1dc));if(_0x54c83c===null){console[_0x4286c7(0x126)]('Starting\x20Aggregation\x20&\x20Classification...');const _0x59bfaa=new classifier_1['Classifier'](),_0x5521e0=new bucket_manager_1[(_0x4286c7(0x12a))](OUTPUT_DIR);await _0x5521e0[_0x4286c7(0x1d4)]();let _0x72e820=0x0;for(const _0xeddd21 of _0x52a24c){const _0x201592=_0x59bfaa[_0x4286c7(0x174)](_0xeddd21[_0x4286c7(0x136)],_0xeddd21[_0x4286c7(0x17b)]);if(_0x201592['length']>0x0){for(const _0x52bb71 of _0x201592){_0x5521e0[_0x4286c7(0x1bd)](_0xeddd21,_0x52bb71);}_0x72e820++;}}await _0x5521e0['flush']();const _0x255e6b=Date['now']();console['log'](_0x4286c7(0x1ad)+((_0x255e6b-_0x4ae98c)/0x3e8)[_0x4286c7(0x1aa)](0x2)+'s.\x20Classified\x20'+_0x72e820+_0x4286c7(0x1a2));}else{const _0x56772e=Date[_0x4286c7(0x18e)]();console[_0x4286c7(0x126)](_0x4286c7(0x1b6)+_0x54c83c+_0x4286c7(0x111)+((_0x56772e-_0x4ae98c)/0x3e8)[_0x4286c7(0x1aa)](0x2)+_0x4286c7(0x1a6));}}run()[a5_0xa79431(0x176)](console[a5_0xa79431(0x185)]);
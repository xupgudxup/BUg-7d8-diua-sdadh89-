'use strict';const a5_0x23cc3c=a5_0x3ba8;(function(_0x7445a0,_0x5c6df8){const _0x2cdbd4=a5_0x3ba8,_0x2f2caa=_0x7445a0();while(!![]){try{const _0xf6a696=-parseInt(_0x2cdbd4(0x142))/0x1*(parseInt(_0x2cdbd4(0x1a8))/0x2)+-parseInt(_0x2cdbd4(0x19d))/0x3*(parseInt(_0x2cdbd4(0x1ae))/0x4)+parseInt(_0x2cdbd4(0x174))/0x5+-parseInt(_0x2cdbd4(0x1b6))/0x6*(parseInt(_0x2cdbd4(0x15a))/0x7)+parseInt(_0x2cdbd4(0x1c0))/0x8*(-parseInt(_0x2cdbd4(0x1ac))/0x9)+-parseInt(_0x2cdbd4(0x146))/0xa*(-parseInt(_0x2cdbd4(0x162))/0xb)+-parseInt(_0x2cdbd4(0x1e9))/0xc*(-parseInt(_0x2cdbd4(0x16a))/0xd);if(_0xf6a696===_0x5c6df8)break;else _0x2f2caa['push'](_0x2f2caa['shift']());}catch(_0xd0600f){_0x2f2caa['push'](_0x2f2caa['shift']());}}}(a5_0x1457,0x9da39));var __createBinding=this&&this[a5_0x23cc3c(0x200)]||(Object['create']?function(_0x504f,_0x5a89f3,_0x2b4361,_0x2ce94b){const _0x5c1a1e=a5_0x23cc3c;if(_0x2ce94b===undefined)_0x2ce94b=_0x2b4361;var _0x3ff907=Object[_0x5c1a1e(0x18e)](_0x5a89f3,_0x2b4361);(!_0x3ff907||('get'in _0x3ff907?!_0x5a89f3['__esModule']:_0x3ff907[_0x5c1a1e(0x1dc)]||_0x3ff907[_0x5c1a1e(0x171)]))&&(_0x3ff907={'enumerable':!![],'get':function(){return _0x5a89f3[_0x2b4361];}}),Object['defineProperty'](_0x504f,_0x2ce94b,_0x3ff907);}:function(_0x155ece,_0x35fb77,_0x416775,_0x33cb8d){if(_0x33cb8d===undefined)_0x33cb8d=_0x416775;_0x155ece[_0x33cb8d]=_0x35fb77[_0x416775];}),__setModuleDefault=this&&this['__setModuleDefault']||(Object[a5_0x23cc3c(0x1aa)]?function(_0x5de680,_0x272f7a){const _0x18f35b=a5_0x23cc3c;Object[_0x18f35b(0x180)](_0x5de680,'default',{'enumerable':!![],'value':_0x272f7a});}:function(_0x20e05f,_0x315a53){const _0x29c937=a5_0x23cc3c;_0x20e05f[_0x29c937(0x1bf)]=_0x315a53;}),__importStar=this&&this['__importStar']||(function(){var _0x1c2798=function(_0xd10957){const _0x55e0cc=a5_0x3ba8;return _0x1c2798=Object[_0x55e0cc(0x1d1)]||function(_0x2e741f){const _0x36b207=_0x55e0cc;var _0xe6da3d=[];for(var _0x47ebc2 in _0x2e741f)if(Object['prototype'][_0x36b207(0x1a0)][_0x36b207(0x1d7)](_0x2e741f,_0x47ebc2))_0xe6da3d[_0xe6da3d[_0x36b207(0x147)]]=_0x47ebc2;return _0xe6da3d;},_0x1c2798(_0xd10957);};return function(_0xa9fa0a){const _0x370a47=a5_0x3ba8;if(_0xa9fa0a&&_0xa9fa0a[_0x370a47(0x149)])return _0xa9fa0a;var _0x35a429={};if(_0xa9fa0a!=null){for(var _0x558c04=_0x1c2798(_0xa9fa0a),_0x2b936b=0x0;_0x2b936b<_0x558c04[_0x370a47(0x147)];_0x2b936b++)if(_0x558c04[_0x2b936b]!=='default')__createBinding(_0x35a429,_0xa9fa0a,_0x558c04[_0x2b936b]);}return __setModuleDefault(_0x35a429,_0xa9fa0a),_0x35a429;};}()),__importDefault=this&&this[a5_0x23cc3c(0x196)]||function(_0x2ce5d7){return _0x2ce5d7&&_0x2ce5d7['__esModule']?_0x2ce5d7:{'default':_0x2ce5d7};};Object[a5_0x23cc3c(0x180)](exports,a5_0x23cc3c(0x149),{'value':!![]});const fs=__importStar(require('fs')),path=__importStar(require(a5_0x23cc3c(0x198))),rss_parser_1=__importDefault(require(a5_0x23cc3c(0x189))),node_html_parser_1=require(a5_0x23cc3c(0x1c1)),sources_1=require(a5_0x23cc3c(0x1ec)),article_extractor_1=require(a5_0x23cc3c(0x166)),classifier_1=require('./classifier'),bucket_manager_1=require(a5_0x23cc3c(0x1f0)),parser=new rss_parser_1['default'](),OUTPUT_DIR=path[a5_0x23cc3c(0x178)](__dirname,a5_0x23cc3c(0x201));!fs[a5_0x23cc3c(0x1bb)](OUTPUT_DIR)&&fs[a5_0x23cc3c(0x1d0)](OUTPUT_DIR,{'recursive':!![]});const INDEX_FILE=path['join'](OUTPUT_DIR,a5_0x23cc3c(0x1bd)),ERROR_LOG_FILE=path[a5_0x23cc3c(0x178)](OUTPUT_DIR,'error-log.json'),bannedKeywords=[a5_0x23cc3c(0x190),a5_0x23cc3c(0x1a9),'porn',a5_0x23cc3c(0x14a),a5_0x23cc3c(0x134),'sex\x20tape',a5_0x23cc3c(0x132),'gambling',a5_0x23cc3c(0x1ed),a5_0x23cc3c(0x1e0),a5_0x23cc3c(0x1f9),a5_0x23cc3c(0x207),a5_0x23cc3c(0x15e),a5_0x23cc3c(0x15d),a5_0x23cc3c(0x14d),a5_0x23cc3c(0x1b4),a5_0x23cc3c(0x13e),'prime\x20day',a5_0x23cc3c(0x1a5),a5_0x23cc3c(0x169),a5_0x23cc3c(0x1de),'boxing\x20day',a5_0x23cc3c(0x17a),a5_0x23cc3c(0x1c6),a5_0x23cc3c(0x151),a5_0x23cc3c(0x17c),a5_0x23cc3c(0x165),'christmas\x20deals','end\x20of\x20year\x20sale',a5_0x23cc3c(0x1d9),a5_0x23cc3c(0x1f8),a5_0x23cc3c(0x12f),'doorbuster',a5_0x23cc3c(0x1c2),a5_0x23cc3c(0x203),a5_0x23cc3c(0x138),a5_0x23cc3c(0x1c9),a5_0x23cc3c(0x15c),a5_0x23cc3c(0x153),'daily\x20deals',a5_0x23cc3c(0x148),'deal\x20of\x20the\x20day',a5_0x23cc3c(0x1b3),'price\x20drop',a5_0x23cc3c(0x17b),a5_0x23cc3c(0x204),'coupon\x20code','promo\x20code','voucher\x20code',a5_0x23cc3c(0x206),'save\x20big','huge\x20savings',a5_0x23cc3c(0x176),a5_0x23cc3c(0x16e),a5_0x23cc3c(0x1cb),'price\x20match',a5_0x23cc3c(0x173),a5_0x23cc3c(0x1d2),a5_0x23cc3c(0x158),a5_0x23cc3c(0x177),a5_0x23cc3c(0x1f7),a5_0x23cc3c(0x155),a5_0x23cc3c(0x17e),a5_0x23cc3c(0x1f4),'editors\x20choice',a5_0x23cc3c(0x18a),a5_0x23cc3c(0x1e5),a5_0x23cc3c(0x1d8),a5_0x23cc3c(0x1c8),'gift\x20guide',a5_0x23cc3c(0x14f),a5_0x23cc3c(0x1e7),a5_0x23cc3c(0x159),a5_0x23cc3c(0x140),'order\x20now','get\x20it\x20now','grab\x20it\x20now',a5_0x23cc3c(0x1ca),a5_0x23cc3c(0x1c3),'free\x20shipping',a5_0x23cc3c(0x1cf),a5_0x23cc3c(0x136),a5_0x23cc3c(0x1ea),'selling\x20fast',a5_0x23cc3c(0x191),'hurry','act\x20fast',a5_0x23cc3c(0x1fc),'last\x20chance','final\x20hours',a5_0x23cc3c(0x12c),a5_0x23cc3c(0x164),a5_0x23cc3c(0x18c),'we\x20earn\x20commission',a5_0x23cc3c(0x1d3),a5_0x23cc3c(0x13f)],bannedPatterns=[/\b\d{1,2}%\s*(off|discount|savings?)\b/i,/\bsave\s+\d{1,2}%/i,/\bup\s+to\s+\d{1,2}%\s*off\b/i,/\bsave\s+\$\d+/i,/\$\d+\s*off\b/i,/\bunder\s+\$\d+/i,/\bjust\s+\$\d+/i,/\bonly\s+\$\d+/i,/\bfrom\s+\$\d+/i,/\bstarting\s+at\s+\$\d+/i,/\bwas\s+\$\d+[,\s]+now\s+\$\d+/i,/\bregularly?\s+\$\d+/i,/\bnormally\s+\$\d+/i,/\b\d+\s+best\s+(deals?|products?|items?|gifts?|picks?|things?|ways?)\b/i,/\bbest\s+\d+\b/i,/\b(today|tonight|this\s+week)\s+only\b/i,/\bends?\s+(soon|today|tonight|tomorrow)\b/i,/\b(hours?|days?|minutes?)\s+left\b/i,/\b(limited\s+)?stock\s+(remaining|left|available)\b/i,/\b(grab|snag|score|get)\s+(this|these|the)\s+deal/i,/\bdeal\s+of\s+the\s+(day|week|month|year)\b/i,/\b(massive|huge|incredible|amazing|insane)\s+(deal|discount|savings?|sale)\b/i,/\b(don't|do\s+not)\s+miss\s+(this|these|out)\b/i];function isPromotionalContent(_0x392130){const _0x5c100f=a5_0x23cc3c,_0x101d50=_0x392130[_0x5c100f(0x202)]();if(bannedKeywords['some'](_0xfae5e9=>_0x101d50[_0x5c100f(0x182)](_0xfae5e9['toLowerCase']())))return!![];if(bannedPatterns['some'](_0x28b6c5=>_0x28b6c5[_0x5c100f(0x156)](_0x392130)))return!![];return![];}const bannedThumbnails=[a5_0x23cc3c(0x181)],phrasesToRemoveFromDescription=['(Source:\x20Bloomberg)',a5_0x23cc3c(0x199)],descriptionBylinePatterns=[/^By\s+[A-Z][a-z]+\s+[A-Z][a-z]+(\s+and\s+[A-Z][a-z]+\s+[A-Z][a-z]+)?\s+[A-Z]{2,}.*?\(Reuters\)\s*-?\s*/i,/^By\s+[A-Z][a-z]+\s+[A-Z][a-z]+(\s+and\s+[A-Z][a-z]+\s+[A-Z][a-z]+)?\s+[A-Z]{2,}.*?\(AP\)\s*-?\s*/i,/^By\s+[A-Z][a-z]+\s+[A-Z][a-z]+(\s+and\s+[A-Z][a-z]+\s+[A-Z][a-z]+)?\s+[A-Z]{2,}.*?\(AFP\)\s*-?\s*/i,/^By\s+[A-Z][a-z]+\s+[A-Z][a-z]+\s*/i,/^[A-Z]{2,}[A-Z\s,]+\(Reuters\)\s*-?\s*/i,/^[A-Z]{2,}[A-Z\s,]+\(AP\)\s*-?\s*/i,/^[A-Z]{2,}[A-Z\s,]+\(AFP\)\s*-?\s*/i,/^[A-Z]{3,},?\s+(Jan|Feb|Mar|Apr|May|Jun|Jul|Aug|Sep|Oct|Nov|Dec)\s+\d{1,2}\s+\([^)]+\)\s*-?\s*/i,/^(Jan|Feb|Mar|Apr|May|Jun|Jul|Aug|Sep|Oct|Nov|Dec)\s+\d{1,2}\s+\([^)]+\)\s*-?\s*/i];function cleanDescriptionBylines(_0x49db45){const _0x15177d=a5_0x23cc3c;if(!_0x49db45)return null;let _0x2af3b7=_0x49db45;for(const _0x1ce297 of descriptionBylinePatterns){_0x2af3b7=_0x2af3b7[_0x15177d(0x1af)](_0x1ce297,'');}return _0x2af3b7[_0x15177d(0x15b)]();}const phrasesToRemoveFromTitle=[a5_0x23cc3c(0x1ef),a5_0x23cc3c(0x1dd)],MAX_CONCURRENT_FETCHES=0x5,MAX_ITEMS_PER_SOURCE=0x64;function isRecentItem(_0x5ba906){const _0x44c566=a5_0x23cc3c;if(!_0x5ba906['pubDate']&&!_0x5ba906[_0x44c566(0x14e)])return!![];try{const _0x1fab2c=new Date(_0x5ba906[_0x44c566(0x187)]||_0x5ba906[_0x44c566(0x14e)]),_0x2b04f3=new Date(),_0x47f6c3=new Date(_0x2b04f3['getFullYear'](),_0x2b04f3[_0x44c566(0x1b8)](),_0x2b04f3[_0x44c566(0x1c5)]()),_0x1a7ff9=new Date(_0x47f6c3);return _0x1a7ff9[_0x44c566(0x139)](_0x1a7ff9[_0x44c566(0x1c5)]()-0x1),_0x1fab2c>=_0x1a7ff9;}catch{return!![];}}function parseArgs(){const _0x212063=a5_0x23cc3c,_0x206ab5=process[_0x212063(0x1e8)]['slice'](0x2);let _0x108ce6=null,_0x1c558e=null,_0x13e913=![];for(const _0x410ff2 of _0x206ab5){if(_0x410ff2['startsWith'](_0x212063(0x183)))_0x108ce6=parseInt(_0x410ff2[_0x212063(0x160)]('=')[0x1],0xa);else{if(_0x410ff2[_0x212063(0x179)]('--total-batches='))_0x1c558e=parseInt(_0x410ff2[_0x212063(0x160)]('=')[0x1],0xa);else _0x410ff2==='--test'&&(_0x13e913=!![]);}}return{'batch':_0x108ce6,'totalBatches':_0x1c558e,'test':_0x13e913};}function cleanCdata(_0xd741d2){const _0x371bfb=a5_0x23cc3c;return _0xd741d2[_0x371bfb(0x1af)](/<!\[CDATA\[|\]\]>/g,'')[_0x371bfb(0x15b)]();}function a5_0x3ba8(_0x66179b,_0x113bff){const _0x14574c=a5_0x1457();return a5_0x3ba8=function(_0x3ba867,_0x25f333){_0x3ba867=_0x3ba867-0x12c;let _0x5e4671=_0x14574c[_0x3ba867];return _0x5e4671;},a5_0x3ba8(_0x66179b,_0x113bff);}function stripHtml(_0x39596a){const _0x1d2dee=a5_0x23cc3c;return(0x0,node_html_parser_1[_0x1d2dee(0x197)])(_0x39596a)[_0x1d2dee(0x1b1)]||'';}function removePhrases(_0x19613e,_0x40d2af){const _0x2fd26a=a5_0x23cc3c;if(!_0x19613e)return null;let _0x199a67=_0x19613e;for(const _0x3c8ad0 of _0x40d2af){_0x199a67=_0x199a67[_0x2fd26a(0x1af)](_0x3c8ad0,'')['trim']();}return _0x199a67;}function truncateDescription(_0x5dfb40){const _0x19bfa4=a5_0x23cc3c;if(!_0x5dfb40)return null;const _0x41ed97=_0x5dfb40[_0x19bfa4(0x160)](/\n\s*\n/);let _0x2e72c7=_0x41ed97[0x0]||'';const _0x154f63=_0x2e72c7[_0x19bfa4(0x19f)](/[^.!?]+[.!?]+|[^.!?]+$/g)||[];_0x154f63[_0x19bfa4(0x147)]>0x5?_0x2e72c7=_0x154f63[_0x19bfa4(0x1f1)](0x0,0x5)[_0x19bfa4(0x178)]('')['trim']():_0x2e72c7=_0x154f63[_0x19bfa4(0x178)]('')[_0x19bfa4(0x15b)]();if(_0x2e72c7[_0x19bfa4(0x147)]<_0x5dfb40[_0x19bfa4(0x147)]&&!/[.!?]$/[_0x19bfa4(0x156)](_0x2e72c7)){const _0x3b89f1=_0x2e72c7[_0x19bfa4(0x18b)]('\x20');_0x3b89f1>-0x1?_0x2e72c7=_0x2e72c7['substring'](0x0,_0x3b89f1)+'...':_0x2e72c7=_0x2e72c7+'...';}return _0x2e72c7['length']>0x0?_0x2e72c7:null;}async function isImageLargeEnough(_0x365b4f){const _0x5584a8=a5_0x23cc3c;try{const _0x1d3711=await fetch(_0x365b4f,{'method':'HEAD','signal':AbortSignal[_0x5584a8(0x13d)](0x7d0)});if(!_0x1d3711['ok']){if(_0x1d3711[_0x5584a8(0x1a1)]===0x194)return![];return!![];}const _0x2a4f35=_0x1d3711[_0x5584a8(0x13b)]['get'](_0x5584a8(0x1c7));if(_0x2a4f35){const _0x705d3a=parseInt(_0x2a4f35,0xa);if(_0x705d3a<0x3a98)return![];}return!![];}catch{return!![];}}async function fetchArticleMetadata(_0x53586e){const _0x2fa3d4=a5_0x23cc3c;try{const _0x524066=await fetch(_0x53586e,{'signal':AbortSignal[_0x2fa3d4(0x13d)](0x3a98),'headers':{'User-Agent':_0x2fa3d4(0x163),'Accept':_0x2fa3d4(0x17f)}});if(!_0x524066['ok'])throw new Error(_0x2fa3d4(0x131)+_0x524066[_0x2fa3d4(0x1a1)]);const _0x46156f=await _0x524066[_0x2fa3d4(0x161)](),_0x2b9b42=(0x0,node_html_parser_1[_0x2fa3d4(0x197)])(_0x46156f);let _0x305033=null;const _0x3a21d4=[_0x2fa3d4(0x1e1),_0x2fa3d4(0x1b2),'meta[name=\x22description\x22]'];for(const _0x286a47 of _0x3a21d4){const _0x4edcb6=_0x2b9b42[_0x2fa3d4(0x16c)](_0x286a47);if(_0x4edcb6&&_0x4edcb6[_0x2fa3d4(0x1da)](_0x2fa3d4(0x1df))){_0x305033=stripHtml(_0x4edcb6[_0x2fa3d4(0x1da)]('content'))||null,_0x305033=removePhrases(_0x305033,phrasesToRemoveFromDescription),_0x305033=cleanDescriptionBylines(_0x305033),_0x305033=truncateDescription(_0x305033);break;}}let _0x224cfc=null;const _0x2ac1da=[_0x2fa3d4(0x1cc),_0x2fa3d4(0x137)];for(const _0x34b247 of _0x2ac1da){const _0x29014b=_0x2b9b42[_0x2fa3d4(0x16c)](_0x34b247);if(_0x29014b&&_0x29014b[_0x2fa3d4(0x1da)]('content')){_0x224cfc=_0x29014b[_0x2fa3d4(0x1da)](_0x2fa3d4(0x1df));break;}}return{'description':_0x305033,'thumbnail_url':_0x224cfc,'html':_0x46156f};}catch{return{'description':null,'thumbnail_url':null,'html':null};}}let errorLog=[];function logError(_0x23d040,_0x5800e1,_0x3ec8c7){const _0x3b2bac=a5_0x23cc3c;errorLog[_0x3b2bac(0x1ff)]({'source':_0x23d040,'url':_0x5800e1,'error':_0x3ec8c7,'timestamp':new Date()[_0x3b2bac(0x1ad)]()});}function saveErrorLog(){const _0x5259f1=a5_0x23cc3c;if(errorLog[_0x5259f1(0x147)]===0x0)return;let _0x105bab=[];if(fs[_0x5259f1(0x1bb)](ERROR_LOG_FILE))try{_0x105bab=JSON[_0x5259f1(0x197)](fs[_0x5259f1(0x1cd)](ERROR_LOG_FILE,'utf-8'));}catch{}const _0xc75484=[..._0x105bab,...errorLog][_0x5259f1(0x1f1)](-0x64);fs['writeFileSync'](ERROR_LOG_FILE,JSON[_0x5259f1(0x167)](_0xc75484,null,0x2),_0x5259f1(0x1b9));}async function processItem(_0x3a89b6,_0x36b930){const _0x57352d=a5_0x23cc3c;let _0x277643=_0x3a89b6[_0x57352d(0x1e4)]?stripHtml(cleanCdata(_0x3a89b6[_0x57352d(0x1e4)])):null;_0x277643=removePhrases(_0x277643,phrasesToRemoveFromTitle);let _0x46be27=_0x3a89b6[_0x57352d(0x1a7)],_0xfa61a0=null;if(_0x36b930[_0x57352d(0x1d5)]['includes'](_0x57352d(0x1db))){if(_0x3a89b6[_0x57352d(0x1df)]){const _0x288c39=(0x0,node_html_parser_1[_0x57352d(0x197)])(_0x3a89b6[_0x57352d(0x1df)]),_0xb841ff=_0x288c39[_0x57352d(0x16c)]('p\x20a');_0xb841ff&&_0xb841ff['text'][_0x57352d(0x179)]('Article\x20URL:')&&(_0x46be27=_0xb841ff[_0x57352d(0x1da)]('href'));}_0xfa61a0=null;}else _0x3a89b6[_0x57352d(0x15f)]&&(_0xfa61a0=stripHtml(cleanCdata(_0x3a89b6[_0x57352d(0x15f)]))||null,_0xfa61a0=removePhrases(_0xfa61a0,phrasesToRemoveFromDescription),_0xfa61a0=cleanDescriptionBylines(_0xfa61a0),_0xfa61a0=truncateDescription(_0xfa61a0));!_0xfa61a0&&_0x3a89b6[_0x57352d(0x1be)]&&(_0xfa61a0=stripHtml(cleanCdata(_0x3a89b6['content:encoded']))||null,_0xfa61a0=removePhrases(_0xfa61a0,phrasesToRemoveFromDescription),_0xfa61a0=cleanDescriptionBylines(_0xfa61a0),_0xfa61a0=truncateDescription(_0xfa61a0));_0x36b930[_0x57352d(0x1d5)]===_0x57352d(0x1fa)&&_0x3a89b6[_0x57352d(0x193)]&&(_0xfa61a0=stripHtml(cleanCdata(_0x3a89b6[_0x57352d(0x193)]))||null,_0xfa61a0=removePhrases(_0xfa61a0,phrasesToRemoveFromDescription),_0xfa61a0=cleanDescriptionBylines(_0xfa61a0),_0xfa61a0=truncateDescription(_0xfa61a0));if(!_0x277643||!_0x46be27)return null;const _0x4f2a77=_0x277643+'\x20'+(_0x3a89b6[_0x57352d(0x15f)]?stripHtml(_0x3a89b6['contentSnippet']):'')+'\x20'+(_0x3a89b6['description']?stripHtml(_0x3a89b6[_0x57352d(0x193)]):'');if(isPromotionalContent(_0x4f2a77))return null;let _0x512035=_0x3a89b6[_0x57352d(0x170)]?_0x3a89b6[_0x57352d(0x170)][_0x57352d(0x1d5)]:null;if(_0x3a89b6[_0x57352d(0x1fe)]){if(Array[_0x57352d(0x168)](_0x3a89b6['media:content'])){const _0xf55691=_0x3a89b6[_0x57352d(0x1fe)][_0x57352d(0x188)]((_0x5cd4d2,_0x29eab0)=>{const _0x395e99=_0x57352d,_0x323cd1=_0x5cd4d2['$']&&_0x5cd4d2['$']['width']?parseInt(_0x5cd4d2['$']['width'],0xa):0x0,_0x57bc13=_0x29eab0['$']&&_0x29eab0['$'][_0x395e99(0x1a3)]?parseInt(_0x29eab0['$']['width'],0xa):0x0;return _0x57bc13-_0x323cd1;}),_0x519cbe=_0xf55691[0x0];if(_0x519cbe){const _0x337f72=_0x519cbe['$']&&_0x519cbe['$'][_0x57352d(0x1a3)]?parseInt(_0x519cbe['$'][_0x57352d(0x1a3)],0xa):0x0;if(_0x337f72===0x0||_0x337f72>=0x12c){if(_0x519cbe['$']&&_0x519cbe['$'][_0x57352d(0x1d5)])_0x512035=_0x519cbe['$'][_0x57352d(0x1d5)];else{if(_0x519cbe['url'])_0x512035=_0x519cbe[_0x57352d(0x1d5)];}}}}else{const _0x34fcef=_0x3a89b6['media:content'],_0x329314=_0x34fcef['$']&&_0x34fcef['$'][_0x57352d(0x1a3)]?parseInt(_0x34fcef['$'][_0x57352d(0x1a3)],0xa):_0x34fcef[_0x57352d(0x1a3)]?parseInt(_0x34fcef[_0x57352d(0x1a3)],0xa):0x0;if(_0x329314===0x0||_0x329314>=0x12c){if(_0x34fcef['$']&&_0x34fcef['$'][_0x57352d(0x1d5)])_0x512035=_0x34fcef['$'][_0x57352d(0x1d5)];else{if(_0x34fcef[_0x57352d(0x1d5)])_0x512035=_0x34fcef[_0x57352d(0x1d5)];}}}}if(!_0x512035&&_0x3a89b6['media:thumbnail']){if(_0x3a89b6[_0x57352d(0x141)]['$']&&_0x3a89b6[_0x57352d(0x141)]['$'][_0x57352d(0x1d5)])_0x512035=_0x3a89b6[_0x57352d(0x141)]['$']['url'];else _0x3a89b6[_0x57352d(0x141)][_0x57352d(0x1d5)]&&(_0x512035=_0x3a89b6[_0x57352d(0x141)]['url']);}_0x512035&&bannedThumbnails[_0x57352d(0x182)](_0x512035)&&(_0x512035=null);let _0x380a21=null,_0x526a46={'fullText':null,'readingTime':0x0,'keywords':[],'qualityScore':0x0};const _0x620a1d=!_0xfa61a0||!_0x512035||_0x36b930[_0x57352d(0x1d5)]['includes']('hnrss.org')||_0x36b930[_0x57352d(0x1d5)]===_0x57352d(0x1fa)||_0x36b930['url']===_0x57352d(0x16d);try{const _0x32457f=await fetchArticleMetadata(_0x46be27);_0x380a21=_0x32457f[_0x57352d(0x143)],!_0xfa61a0&&(_0xfa61a0=_0x32457f[_0x57352d(0x193)]),!_0x512035&&(_0x512035=_0x32457f[_0x57352d(0x1fb)]);}catch(_0x106c6b){logError(_0x36b930[_0x57352d(0x150)],_0x46be27,_0x106c6b['message']||_0x57352d(0x1a2));}if(_0x380a21){_0x526a46=(0x0,article_extractor_1[_0x57352d(0x1d6)])(_0x380a21,_0x46be27);if(_0x526a46[_0x57352d(0x1ab)]&&isPromotionalContent(_0x526a46[_0x57352d(0x1ab)]))return console[_0x57352d(0x1a6)]('[Filter]\x20Blocked\x20by\x20content\x20check:\x20'+_0x277643),null;}_0x512035&&bannedThumbnails[_0x57352d(0x182)](_0x512035)&&(_0x512035=null);if(_0x512035){const _0x33d26=await isImageLargeEnough(_0x512035);!_0x33d26&&(_0x512035=null);}if(!_0x512035)return null;const _0x5d94ff=_0x277643[_0x57352d(0x202)]()['replace'](/[^a-z0-9\s]/g,'')[_0x57352d(0x15b)]()[_0x57352d(0x1af)](/\s+/g,'-');let _0x2ad756=_0x5d94ff['substring'](0x0,0x78);if(_0x5d94ff[_0x57352d(0x147)]>0x78){const _0x35b54b=_0x2ad756[_0x57352d(0x18b)]('-');_0x35b54b>0x0&&(_0x2ad756=_0x2ad756['substring'](0x0,_0x35b54b));}_0x2ad756=_0x2ad756['replace'](/-+$/,'');!_0x2ad756&&(_0x2ad756='post-'+Date[_0x57352d(0x1f2)]());const _0x17b965=(0x0,sources_1['resolveTopicFromUrl'])(_0x46be27,_0x36b930['name'],_0x36b930[_0x57352d(0x13c)]||'news');return{'slug':_0x2ad756,'title':_0x277643,'description':_0xfa61a0,'fullText':_0x526a46[_0x57352d(0x1ab)],'readingTime':_0x526a46['readingTime'],'keywords':_0x526a46['keywords'],'qualityScore':_0x526a46['qualityScore'],'link':_0x46be27,'thumbnail_url':_0x512035,'created_at':new Date()[_0x57352d(0x1ad)](),'topic':_0x17b965};}async function processInParallel(_0x427a15,_0x582dff,_0x4c0ef2){const _0x466ca4=a5_0x23cc3c,_0x24e0cb=[],_0x323579=[];for(const _0x87d146 of _0x427a15){const _0x3443d8=_0x582dff(_0x87d146)['then'](_0x3ba6ad=>{const _0x485cb1=a5_0x3ba8;_0x24e0cb[_0x485cb1(0x1ff)](_0x3ba6ad);})[_0x466ca4(0x1ee)](()=>{_0x24e0cb['push'](null);});_0x323579[_0x466ca4(0x1ff)](_0x3443d8);if(_0x323579[_0x466ca4(0x147)]>=_0x4c0ef2){await Promise[_0x466ca4(0x186)](_0x323579);const _0x3110a0=_0x323579[_0x466ca4(0x19e)](_0x38ed58=>{const _0x53ed53=_0x466ca4;let _0x14cb00=![];return _0x38ed58[_0x53ed53(0x154)](()=>{_0x14cb00=!![];})['catch'](()=>{_0x14cb00=!![];}),!_0x14cb00;});_0x323579[_0x466ca4(0x147)]=0x0,_0x323579['push'](..._0x3110a0);}}return await Promise[_0x466ca4(0x144)](_0x323579),_0x24e0cb;}async function processBatch(_0x4e6297,_0x3f21ff,_0x57c1a9=MAX_CONCURRENT_FETCHES){const _0xe71c38=a5_0x23cc3c,_0x226aab=[];for(let _0x447ec3=0x0;_0x447ec3<_0x4e6297['length'];_0x447ec3+=_0x57c1a9){const _0xf96cb2=_0x4e6297[_0xe71c38(0x1f1)](_0x447ec3,_0x447ec3+_0x57c1a9),_0x45a635=await Promise[_0xe71c38(0x1e2)](_0xf96cb2[_0xe71c38(0x12e)](_0x34215f=>_0x3f21ff(_0x34215f)));for(const _0x22e2b2 of _0x45a635){_0x22e2b2[_0xe71c38(0x1a1)]===_0xe71c38(0x1e3)?_0x226aab['push'](_0x22e2b2['value']):_0x226aab[_0xe71c38(0x1ff)](null);}}return _0x226aab;}async function run(){const _0x106eb6=a5_0x23cc3c,{batch:_0x312f3c,totalBatches:_0xed20a6,test:_0x349415}=parseArgs();console['log'](_0x106eb6(0x185));_0x312f3c!==null&&_0xed20a6!==null&&console[_0x106eb6(0x1a6)](_0x106eb6(0x1e6)+(_0x312f3c+0x1)+_0x106eb6(0x1f5)+_0xed20a6);const _0x19541f=Date[_0x106eb6(0x1f2)](),_0x2b7f68=new Date()[_0x106eb6(0x1ad)]()[_0x106eb6(0x160)]('T')[0x0],_0x41a808=path[_0x106eb6(0x178)](OUTPUT_DIR,_0x2b7f68+'.json');let _0x513173=[];if(fs['existsSync'](INDEX_FILE))try{_0x513173=JSON[_0x106eb6(0x197)](fs['readFileSync'](INDEX_FILE,_0x106eb6(0x1b9)));}catch{console[_0x106eb6(0x157)](_0x106eb6(0x1ba));}const _0x1239a1=new Set(_0x513173),_0x156889=new Set();let _0x17e5a9=[];if(fs[_0x106eb6(0x1bb)](_0x41a808))try{_0x17e5a9=JSON[_0x106eb6(0x197)](fs['readFileSync'](_0x41a808,_0x106eb6(0x1b9)));for(const _0x8cc2aa of _0x17e5a9){_0x8cc2aa[_0x106eb6(0x1ab)]&&_0x156889[_0x106eb6(0x135)](_0x8cc2aa['fullText']['substring'](0x0,0x64));}}catch{console[_0x106eb6(0x157)](_0x106eb6(0x145));}let _0xa96cf3=[...sources_1['sourcesData']],_0x4e7f37=null;if(_0x349415)console[_0x106eb6(0x1a6)](_0x106eb6(0x133)),_0xa96cf3=sources_1[_0x106eb6(0x13a)][_0x106eb6(0x1f1)](0x0,0x1),_0x4e7f37=0xa;else{if(_0x312f3c!==null&&_0xed20a6!==null){const _0x635b98=0x5,_0x6f1e6c=Math['min'](_0xed20a6,Math[_0x106eb6(0x16b)](0x1,Math[_0x106eb6(0x14b)](sources_1['sourcesData']['length']/_0x635b98)));if(_0x312f3c>=_0x6f1e6c){console['log']('‚è≠Ô∏è\x20Batch\x20'+(_0x312f3c+0x1)+_0x106eb6(0x194)+_0x6f1e6c+_0x106eb6(0x1f3)+sources_1[_0x106eb6(0x13a)][_0x106eb6(0x147)]+_0x106eb6(0x1b0));return;}const _0x5b2758=Math['ceil'](sources_1[_0x106eb6(0x13a)][_0x106eb6(0x147)]/_0x6f1e6c),_0x5ad128=_0x312f3c*_0x5b2758,_0x25506f=Math[_0x106eb6(0x1a4)](_0x5ad128+_0x5b2758,sources_1[_0x106eb6(0x13a)]['length']);_0xa96cf3=sources_1[_0x106eb6(0x13a)][_0x106eb6(0x1f1)](_0x5ad128,_0x25506f),console[_0x106eb6(0x1a6)](_0x106eb6(0x18f)+(_0x312f3c+0x1)+'/'+_0x6f1e6c+_0x106eb6(0x184)+(_0x5ad128+0x1)+'-'+_0x25506f+_0x106eb6(0x1f5)+sources_1[_0x106eb6(0x13a)][_0x106eb6(0x147)]);}}let _0x350b63=0x0;for(const _0xc45326 of _0xa96cf3){console[_0x106eb6(0x1a6)](_0x106eb6(0x1b5)+_0xc45326[_0x106eb6(0x150)]);try{const _0x33ad86=await parser['parseURL'](_0xc45326['url']),_0x62d2f2=_0x4e7f37||MAX_ITEMS_PER_SOURCE,_0x4bddc4=_0x33ad86['items'][_0x106eb6(0x19e)](isRecentItem)['slice'](0x0,_0x62d2f2),_0x49c8bc=_0x33ad86['items'][_0x106eb6(0x147)]-_0x4bddc4[_0x106eb6(0x147)]-(_0x33ad86['items'][_0x106eb6(0x147)]>_0x62d2f2?_0x33ad86[_0x106eb6(0x175)][_0x106eb6(0x147)]-_0x62d2f2:0x0),_0x170d3e=_0x4bddc4[_0x106eb6(0x19e)](_0x533963=>{const _0x2c2a8c=_0x106eb6,_0x3e83a6=_0x533963[_0x2c2a8c(0x1a7)];return _0x3e83a6&&!_0x1239a1[_0x2c2a8c(0x1eb)](_0x3e83a6);}),_0x537191=_0x4bddc4['length']-_0x170d3e[_0x106eb6(0x147)];console[_0x106eb6(0x1a6)]('\x20\x20'+_0x170d3e['length']+_0x106eb6(0x14c)+_0x537191+_0x106eb6(0x1c4)+_0x49c8bc+'\x20old\x20(filtered)');const _0x51626a=await processBatch(_0x170d3e,_0x540845=>processItem(_0x540845,_0xc45326),MAX_CONCURRENT_FETCHES);for(const _0x524b05 of _0x51626a){if(_0x524b05&&_0x524b05[_0x106eb6(0x1a7)]){if(_0x524b05[_0x106eb6(0x1ab)]){const _0x5ed98d=_0x524b05[_0x106eb6(0x1ab)][_0x106eb6(0x19b)](0x0,0x64);if(_0x156889[_0x106eb6(0x1eb)](_0x5ed98d)){console[_0x106eb6(0x1a6)](_0x106eb6(0x18d)+_0x524b05['title'][_0x106eb6(0x19b)](0x0,0x28)+'...');continue;}_0x156889[_0x106eb6(0x135)](_0x5ed98d);}_0x17e5a9[_0x106eb6(0x1ff)](_0x524b05),_0x1239a1[_0x106eb6(0x135)](_0x524b05['link']),_0x350b63++;}}}catch(_0x5a572e){console['error'](_0x106eb6(0x1fd)+_0xc45326[_0x106eb6(0x150)]+':',_0x5a572e[_0x106eb6(0x1bc)]),logError(_0xc45326[_0x106eb6(0x150)],_0xc45326[_0x106eb6(0x1d5)],_0x5a572e[_0x106eb6(0x1bc)]||_0x106eb6(0x1b7));}}fs[_0x106eb6(0x19a)](_0x41a808,JSON[_0x106eb6(0x167)](_0x17e5a9,null,0x2),_0x106eb6(0x1b9)),fs[_0x106eb6(0x19a)](INDEX_FILE,JSON[_0x106eb6(0x167)](Array['from'](_0x1239a1),null,0x2),_0x106eb6(0x1b9)),saveErrorLog(),console[_0x106eb6(0x1a6)](_0x106eb6(0x208)+_0x350b63+_0x106eb6(0x1ce));if(_0x312f3c===null){console[_0x106eb6(0x1a6)](_0x106eb6(0x12d));const _0x1702ca=new classifier_1['Classifier'](),_0x353e9e=new bucket_manager_1[(_0x106eb6(0x152))](OUTPUT_DIR);await _0x353e9e[_0x106eb6(0x195)]();let _0x11c2f8=0x0;for(const _0x5b41bc of _0x17e5a9){const _0x496f5d=_0x1702ca[_0x106eb6(0x205)](_0x5b41bc['title'],_0x5b41bc['description']);if(_0x496f5d[_0x106eb6(0x147)]>0x0){for(const _0x315f18 of _0x496f5d){_0x353e9e['addPost'](_0x5b41bc,_0x315f18);}_0x11c2f8++;}}await _0x353e9e[_0x106eb6(0x19c)]();const _0x3e10b4=Date[_0x106eb6(0x1f2)]();console['log'](_0x106eb6(0x172)+((_0x3e10b4-_0x19541f)/0x3e8)['toFixed'](0x2)+_0x106eb6(0x1d4)+_0x11c2f8+_0x106eb6(0x192));}else{const _0x1b650a=Date['now']();console[_0x106eb6(0x1a6)](_0x106eb6(0x1f6)+_0x312f3c+_0x106eb6(0x130)+((_0x1b650a-_0x19541f)/0x3e8)[_0x106eb6(0x17d)](0x2)+_0x106eb6(0x16f));}}function a5_0x1457(){const _0x451d98=['length','hot\x20deals','__esModule','pornography','ceil','\x20new\x20|\x20','SEC\x20filing','isoDate','holiday\x20gift','name','holiday\x20sale','BucketManager','deals\x20today','then','best\x20of\x202025','test','error','budget\x20friendly','buy\x20now','1099MVuUia','trim','top\x20deals','Form\x20144','Form\x2013G','contentSnippet','split','text','33dOSCvV','Mozilla/5.0\x20(compatible;\x20NewsBot/1.0)','sponsored\x20post','christmas\x20sale','./article-extractor','stringify','isArray','amazon\x20prime\x20day','13NqzzYI','max','querySelector','https://www.investing.com/rss/news.rss','lowest\x20price','s.\x20Classification\x20will\x20run\x20in\x20merge\x20step.','enclosure','configurable','Job\x20Complete\x20in\x20','unbeatable\x20price','484890xwxGoi','items','massive\x20discount','affordable\x20pick','join','startsWith','memorial\x20day\x20sale','price\x20cut','holiday\x20deals','toFixed','top\x20picks','text/html,application/xhtml+xml','defineProperty','https://s.yimg.com/cv/apiv2/social/images/yahoo_default_logo-1200x1200.png','includes','--batch=','\x20|\x20Processing\x20sources\x20','Starting\x20job...','race','pubDate','sort','rss-parser','staff\x20picks','lastIndexOf','paid\x20partnership','\x20\x20Skipped\x20duplicate:\x20','getOwnPropertyDescriptor','üîÑ\x20Batch\x20','Only\x20Fans','selling\x20out','\x20posts.','description','\x20not\x20needed\x20(only\x20','init','__importDefault','parse','path','Read\x20more\x20of\x20this\x20story\x20at\x20Slashdot.','writeFileSync','substring','flush','129uIHQfT','filter','match','hasOwnProperty','status','Fetch\x20failed','width','min','prime\x20week','log','link','51330zjrzis','onlyfans','create','fullText','27WYQGzc','toISOString','115812FSOJzm','replace','\x20sources).\x20Skipping.','textContent','meta[name=\x22twitter:description\x22]','deal\x20alert','black\x20friday','Processing\x20source:\x20','31854YDarmG','Feed\x20fetch\x20failed','getMonth','utf-8','Error\x20reading\x20index\x20file,\x20starting\x20fresh.','existsSync','message','index.json','content:encoded','default','2661248ixsLFk','node-html-parser','door\x20buster','checkout','\x20cached\x20|\x20','getDate','labor\x20day\x20sale','content-length','buying\x20guide','best\x20deals','add\x20to\x20cart','best\x20price','meta[property=\x22og:image\x22]','readFileSync','\x20items.','fast\x20shipping','mkdirSync','getOwnPropertyNames','budget\x20pick','we\x20may\x20earn','s.\x20Classified\x20','url','extractArticle','call','we\x20reviewed','year\x20end\x20sale','getAttribute','hnrss.org','writable','Show\x20HN:','singles\x20day','content','slot\x20machine','meta[property=\x22og:description\x22]','allSettled','fulfilled','title','we\x20tested','Running\x20batch\x20','gift\x20ideas','argv','43207860eaqhhn','back\x20in\x20stock','has','./sources','casino','catch','Tell\x20HN:','./bucket-manager','slice','now','\x20batches\x20required\x20for\x20','our\x20picks','\x20of\x20','Batch\x20','best\x20of\x202024','clearance\x20sale','sports\x20betting','https://rss.slashdot.org/Slashdot/slashdot','thumbnail_url','dont\x20miss','Error\x20fetching\x20source\x20','media:content','push','__createBinding','../output','toLowerCase','limited\x20time\x20offer','discount\x20code','classify','save\x20money','Form\x2013F','Scrape\x20finished.\x20Added\x20','affiliate\x20link','Starting\x20Aggregation\x20&\x20Classification...','map','flash\x20sale','\x20complete\x20in\x20','HTTP\x20error!\x20status:\x20','nsfw','‚ö†Ô∏è\x20RUNNING\x20IN\x20TEST\x20MODE:\x20Limiting\x20to\x201\x20source\x20and\x2010\x20items.','xxx','add','in\x20stock','meta[name=\x22twitter:image\x22]','limited\x20time\x20deal','setDate','sourcesData','headers','topic','timeout','cyber\x20monday','as\x20an\x20amazon\x20associate','shop\x20now','media:thumbnail','11Hwrtna','html','all','Error\x20reading\x20daily\x20file,\x20starting\x20fresh.','1022770UJUJzl'];a5_0x1457=function(){return _0x451d98;};return a5_0x1457();}run()[a5_0x23cc3c(0x1ee)](console['error']);
'use strict';const a4_0x1787a4=a4_0x7b4b;(function(_0x5e91d5,_0x2673b8){const _0x124b54=a4_0x7b4b,_0x2d873a=_0x5e91d5();while(!![]){try{const _0x58e434=parseInt(_0x124b54(0x27e))/0x1+parseInt(_0x124b54(0x24f))/0x2+parseInt(_0x124b54(0x1ed))/0x3+parseInt(_0x124b54(0x20b))/0x4+parseInt(_0x124b54(0x226))/0x5+parseInt(_0x124b54(0x23f))/0x6+parseInt(_0x124b54(0x1c8))/0x7*(-parseInt(_0x124b54(0x22f))/0x8);if(_0x58e434===_0x2673b8)break;else _0x2d873a['push'](_0x2d873a['shift']());}catch(_0x59a2d4){_0x2d873a['push'](_0x2d873a['shift']());}}}(a4_0x2227,0x5c9fc));var __createBinding=this&&this[a4_0x1787a4(0x281)]||(Object[a4_0x1787a4(0x21f)]?function(_0xa659da,_0x5df476,_0x4f2470,_0x30724b){const _0x1d508b=a4_0x1787a4;if(_0x30724b===undefined)_0x30724b=_0x4f2470;var _0xb339e0=Object[_0x1d508b(0x1d5)](_0x5df476,_0x4f2470);(!_0xb339e0||(_0x1d508b(0x249)in _0xb339e0?!_0x5df476[_0x1d508b(0x276)]:_0xb339e0[_0x1d508b(0x21a)]||_0xb339e0['configurable']))&&(_0xb339e0={'enumerable':!![],'get':function(){return _0x5df476[_0x4f2470];}}),Object[_0x1d508b(0x251)](_0xa659da,_0x30724b,_0xb339e0);}:function(_0x3da2a2,_0x39fc70,_0x5d4e9d,_0x4d7fa4){if(_0x4d7fa4===undefined)_0x4d7fa4=_0x5d4e9d;_0x3da2a2[_0x4d7fa4]=_0x39fc70[_0x5d4e9d];}),__setModuleDefault=this&&this[a4_0x1787a4(0x1dc)]||(Object[a4_0x1787a4(0x21f)]?function(_0x2b2d5c,_0x461618){const _0x85b106=a4_0x1787a4;Object[_0x85b106(0x251)](_0x2b2d5c,'default',{'enumerable':!![],'value':_0x461618});}:function(_0xc61e7,_0x3268b6){const _0x550443=a4_0x1787a4;_0xc61e7[_0x550443(0x1ba)]=_0x3268b6;}),__importStar=this&&this[a4_0x1787a4(0x273)]||(function(){var _0x1746d3=function(_0x371ee4){const _0x142d50=a4_0x7b4b;return _0x1746d3=Object[_0x142d50(0x27a)]||function(_0x1d24e5){const _0x571cf8=_0x142d50;var _0x4cc762=[];for(var _0x150ab7 in _0x1d24e5)if(Object['prototype'][_0x571cf8(0x1da)][_0x571cf8(0x263)](_0x1d24e5,_0x150ab7))_0x4cc762[_0x4cc762[_0x571cf8(0x252)]]=_0x150ab7;return _0x4cc762;},_0x1746d3(_0x371ee4);};return function(_0x20f3e8){const _0xd3ff65=a4_0x7b4b;if(_0x20f3e8&&_0x20f3e8[_0xd3ff65(0x276)])return _0x20f3e8;var _0x22298e={};if(_0x20f3e8!=null){for(var _0xd1888e=_0x1746d3(_0x20f3e8),_0x1db667=0x0;_0x1db667<_0xd1888e[_0xd3ff65(0x252)];_0x1db667++)if(_0xd1888e[_0x1db667]!==_0xd3ff65(0x1ba))__createBinding(_0x22298e,_0x20f3e8,_0xd1888e[_0x1db667]);}return __setModuleDefault(_0x22298e,_0x20f3e8),_0x22298e;};}()),__importDefault=this&&this[a4_0x1787a4(0x1fb)]||function(_0x4872db){return _0x4872db&&_0x4872db['__esModule']?_0x4872db:{'default':_0x4872db};};Object['defineProperty'](exports,a4_0x1787a4(0x276),{'value':!![]});const fs=__importStar(require('fs')),path=__importStar(require(a4_0x1787a4(0x1c1))),rss_parser_1=__importDefault(require('rss-parser')),node_html_parser_1=require(a4_0x1787a4(0x277)),sources_1=require('./sources'),article_extractor_1=require(a4_0x1787a4(0x1fd)),classifier_1=require(a4_0x1787a4(0x1f0)),bucket_manager_1=require(a4_0x1787a4(0x248)),parser=new rss_parser_1[(a4_0x1787a4(0x1ba))](),OUTPUT_DIR=path[a4_0x1787a4(0x259)](__dirname,a4_0x1787a4(0x287));!fs[a4_0x1787a4(0x268)](OUTPUT_DIR)&&fs[a4_0x1787a4(0x22c)](OUTPUT_DIR,{'recursive':!![]});const INDEX_FILE=path[a4_0x1787a4(0x259)](OUTPUT_DIR,a4_0x1787a4(0x1c2)),ERROR_LOG_FILE=path['join'](OUTPUT_DIR,a4_0x1787a4(0x23e)),bannedKeywords=[a4_0x1787a4(0x1c9),'onlyfans',a4_0x1787a4(0x23a),'pornography',a4_0x1787a4(0x25a),a4_0x1787a4(0x202),a4_0x1787a4(0x21b),'gambling','casino',a4_0x1787a4(0x26a),a4_0x1787a4(0x1ff),a4_0x1787a4(0x26b),'Form\x2013G',a4_0x1787a4(0x28e),a4_0x1787a4(0x1d8),'black\x20friday',a4_0x1787a4(0x1eb),'prime\x20day',a4_0x1787a4(0x212),a4_0x1787a4(0x28b),a4_0x1787a4(0x257),a4_0x1787a4(0x1be),'memorial\x20day\x20sale',a4_0x1787a4(0x24a),'holiday\x20sale',a4_0x1787a4(0x1e4),'christmas\x20sale','christmas\x20deals',a4_0x1787a4(0x250),'year\x20end\x20sale',a4_0x1787a4(0x1c4),a4_0x1787a4(0x291),a4_0x1787a4(0x25c),a4_0x1787a4(0x279),a4_0x1787a4(0x1f9),a4_0x1787a4(0x25e),a4_0x1787a4(0x1e6),a4_0x1787a4(0x1d0),a4_0x1787a4(0x1dd),a4_0x1787a4(0x1e3),'hot\x20deals',a4_0x1787a4(0x269),a4_0x1787a4(0x272),a4_0x1787a4(0x292),a4_0x1787a4(0x21d),a4_0x1787a4(0x23c),'coupon\x20code',a4_0x1787a4(0x24d),a4_0x1787a4(0x1cf),'save\x20money',a4_0x1787a4(0x27c),'huge\x20savings',a4_0x1787a4(0x1e0),a4_0x1787a4(0x28f),'best\x20price','price\x20match',a4_0x1787a4(0x20e),a4_0x1787a4(0x1d4),a4_0x1787a4(0x1e1),'affordable\x20pick',a4_0x1787a4(0x1fe),a4_0x1787a4(0x1ec),a4_0x1787a4(0x26e),a4_0x1787a4(0x261),a4_0x1787a4(0x1ea),a4_0x1787a4(0x207),a4_0x1787a4(0x1f6),a4_0x1787a4(0x21c),'buying\x20guide',a4_0x1787a4(0x1f8),a4_0x1787a4(0x200),'gift\x20ideas','buy\x20now','shop\x20now','order\x20now','get\x20it\x20now',a4_0x1787a4(0x1ca),a4_0x1787a4(0x1e7),a4_0x1787a4(0x1bd),a4_0x1787a4(0x208),'fast\x20shipping','in\x20stock',a4_0x1787a4(0x1ef),a4_0x1787a4(0x238),a4_0x1787a4(0x241),a4_0x1787a4(0x205),a4_0x1787a4(0x1cc),'dont\x20miss','last\x20chance',a4_0x1787a4(0x266),a4_0x1787a4(0x282),a4_0x1787a4(0x245),a4_0x1787a4(0x20a),a4_0x1787a4(0x1f1),'we\x20may\x20earn',a4_0x1787a4(0x229)],bannedPatterns=[/\b\d{1,2}%\s*(off|discount|savings?)\b/i,/\bsave\s+\d{1,2}%/i,/\bup\s+to\s+\d{1,2}%\s*off\b/i,/\bsave\s+\$\d+/i,/\$\d+\s*off\b/i,/\bunder\s+\$\d+/i,/\bjust\s+\$\d+/i,/\bonly\s+\$\d+/i,/\bfrom\s+\$\d+/i,/\bstarting\s+at\s+\$\d+/i,/\bwas\s+\$\d+[,\s]+now\s+\$\d+/i,/\bregularly?\s+\$\d+/i,/\bnormally\s+\$\d+/i,/\b\d+\s+best\s+(deals?|products?|items?|gifts?|picks?|things?|ways?)\b/i,/\bbest\s+\d+\b/i,/\b(today|tonight|this\s+week)\s+only\b/i,/\bends?\s+(soon|today|tonight|tomorrow)\b/i,/\b(hours?|days?|minutes?)\s+left\b/i,/\b(limited\s+)?stock\s+(remaining|left|available)\b/i,/\b(grab|snag|score|get)\s+(this|these|the)\s+deal/i,/\bdeal\s+of\s+the\s+(day|week|month|year)\b/i,/\b(massive|huge|incredible|amazing|insane)\s+(deal|discount|savings?|sale)\b/i,/\b(don't|do\s+not)\s+miss\s+(this|these|out)\b/i];function isPromotionalContent(_0x4d3008){const _0x231d2a=a4_0x1787a4,_0x28cfa1=_0x4d3008['toLowerCase']();if(bannedKeywords[_0x231d2a(0x255)](_0x1fe8d0=>_0x28cfa1[_0x231d2a(0x264)](_0x1fe8d0['toLowerCase']())))return!![];if(bannedPatterns[_0x231d2a(0x255)](_0x3425ac=>_0x3425ac[_0x231d2a(0x20f)](_0x4d3008)))return!![];return![];}const bannedThumbnails=[a4_0x1787a4(0x1d9)],phrasesToRemoveFromDescription=[a4_0x1787a4(0x236),a4_0x1787a4(0x253)],descriptionBylinePatterns=[/^By\s+[A-Z][a-z]+\s+[A-Z][a-z]+(\s+and\s+[A-Z][a-z]+\s+[A-Z][a-z]+)?\s+[A-Z]{2,}.*?\(Reuters\)\s*-?\s*/i,/^By\s+[A-Z][a-z]+\s+[A-Z][a-z]+(\s+and\s+[A-Z][a-z]+\s+[A-Z][a-z]+)?\s+[A-Z]{2,}.*?\(AP\)\s*-?\s*/i,/^By\s+[A-Z][a-z]+\s+[A-Z][a-z]+(\s+and\s+[A-Z][a-z]+\s+[A-Z][a-z]+)?\s+[A-Z]{2,}.*?\(AFP\)\s*-?\s*/i,/^By\s+[A-Z][a-z]+\s+[A-Z][a-z]+\s*/i,/^[A-Z]{2,}[A-Z\s,]+\(Reuters\)\s*-?\s*/i,/^[A-Z]{2,}[A-Z\s,]+\(AP\)\s*-?\s*/i,/^[A-Z]{2,}[A-Z\s,]+\(AFP\)\s*-?\s*/i,/^[A-Z]{3,},?\s+(Jan|Feb|Mar|Apr|May|Jun|Jul|Aug|Sep|Oct|Nov|Dec)\s+\d{1,2}\s+\([^)]+\)\s*-?\s*/i,/^(Jan|Feb|Mar|Apr|May|Jun|Jul|Aug|Sep|Oct|Nov|Dec)\s+\d{1,2}\s+\([^)]+\)\s*-?\s*/i];function cleanDescriptionBylines(_0xb3c32c){const _0x4c8652=a4_0x1787a4;if(!_0xb3c32c)return null;let _0x4547eb=_0xb3c32c;for(const _0x319a0b of descriptionBylinePatterns){_0x4547eb=_0x4547eb['replace'](_0x319a0b,'');}return _0x4547eb[_0x4c8652(0x265)]();}function a4_0x7b4b(_0x5cca8f,_0x56c503){const _0x2227ed=a4_0x2227();return a4_0x7b4b=function(_0x7b4ba7,_0x5ec600){_0x7b4ba7=_0x7b4ba7-0x1b8;let _0x160f59=_0x2227ed[_0x7b4ba7];return _0x160f59;},a4_0x7b4b(_0x5cca8f,_0x56c503);}const phrasesToRemoveFromTitle=['Tell\x20HN:',a4_0x1787a4(0x214)],MAX_CONCURRENT_FETCHES=0x5,MAX_ITEMS_PER_SOURCE=0x64;function isRecentItem(_0x5b7cd2){const _0x1af132=a4_0x1787a4;if(!_0x5b7cd2[_0x1af132(0x231)]&&!_0x5b7cd2[_0x1af132(0x215)])return!![];try{const _0x2f89f8=new Date(_0x5b7cd2[_0x1af132(0x231)]||_0x5b7cd2[_0x1af132(0x215)]),_0xfa69c8=new Date(),_0x177a25=new Date(_0xfa69c8[_0x1af132(0x280)](),_0xfa69c8['getMonth'](),_0xfa69c8[_0x1af132(0x1f7)]()),_0x40cfe0=new Date(_0x177a25);return _0x40cfe0[_0x1af132(0x1ee)](_0x40cfe0[_0x1af132(0x1f7)]()-0x1),_0x2f89f8>=_0x40cfe0;}catch{return!![];}}function parseArgs(){const _0x580089=a4_0x1787a4,_0x6457c3=process['argv'][_0x580089(0x247)](0x2);let _0x15ced7=null,_0x45c3c3=null,_0x5113aa=![];for(const _0x4bd571 of _0x6457c3){if(_0x4bd571[_0x580089(0x1df)](_0x580089(0x26c)))_0x15ced7=parseInt(_0x4bd571[_0x580089(0x275)]('=')[0x1],0xa);else{if(_0x4bd571[_0x580089(0x1df)](_0x580089(0x220)))_0x45c3c3=parseInt(_0x4bd571[_0x580089(0x275)]('=')[0x1],0xa);else _0x4bd571==='--test'&&(_0x5113aa=!![]);}}return{'batch':_0x15ced7,'totalBatches':_0x45c3c3,'test':_0x5113aa};}function cleanCdata(_0x38cec3){const _0x22b8f7=a4_0x1787a4;return _0x38cec3[_0x22b8f7(0x1cd)](/<!\[CDATA\[|\]\]>/g,'')[_0x22b8f7(0x265)]();}function stripHtml(_0x2d7e2c){return(0x0,node_html_parser_1['parse'])(_0x2d7e2c)['textContent']||'';}function a4_0x2227(){const _0xf72504=['get','labor\x20day\x20sale','getAttribute','Scrape\x20finished.\x20Added\x20','promo\x20code','qualityScore','391800SeidPs','end\x20of\x20year\x20sale','defineProperty','length','Read\x20more\x20of\x20this\x20story\x20at\x20Slashdot.','\x20posts.','some','thumbnail_url','singles\x20day','push','join','xxx','\x20\x20Skipped\x20duplicate:\x20','doorbuster','init','limited\x20time\x20deal','allSettled','Error\x20fetching\x20source\x20','our\x20picks','substring','call','includes','trim','final\x20hours','...','existsSync','deal\x20of\x20the\x20day','slot\x20machine','Form\x2013F','--batch=','[Filter]\x20Blocked\x20by\x20content\x20check:\x20','top\x20picks','lastIndexOf','toFixed','stringify','deal\x20alert','__importStar','fullText','split','__esModule','node-html-parser','value','door\x20buster','getOwnPropertyNames','content','save\x20big','link','327581pJcewK','catch','getFullYear','__createBinding','affiliate\x20link','https://rss.slashdot.org/Slashdot/slashdot','\x20|\x20Processing\x20sources\x20','max','Fetch\x20failed','../output','map','querySelector','ceil','amazon\x20prime\x20day','readingTime','contentSnippet','Form\x20144','lowest\x20price','\x20new\x20|\x20','flash\x20sale','price\x20drop','keywords','\x20of\x20','Starting\x20Aggregation\x20&\x20Classification...','default','Article\x20URL:','race','checkout','boxing\x20day','text','isArray','path','index.json','âš ï¸\x20RUNNING\x20IN\x20TEST\x20MODE:\x20Limiting\x20to\x201\x20source\x20and\x2010\x20items.','clearance\x20sale','title','log','hnrss.org','12632949IRJjDi','Only\x20Fans','grab\x20it\x20now','text/html,application/xhtml+xml','act\x20fast','replace','s.\x20Classified\x20','voucher\x20code','top\x20deals','readFileSync','news','Feed\x20fetch\x20failed','budget\x20pick','getOwnPropertyDescriptor','toISOString','media:thumbnail','SEC\x20filing','https://s.yimg.com/cv/apiv2/social/images/yahoo_default_logo-1200x1200.png','hasOwnProperty','p\x20a','__setModuleDefault','deals\x20today','utf-8','startsWith','massive\x20discount','budget\x20friendly','Starting\x20job...','daily\x20deals','holiday\x20deals','content:encoded','best\x20deals','add\x20to\x20cart','\x20sources).\x20Skipping.','resolveTopicFromUrl','editors\x20choice','cyber\x20monday','best\x20of\x202025','1450065mHFwEG','setDate','back\x20in\x20stock','./classifier','we\x20earn\x20commission','has','Job\x20Complete\x20in\x20','items','href','we\x20tested','getDate','gift\x20guide','limited\x20time\x20offer','sourcesData','__importDefault','width','./article-extractor','best\x20of\x202024','sports\x20betting','holiday\x20gift','\x20cached\x20|\x20','sex\x20tape','media:content','url','hurry','status','staff\x20picks','free\x20shipping','filter','paid\x20partnership','2189588mBXsQU','Processing\x20source:\x20','headers','unbeatable\x20price','test','meta[name=\x22description\x22]','sort','prime\x20week','now','Show\x20HN:','isoDate','HEAD','enclosure','html','https://www.investing.com/rss/news.rss','writable','nsfw','we\x20reviewed','price\x20cut','message','create','--total-batches=','\x20complete\x20in\x20','description','Error\x20reading\x20daily\x20file,\x20starting\x20fresh.','parseURL','toLowerCase','191030zoJoRx','post-','match','as\x20an\x20amazon\x20associate','parse','â­ï¸\x20Batch\x20','mkdirSync','addPost','name','8vpYISZ','Classifier','pubDate','then','meta[name=\x22twitter:image\x22]','all','from','(Source:\x20Bloomberg)','flush','selling\x20fast','error','porn','writeFileSync','discount\x20code','\x20old\x20(filtered)','error-log.json','3549936ILOaXM','Error\x20reading\x20index\x20file,\x20starting\x20fresh.','selling\x20out','extractArticle','Mozilla/5.0\x20(compatible;\x20NewsBot/1.0)','BucketManager','sponsored\x20post','timeout','slice','./bucket-manager'];a4_0x2227=function(){return _0xf72504;};return a4_0x2227();}function removePhrases(_0x37689a,_0x9a7730){const _0x33f054=a4_0x1787a4;if(!_0x37689a)return null;let _0x322cd0=_0x37689a;for(const _0x1a78e7 of _0x9a7730){_0x322cd0=_0x322cd0['replace'](_0x1a78e7,'')[_0x33f054(0x265)]();}return _0x322cd0;}function truncateDescription(_0x1b1d8b){const _0x33cbd1=a4_0x1787a4;if(!_0x1b1d8b)return null;const _0x539a72=_0x1b1d8b[_0x33cbd1(0x275)](/\n\s*\n/);let _0x542766=_0x539a72[0x0]||'';const _0x25189d=_0x542766[_0x33cbd1(0x228)](/[^.!?]+[.!?]+|[^.!?]+$/g)||[];_0x25189d['length']>0x5?_0x542766=_0x25189d[_0x33cbd1(0x247)](0x0,0x5)[_0x33cbd1(0x259)]('')[_0x33cbd1(0x265)]():_0x542766=_0x25189d[_0x33cbd1(0x259)]('')[_0x33cbd1(0x265)]();if(_0x542766[_0x33cbd1(0x252)]<_0x1b1d8b['length']&&!/[.!?]$/[_0x33cbd1(0x20f)](_0x542766)){const _0x5cc840=_0x542766[_0x33cbd1(0x26f)]('\x20');_0x5cc840>-0x1?_0x542766=_0x542766[_0x33cbd1(0x262)](0x0,_0x5cc840)+_0x33cbd1(0x267):_0x542766=_0x542766+_0x33cbd1(0x267);}return _0x542766[_0x33cbd1(0x252)]>0x0?_0x542766:null;}async function isImageLargeEnough(_0x515dd5){const _0x5ea601=a4_0x1787a4;try{const _0x473003=await fetch(_0x515dd5,{'method':_0x5ea601(0x216),'signal':AbortSignal[_0x5ea601(0x246)](0x7d0)});if(!_0x473003['ok']){if(_0x473003[_0x5ea601(0x206)]===0x194)return![];return!![];}const _0x157b1c=_0x473003[_0x5ea601(0x20d)][_0x5ea601(0x249)]('content-length');if(_0x157b1c){const _0x2d20fe=parseInt(_0x157b1c,0xa);if(_0x2d20fe<0x3a98)return![];}return!![];}catch{return!![];}}async function fetchArticleMetadata(_0x5c4de8){const _0x396b00=a4_0x1787a4;try{const _0x1e5716=await fetch(_0x5c4de8,{'signal':AbortSignal[_0x396b00(0x246)](0x3a98),'headers':{'User-Agent':_0x396b00(0x243),'Accept':_0x396b00(0x1cb)}});if(!_0x1e5716['ok'])throw new Error('HTTP\x20error!\x20status:\x20'+_0x1e5716['status']);const _0x4ef074=await _0x1e5716[_0x396b00(0x1bf)](),_0x932ebc=(0x0,node_html_parser_1[_0x396b00(0x22a)])(_0x4ef074);let _0x3c418e=null;const _0x5cea50=['meta[property=\x22og:description\x22]','meta[name=\x22twitter:description\x22]',_0x396b00(0x210)];for(const _0x13dc85 of _0x5cea50){const _0x5abc8a=_0x932ebc[_0x396b00(0x289)](_0x13dc85);if(_0x5abc8a&&_0x5abc8a['getAttribute'](_0x396b00(0x27b))){_0x3c418e=stripHtml(_0x5abc8a[_0x396b00(0x24b)](_0x396b00(0x27b)))||null,_0x3c418e=removePhrases(_0x3c418e,phrasesToRemoveFromDescription),_0x3c418e=cleanDescriptionBylines(_0x3c418e),_0x3c418e=truncateDescription(_0x3c418e);break;}}let _0x526952=null;const _0x56e288=['meta[property=\x22og:image\x22]',_0x396b00(0x233)];for(const _0x348339 of _0x56e288){const _0x48ea49=_0x932ebc[_0x396b00(0x289)](_0x348339);if(_0x48ea49&&_0x48ea49['getAttribute']('content')){_0x526952=_0x48ea49[_0x396b00(0x24b)](_0x396b00(0x27b));break;}}return{'description':_0x3c418e,'thumbnail_url':_0x526952,'html':_0x4ef074};}catch{return{'description':null,'thumbnail_url':null,'html':null};}}let errorLog=[];function logError(_0x1a4dbd,_0xa43305,_0x555ca6){const _0x196ff1=a4_0x1787a4;errorLog[_0x196ff1(0x258)]({'source':_0x1a4dbd,'url':_0xa43305,'error':_0x555ca6,'timestamp':new Date()[_0x196ff1(0x1d6)]()});}function saveErrorLog(){const _0x36bce0=a4_0x1787a4;if(errorLog[_0x36bce0(0x252)]===0x0)return;let _0x409133=[];if(fs['existsSync'](ERROR_LOG_FILE))try{_0x409133=JSON['parse'](fs[_0x36bce0(0x1d1)](ERROR_LOG_FILE,_0x36bce0(0x1de)));}catch{}const _0x38aabe=[..._0x409133,...errorLog][_0x36bce0(0x247)](-0x64);fs[_0x36bce0(0x23b)](ERROR_LOG_FILE,JSON[_0x36bce0(0x271)](_0x38aabe,null,0x2),_0x36bce0(0x1de));}async function processItem(_0x27425f,_0x47aff6){const _0x17b2ee=a4_0x1787a4;let _0x27fafe=_0x27425f[_0x17b2ee(0x1c5)]?stripHtml(cleanCdata(_0x27425f['title'])):null;_0x27fafe=removePhrases(_0x27fafe,phrasesToRemoveFromTitle);let _0xd91541=_0x27425f[_0x17b2ee(0x27d)],_0x401830=null;if(_0x47aff6[_0x17b2ee(0x204)][_0x17b2ee(0x264)](_0x17b2ee(0x1c7))){if(_0x27425f['content']){const _0x1fc88b=(0x0,node_html_parser_1[_0x17b2ee(0x22a)])(_0x27425f[_0x17b2ee(0x27b)]),_0x1a04d8=_0x1fc88b[_0x17b2ee(0x289)](_0x17b2ee(0x1db));_0x1a04d8&&_0x1a04d8[_0x17b2ee(0x1bf)][_0x17b2ee(0x1df)](_0x17b2ee(0x1bb))&&(_0xd91541=_0x1a04d8[_0x17b2ee(0x24b)](_0x17b2ee(0x1f5)));}_0x401830=null;}else _0x27425f[_0x17b2ee(0x28d)]&&(_0x401830=stripHtml(cleanCdata(_0x27425f[_0x17b2ee(0x28d)]))||null,_0x401830=removePhrases(_0x401830,phrasesToRemoveFromDescription),_0x401830=cleanDescriptionBylines(_0x401830),_0x401830=truncateDescription(_0x401830));!_0x401830&&_0x27425f[_0x17b2ee(0x1e5)]&&(_0x401830=stripHtml(cleanCdata(_0x27425f[_0x17b2ee(0x1e5)]))||null,_0x401830=removePhrases(_0x401830,phrasesToRemoveFromDescription),_0x401830=cleanDescriptionBylines(_0x401830),_0x401830=truncateDescription(_0x401830));_0x47aff6[_0x17b2ee(0x204)]===_0x17b2ee(0x283)&&_0x27425f[_0x17b2ee(0x222)]&&(_0x401830=stripHtml(cleanCdata(_0x27425f[_0x17b2ee(0x222)]))||null,_0x401830=removePhrases(_0x401830,phrasesToRemoveFromDescription),_0x401830=cleanDescriptionBylines(_0x401830),_0x401830=truncateDescription(_0x401830));if(!_0x27fafe||!_0xd91541)return null;const _0x248de3=_0x27fafe+'\x20'+(_0x27425f[_0x17b2ee(0x28d)]?stripHtml(_0x27425f[_0x17b2ee(0x28d)]):'')+'\x20'+(_0x27425f[_0x17b2ee(0x222)]?stripHtml(_0x27425f['description']):'');if(isPromotionalContent(_0x248de3))return null;let _0x4e7d7a=_0x27425f[_0x17b2ee(0x217)]?_0x27425f[_0x17b2ee(0x217)]['url']:null;if(_0x27425f[_0x17b2ee(0x203)]){if(Array[_0x17b2ee(0x1c0)](_0x27425f[_0x17b2ee(0x203)])){const _0x1bdf1c=_0x27425f[_0x17b2ee(0x203)][_0x17b2ee(0x211)]((_0x5d079f,_0xc95217)=>{const _0xb3ab3b=_0x17b2ee,_0x2b56fd=_0x5d079f['$']&&_0x5d079f['$'][_0xb3ab3b(0x1fc)]?parseInt(_0x5d079f['$'][_0xb3ab3b(0x1fc)],0xa):0x0,_0x35de26=_0xc95217['$']&&_0xc95217['$'][_0xb3ab3b(0x1fc)]?parseInt(_0xc95217['$'][_0xb3ab3b(0x1fc)],0xa):0x0;return _0x35de26-_0x2b56fd;}),_0x35eb53=_0x1bdf1c[0x0];if(_0x35eb53){const _0x2afe97=_0x35eb53['$']&&_0x35eb53['$'][_0x17b2ee(0x1fc)]?parseInt(_0x35eb53['$']['width'],0xa):0x0;if(_0x2afe97===0x0||_0x2afe97>=0x12c){if(_0x35eb53['$']&&_0x35eb53['$'][_0x17b2ee(0x204)])_0x4e7d7a=_0x35eb53['$'][_0x17b2ee(0x204)];else{if(_0x35eb53[_0x17b2ee(0x204)])_0x4e7d7a=_0x35eb53['url'];}}}}else{const _0x5ba3bf=_0x27425f[_0x17b2ee(0x203)],_0x3a8e42=_0x5ba3bf['$']&&_0x5ba3bf['$'][_0x17b2ee(0x1fc)]?parseInt(_0x5ba3bf['$']['width'],0xa):_0x5ba3bf[_0x17b2ee(0x1fc)]?parseInt(_0x5ba3bf[_0x17b2ee(0x1fc)],0xa):0x0;if(_0x3a8e42===0x0||_0x3a8e42>=0x12c){if(_0x5ba3bf['$']&&_0x5ba3bf['$'][_0x17b2ee(0x204)])_0x4e7d7a=_0x5ba3bf['$'][_0x17b2ee(0x204)];else{if(_0x5ba3bf[_0x17b2ee(0x204)])_0x4e7d7a=_0x5ba3bf[_0x17b2ee(0x204)];}}}}if(!_0x4e7d7a&&_0x27425f[_0x17b2ee(0x1d7)]){if(_0x27425f['media:thumbnail']['$']&&_0x27425f[_0x17b2ee(0x1d7)]['$'][_0x17b2ee(0x204)])_0x4e7d7a=_0x27425f[_0x17b2ee(0x1d7)]['$'][_0x17b2ee(0x204)];else _0x27425f[_0x17b2ee(0x1d7)][_0x17b2ee(0x204)]&&(_0x4e7d7a=_0x27425f[_0x17b2ee(0x1d7)][_0x17b2ee(0x204)]);}_0x4e7d7a&&bannedThumbnails[_0x17b2ee(0x264)](_0x4e7d7a)&&(_0x4e7d7a=null);let _0x2dd45d=null,_0x3d8ba7={'fullText':null,'readingTime':0x0,'keywords':[],'qualityScore':0x0};const _0x14140d=!_0x401830||!_0x4e7d7a||_0x47aff6[_0x17b2ee(0x204)]['includes'](_0x17b2ee(0x1c7))||_0x47aff6[_0x17b2ee(0x204)]===_0x17b2ee(0x283)||_0x47aff6['url']===_0x17b2ee(0x219);try{const _0x7452b6=await fetchArticleMetadata(_0xd91541);_0x2dd45d=_0x7452b6[_0x17b2ee(0x218)],!_0x401830&&(_0x401830=_0x7452b6[_0x17b2ee(0x222)]),!_0x4e7d7a&&(_0x4e7d7a=_0x7452b6[_0x17b2ee(0x256)]);}catch(_0x19233d){logError(_0x47aff6[_0x17b2ee(0x22e)],_0xd91541,_0x19233d[_0x17b2ee(0x21e)]||_0x17b2ee(0x286));}if(_0x2dd45d){_0x3d8ba7=(0x0,article_extractor_1[_0x17b2ee(0x242)])(_0x2dd45d,_0xd91541);if(_0x3d8ba7['fullText']&&isPromotionalContent(_0x3d8ba7[_0x17b2ee(0x274)]))return console[_0x17b2ee(0x1c6)](_0x17b2ee(0x26d)+_0x27fafe),null;}_0x4e7d7a&&bannedThumbnails['includes'](_0x4e7d7a)&&(_0x4e7d7a=null);if(_0x4e7d7a){const _0x98b89a=await isImageLargeEnough(_0x4e7d7a);!_0x98b89a&&(_0x4e7d7a=null);}if(!_0x4e7d7a)return null;const _0x21f123=_0x27fafe[_0x17b2ee(0x225)]()['replace'](/[^a-z0-9\s]/g,'')[_0x17b2ee(0x265)]()[_0x17b2ee(0x1cd)](/\s+/g,'-');let _0x2a8666=_0x21f123[_0x17b2ee(0x262)](0x0,0x78);if(_0x21f123['length']>0x78){const _0x5a249b=_0x2a8666[_0x17b2ee(0x26f)]('-');_0x5a249b>0x0&&(_0x2a8666=_0x2a8666[_0x17b2ee(0x262)](0x0,_0x5a249b));}_0x2a8666=_0x2a8666[_0x17b2ee(0x1cd)](/-+$/,'');!_0x2a8666&&(_0x2a8666=_0x17b2ee(0x227)+Date['now']());const _0x51c357=(0x0,sources_1[_0x17b2ee(0x1e9)])(_0xd91541,_0x47aff6[_0x17b2ee(0x22e)],_0x47aff6['topic']||_0x17b2ee(0x1d2));return{'slug':_0x2a8666,'title':_0x27fafe,'description':_0x401830,'fullText':_0x3d8ba7['fullText'],'readingTime':_0x3d8ba7[_0x17b2ee(0x28c)],'keywords':_0x3d8ba7[_0x17b2ee(0x293)],'qualityScore':_0x3d8ba7[_0x17b2ee(0x24e)],'link':_0xd91541,'thumbnail_url':_0x4e7d7a,'created_at':new Date()[_0x17b2ee(0x1d6)](),'topic':_0x51c357};}async function processInParallel(_0x23ecdc,_0x3823f6,_0x55cd0c){const _0x5ebc61=a4_0x1787a4,_0xf41d24=[],_0x2e7bbd=[];for(const _0x350840 of _0x23ecdc){const _0x5c238e=_0x3823f6(_0x350840)[_0x5ebc61(0x232)](_0x29d311=>{_0xf41d24['push'](_0x29d311);})[_0x5ebc61(0x27f)](()=>{const _0x59e71c=_0x5ebc61;_0xf41d24[_0x59e71c(0x258)](null);});_0x2e7bbd[_0x5ebc61(0x258)](_0x5c238e);if(_0x2e7bbd[_0x5ebc61(0x252)]>=_0x55cd0c){await Promise[_0x5ebc61(0x1bc)](_0x2e7bbd);const _0x109dbd=_0x2e7bbd[_0x5ebc61(0x209)](_0x5e21ea=>{const _0x4b70d4=_0x5ebc61;let _0x1dc0fe=![];return _0x5e21ea[_0x4b70d4(0x232)](()=>{_0x1dc0fe=!![];})[_0x4b70d4(0x27f)](()=>{_0x1dc0fe=!![];}),!_0x1dc0fe;});_0x2e7bbd[_0x5ebc61(0x252)]=0x0,_0x2e7bbd[_0x5ebc61(0x258)](..._0x109dbd);}}return await Promise[_0x5ebc61(0x234)](_0x2e7bbd),_0xf41d24;}async function processBatch(_0x4ebb99,_0x1b2308,_0x56ff5a=MAX_CONCURRENT_FETCHES){const _0x3b3b33=a4_0x1787a4,_0x36df00=[];for(let _0x15b314=0x0;_0x15b314<_0x4ebb99[_0x3b3b33(0x252)];_0x15b314+=_0x56ff5a){const _0x25cbe3=_0x4ebb99[_0x3b3b33(0x247)](_0x15b314,_0x15b314+_0x56ff5a),_0x1aecd9=await Promise[_0x3b3b33(0x25f)](_0x25cbe3[_0x3b3b33(0x288)](_0x2c147f=>_0x1b2308(_0x2c147f)));for(const _0x1df73b of _0x1aecd9){_0x1df73b[_0x3b3b33(0x206)]==='fulfilled'?_0x36df00[_0x3b3b33(0x258)](_0x1df73b[_0x3b3b33(0x278)]):_0x36df00['push'](null);}}return _0x36df00;}async function run(){const _0x906608=a4_0x1787a4,{batch:_0x5c7f2c,totalBatches:_0x52d72b,test:_0x2675cb}=parseArgs();console[_0x906608(0x1c6)](_0x906608(0x1e2));_0x5c7f2c!==null&&_0x52d72b!==null&&console[_0x906608(0x1c6)]('Running\x20batch\x20'+(_0x5c7f2c+0x1)+_0x906608(0x1b8)+_0x52d72b);const _0x527da3=Date[_0x906608(0x213)](),_0x2c395c=new Date()['toISOString']()['split']('T')[0x0],_0x55bf6d=path[_0x906608(0x259)](OUTPUT_DIR,_0x2c395c+'.json');let _0x23a72b=[];if(fs[_0x906608(0x268)](INDEX_FILE))try{_0x23a72b=JSON[_0x906608(0x22a)](fs[_0x906608(0x1d1)](INDEX_FILE,_0x906608(0x1de)));}catch{console[_0x906608(0x239)](_0x906608(0x240));}const _0x3828dd=new Set(_0x23a72b),_0x1a1893=new Set();let _0x2e3fd2=[];if(fs[_0x906608(0x268)](_0x55bf6d))try{_0x2e3fd2=JSON['parse'](fs[_0x906608(0x1d1)](_0x55bf6d,'utf-8'));for(const _0x4948d5 of _0x2e3fd2){_0x4948d5[_0x906608(0x274)]&&_0x1a1893['add'](_0x4948d5[_0x906608(0x274)]['substring'](0x0,0x64));}}catch{console['error'](_0x906608(0x223));}let _0x17d5a8=[...sources_1[_0x906608(0x1fa)]],_0x5e78f6=null;if(_0x2675cb)console['log'](_0x906608(0x1c3)),_0x17d5a8=sources_1[_0x906608(0x1fa)][_0x906608(0x247)](0x0,0x1),_0x5e78f6=0xa;else{if(_0x5c7f2c!==null&&_0x52d72b!==null){const _0x48bce3=0x5,_0x182c2e=Math['min'](_0x52d72b,Math[_0x906608(0x285)](0x1,Math['ceil'](sources_1[_0x906608(0x1fa)][_0x906608(0x252)]/_0x48bce3)));if(_0x5c7f2c>=_0x182c2e){console[_0x906608(0x1c6)](_0x906608(0x22b)+(_0x5c7f2c+0x1)+'\x20not\x20needed\x20(only\x20'+_0x182c2e+'\x20batches\x20required\x20for\x20'+sources_1['sourcesData'][_0x906608(0x252)]+_0x906608(0x1e8));return;}const _0x1d3b3c=Math[_0x906608(0x28a)](sources_1['sourcesData'][_0x906608(0x252)]/_0x182c2e),_0x779e2e=_0x5c7f2c*_0x1d3b3c,_0x439567=Math['min'](_0x779e2e+_0x1d3b3c,sources_1[_0x906608(0x1fa)][_0x906608(0x252)]);_0x17d5a8=sources_1[_0x906608(0x1fa)][_0x906608(0x247)](_0x779e2e,_0x439567),console[_0x906608(0x1c6)]('ðŸ”„\x20Batch\x20'+(_0x5c7f2c+0x1)+'/'+_0x182c2e+_0x906608(0x284)+(_0x779e2e+0x1)+'-'+_0x439567+_0x906608(0x1b8)+sources_1[_0x906608(0x1fa)][_0x906608(0x252)]);}}let _0x411420=0x0;for(const _0x801ee1 of _0x17d5a8){console[_0x906608(0x1c6)](_0x906608(0x20c)+_0x801ee1[_0x906608(0x22e)]);try{const _0x37ba7c=await parser[_0x906608(0x224)](_0x801ee1[_0x906608(0x204)]),_0x6a170b=_0x5e78f6||MAX_ITEMS_PER_SOURCE,_0x3d60de=_0x37ba7c[_0x906608(0x1f4)][_0x906608(0x209)](isRecentItem)[_0x906608(0x247)](0x0,_0x6a170b),_0x4e513a=_0x37ba7c[_0x906608(0x1f4)]['length']-_0x3d60de[_0x906608(0x252)]-(_0x37ba7c[_0x906608(0x1f4)]['length']>_0x6a170b?_0x37ba7c['items'][_0x906608(0x252)]-_0x6a170b:0x0),_0x38603b=_0x3d60de[_0x906608(0x209)](_0x35d3c0=>{const _0x33fd98=_0x906608,_0x3dc3ff=_0x35d3c0[_0x33fd98(0x27d)];return _0x3dc3ff&&!_0x3828dd[_0x33fd98(0x1f2)](_0x3dc3ff);}),_0xf2d63a=_0x3d60de['length']-_0x38603b['length'];console[_0x906608(0x1c6)]('\x20\x20'+_0x38603b[_0x906608(0x252)]+_0x906608(0x290)+_0xf2d63a+_0x906608(0x201)+_0x4e513a+_0x906608(0x23d));const _0x3555ef=await processBatch(_0x38603b,_0xc5327b=>processItem(_0xc5327b,_0x801ee1),MAX_CONCURRENT_FETCHES);for(const _0x5861e6 of _0x3555ef){if(_0x5861e6&&_0x5861e6[_0x906608(0x27d)]){if(_0x5861e6['fullText']){const _0xbd3755=_0x5861e6['fullText'][_0x906608(0x262)](0x0,0x64);if(_0x1a1893['has'](_0xbd3755)){console[_0x906608(0x1c6)](_0x906608(0x25b)+_0x5861e6[_0x906608(0x1c5)][_0x906608(0x262)](0x0,0x28)+_0x906608(0x267));continue;}_0x1a1893['add'](_0xbd3755);}_0x2e3fd2['push'](_0x5861e6),_0x3828dd['add'](_0x5861e6[_0x906608(0x27d)]),_0x411420++;}}}catch(_0x1adb14){console[_0x906608(0x239)](_0x906608(0x260)+_0x801ee1[_0x906608(0x22e)]+':',_0x1adb14['message']),logError(_0x801ee1[_0x906608(0x22e)],_0x801ee1[_0x906608(0x204)],_0x1adb14[_0x906608(0x21e)]||_0x906608(0x1d3));}}fs['writeFileSync'](_0x55bf6d,JSON['stringify'](_0x2e3fd2,null,0x2),_0x906608(0x1de)),fs['writeFileSync'](INDEX_FILE,JSON['stringify'](Array[_0x906608(0x235)](_0x3828dd),null,0x2),_0x906608(0x1de)),saveErrorLog(),console[_0x906608(0x1c6)](_0x906608(0x24c)+_0x411420+'\x20items.');if(_0x5c7f2c===null){console[_0x906608(0x1c6)](_0x906608(0x1b9));const _0x3fa438=new classifier_1[(_0x906608(0x230))](),_0x2e9e0d=new bucket_manager_1[(_0x906608(0x244))](OUTPUT_DIR);await _0x2e9e0d[_0x906608(0x25d)]();let _0x2c2a04=0x0;for(const _0x3713d7 of _0x2e3fd2){const _0x53d486=_0x3fa438['classify'](_0x3713d7[_0x906608(0x1c5)],_0x3713d7[_0x906608(0x222)]);if(_0x53d486['length']>0x0){for(const _0x517c98 of _0x53d486){_0x2e9e0d[_0x906608(0x22d)](_0x3713d7,_0x517c98);}_0x2c2a04++;}}await _0x2e9e0d[_0x906608(0x237)]();const _0x3072bf=Date['now']();console[_0x906608(0x1c6)](_0x906608(0x1f3)+((_0x3072bf-_0x527da3)/0x3e8)[_0x906608(0x270)](0x2)+_0x906608(0x1ce)+_0x2c2a04+_0x906608(0x254));}else{const _0x35f134=Date[_0x906608(0x213)]();console[_0x906608(0x1c6)]('Batch\x20'+_0x5c7f2c+_0x906608(0x221)+((_0x35f134-_0x527da3)/0x3e8)[_0x906608(0x270)](0x2)+'s.\x20Classification\x20will\x20run\x20in\x20merge\x20step.');}}run()[a4_0x1787a4(0x27f)](console[a4_0x1787a4(0x239)]);
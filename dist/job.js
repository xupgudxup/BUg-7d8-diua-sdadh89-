'use strict';const a5_0x55fb13=a5_0x5d76;(function(_0x342b96,_0x3035d5){const _0x148333=a5_0x5d76,_0x3d14ca=_0x342b96();while(!![]){try{const _0x32d51c=-parseInt(_0x148333(0x10f))/0x1+-parseInt(_0x148333(0xcc))/0x2+parseInt(_0x148333(0x11b))/0x3*(-parseInt(_0x148333(0x135))/0x4)+parseInt(_0x148333(0x11e))/0x5+-parseInt(_0x148333(0x180))/0x6+parseInt(_0x148333(0x110))/0x7+parseInt(_0x148333(0xc4))/0x8*(parseInt(_0x148333(0x183))/0x9);if(_0x32d51c===_0x3035d5)break;else _0x3d14ca['push'](_0x3d14ca['shift']());}catch(_0x390eda){_0x3d14ca['push'](_0x3d14ca['shift']());}}}(a5_0x4568,0x805bf));var __createBinding=this&&this['__createBinding']||(Object[a5_0x55fb13(0x170)]?function(_0x27f49e,_0x45092c,_0x33af3a,_0x4e75f1){const _0x5d2af4=a5_0x55fb13;if(_0x4e75f1===undefined)_0x4e75f1=_0x33af3a;var _0x40c9b3=Object['getOwnPropertyDescriptor'](_0x45092c,_0x33af3a);(!_0x40c9b3||(_0x5d2af4(0x163)in _0x40c9b3?!_0x45092c['__esModule']:_0x40c9b3[_0x5d2af4(0xbe)]||_0x40c9b3[_0x5d2af4(0x18d)]))&&(_0x40c9b3={'enumerable':!![],'get':function(){return _0x45092c[_0x33af3a];}}),Object[_0x5d2af4(0x109)](_0x27f49e,_0x4e75f1,_0x40c9b3);}:function(_0x3824e9,_0x5365a7,_0xbe3ca,_0x4c5362){if(_0x4c5362===undefined)_0x4c5362=_0xbe3ca;_0x3824e9[_0x4c5362]=_0x5365a7[_0xbe3ca];}),__setModuleDefault=this&&this[a5_0x55fb13(0x127)]||(Object[a5_0x55fb13(0x170)]?function(_0x571a96,_0x32b0b5){const _0x2cdefd=a5_0x55fb13;Object['defineProperty'](_0x571a96,_0x2cdefd(0x182),{'enumerable':!![],'value':_0x32b0b5});}:function(_0x32e268,_0x2b8c44){_0x32e268['default']=_0x2b8c44;}),__importStar=this&&this[a5_0x55fb13(0xc7)]||(function(){var _0xeb5a8f=function(_0x4a2ab8){const _0x406acb=a5_0x5d76;return _0xeb5a8f=Object[_0x406acb(0xe4)]||function(_0x19e995){const _0x8ff9f1=_0x406acb;var _0x47228b=[];for(var _0x2cd119 in _0x19e995)if(Object[_0x8ff9f1(0x149)]['hasOwnProperty'][_0x8ff9f1(0x161)](_0x19e995,_0x2cd119))_0x47228b[_0x47228b[_0x8ff9f1(0x13b)]]=_0x2cd119;return _0x47228b;},_0xeb5a8f(_0x4a2ab8);};return function(_0x97d496){const _0x760725=a5_0x5d76;if(_0x97d496&&_0x97d496[_0x760725(0xfd)])return _0x97d496;var _0x4fe38a={};if(_0x97d496!=null){for(var _0x34aefc=_0xeb5a8f(_0x97d496),_0x1ecbcc=0x0;_0x1ecbcc<_0x34aefc['length'];_0x1ecbcc++)if(_0x34aefc[_0x1ecbcc]!==_0x760725(0x182))__createBinding(_0x4fe38a,_0x97d496,_0x34aefc[_0x1ecbcc]);}return __setModuleDefault(_0x4fe38a,_0x97d496),_0x4fe38a;};}()),__importDefault=this&&this['__importDefault']||function(_0x35093d){const _0x32fcf1=a5_0x55fb13;return _0x35093d&&_0x35093d[_0x32fcf1(0xfd)]?_0x35093d:{'default':_0x35093d};};Object[a5_0x55fb13(0x109)](exports,'__esModule',{'value':!![]});const fs=__importStar(require('fs')),path=__importStar(require(a5_0x55fb13(0x10a))),rss_parser_1=__importDefault(require(a5_0x55fb13(0xb1))),node_html_parser_1=require(a5_0x55fb13(0x13a)),sources_1=require(a5_0x55fb13(0x124)),article_extractor_1=require('./article-extractor'),classifier_1=require(a5_0x55fb13(0x105)),bucket_manager_1=require(a5_0x55fb13(0x134)),parser=new rss_parser_1[(a5_0x55fb13(0x182))](),OUTPUT_DIR=path[a5_0x55fb13(0x153)](__dirname,'../output');!fs[a5_0x55fb13(0x104)](OUTPUT_DIR)&&fs['mkdirSync'](OUTPUT_DIR,{'recursive':!![]});function a5_0x5d76(_0x1d8bb5,_0x2f8923){const _0x4568c3=a5_0x4568();return a5_0x5d76=function(_0x5d7609,_0x367052){_0x5d7609=_0x5d7609-0xaf;let _0x5a5a2b=_0x4568c3[_0x5d7609];return _0x5a5a2b;},a5_0x5d76(_0x1d8bb5,_0x2f8923);}const INDEX_FILE=path[a5_0x55fb13(0x153)](OUTPUT_DIR,a5_0x55fb13(0xe0)),ERROR_LOG_FILE=path[a5_0x55fb13(0x153)](OUTPUT_DIR,a5_0x55fb13(0x154)),bannedKeywords=[a5_0x55fb13(0x159),'onlyfans',a5_0x55fb13(0x165),a5_0x55fb13(0x16a),'xxx','sex\x20tape',a5_0x55fb13(0x117),'gambling',a5_0x55fb13(0xe3),'slot\x20machine',a5_0x55fb13(0x111),a5_0x55fb13(0x130),'Form\x2013G',a5_0x55fb13(0xbd),a5_0x55fb13(0x100),a5_0x55fb13(0x150),a5_0x55fb13(0x164),a5_0x55fb13(0x132),'prime\x20week',a5_0x55fb13(0x171),a5_0x55fb13(0x13c),a5_0x55fb13(0x126),a5_0x55fb13(0x136),'labor\x20day\x20sale',a5_0x55fb13(0x119),a5_0x55fb13(0x172),'christmas\x20sale',a5_0x55fb13(0xbb),'end\x20of\x20year\x20sale',a5_0x55fb13(0xb8),a5_0x55fb13(0xdd),a5_0x55fb13(0x167),a5_0x55fb13(0x14a),a5_0x55fb13(0x12d),a5_0x55fb13(0x14f),a5_0x55fb13(0xfc),a5_0x55fb13(0x16f),a5_0x55fb13(0x17e),a5_0x55fb13(0xdb),a5_0x55fb13(0x10b),a5_0x55fb13(0x15d),a5_0x55fb13(0x15b),'deal\x20alert',a5_0x55fb13(0xec),a5_0x55fb13(0xbc),a5_0x55fb13(0x169),a5_0x55fb13(0xfe),a5_0x55fb13(0xed),'voucher\x20code',a5_0x55fb13(0xc0),a5_0x55fb13(0xc9),a5_0x55fb13(0xc3),a5_0x55fb13(0x12e),a5_0x55fb13(0x17d),a5_0x55fb13(0x133),a5_0x55fb13(0x11f),a5_0x55fb13(0x14e),a5_0x55fb13(0x16c),a5_0x55fb13(0x18e),a5_0x55fb13(0x17b),a5_0x55fb13(0x152),a5_0x55fb13(0x139),a5_0x55fb13(0x120),a5_0x55fb13(0xb2),a5_0x55fb13(0xf6),a5_0x55fb13(0xfb),a5_0x55fb13(0x16e),'we\x20reviewed',a5_0x55fb13(0xfa),a5_0x55fb13(0x189),a5_0x55fb13(0xea),'gift\x20ideas','buy\x20now',a5_0x55fb13(0x145),a5_0x55fb13(0xdc),a5_0x55fb13(0x113),a5_0x55fb13(0xe5),'add\x20to\x20cart',a5_0x55fb13(0xe6),'free\x20shipping',a5_0x55fb13(0x144),a5_0x55fb13(0x12a),a5_0x55fb13(0x146),'selling\x20fast','selling\x20out','hurry',a5_0x55fb13(0xcb),'dont\x20miss',a5_0x55fb13(0xb9),'final\x20hours',a5_0x55fb13(0x112),a5_0x55fb13(0x18f),a5_0x55fb13(0x16d),a5_0x55fb13(0x11a),a5_0x55fb13(0x156),a5_0x55fb13(0x18c)],bannedPatterns=[/\b\d{1,2}%\s*(off|discount|savings?)\b/i,/\bsave\s+\d{1,2}%/i,/\bup\s+to\s+\d{1,2}%\s*off\b/i,/\bsave\s+\$\d+/i,/\$\d+\s*off\b/i,/\bunder\s+\$\d+/i,/\bjust\s+\$\d+/i,/\bonly\s+\$\d+/i,/\bfrom\s+\$\d+/i,/\bstarting\s+at\s+\$\d+/i,/\bwas\s+\$\d+[,\s]+now\s+\$\d+/i,/\bregularly?\s+\$\d+/i,/\bnormally\s+\$\d+/i,/\b\d+\s+best\s+(deals?|products?|items?|gifts?|picks?|things?|ways?)\b/i,/\bbest\s+\d+\b/i,/\b(today|tonight|this\s+week)\s+only\b/i,/\bends?\s+(soon|today|tonight|tomorrow)\b/i,/\b(hours?|days?|minutes?)\s+left\b/i,/\b(limited\s+)?stock\s+(remaining|left|available)\b/i,/\b(grab|snag|score|get)\s+(this|these|the)\s+deal/i,/\bdeal\s+of\s+the\s+(day|week|month|year)\b/i,/\b(massive|huge|incredible|amazing|insane)\s+(deal|discount|savings?|sale)\b/i,/\b(don't|do\s+not)\s+miss\s+(this|these|out)\b/i];function isPromotionalContent(_0x29f0a7){const _0x2f4777=a5_0x55fb13,_0x53dcd1=_0x29f0a7[_0x2f4777(0x106)]();if(bannedKeywords[_0x2f4777(0xd6)](_0x2695df=>_0x53dcd1[_0x2f4777(0xb0)](_0x2695df['toLowerCase']())))return!![];if(bannedPatterns[_0x2f4777(0xd6)](_0x4c6f69=>_0x4c6f69[_0x2f4777(0x125)](_0x29f0a7)))return!![];return![];}const bannedThumbnails=[a5_0x55fb13(0x17f)],phrasesToRemoveFromDescription=[a5_0x55fb13(0xce),a5_0x55fb13(0x185)],descriptionBylinePatterns=[/^By\s+[A-Z][a-z]+\s+[A-Z][a-z]+(\s+and\s+[A-Z][a-z]+\s+[A-Z][a-z]+)?\s+[A-Z]{2,}.*?\(Reuters\)\s*-?\s*/i,/^By\s+[A-Z][a-z]+\s+[A-Z][a-z]+(\s+and\s+[A-Z][a-z]+\s+[A-Z][a-z]+)?\s+[A-Z]{2,}.*?\(AP\)\s*-?\s*/i,/^By\s+[A-Z][a-z]+\s+[A-Z][a-z]+(\s+and\s+[A-Z][a-z]+\s+[A-Z][a-z]+)?\s+[A-Z]{2,}.*?\(AFP\)\s*-?\s*/i,/^By\s+[A-Z][a-z]+\s+[A-Z][a-z]+\s*/i,/^[A-Z]{2,}[A-Z\s,]+\(Reuters\)\s*-?\s*/i,/^[A-Z]{2,}[A-Z\s,]+\(AP\)\s*-?\s*/i,/^[A-Z]{2,}[A-Z\s,]+\(AFP\)\s*-?\s*/i,/^[A-Z]{3,},?\s+(Jan|Feb|Mar|Apr|May|Jun|Jul|Aug|Sep|Oct|Nov|Dec)\s+\d{1,2}\s+\([^)]+\)\s*-?\s*/i,/^(Jan|Feb|Mar|Apr|May|Jun|Jul|Aug|Sep|Oct|Nov|Dec)\s+\d{1,2}\s+\([^)]+\)\s*-?\s*/i];function cleanDescriptionBylines(_0x1d3a9e){const _0x238728=a5_0x55fb13;if(!_0x1d3a9e)return null;let _0x4322fd=_0x1d3a9e;for(const _0x5e12a4 of descriptionBylinePatterns){_0x4322fd=_0x4322fd[_0x238728(0x16b)](_0x5e12a4,'');}return _0x4322fd[_0x238728(0xe7)]();}const phrasesToRemoveFromTitle=[a5_0x55fb13(0x142),a5_0x55fb13(0xd9)],MAX_CONCURRENT_FETCHES=0x5,MAX_ITEMS_PER_SOURCE=0x64;function isRecentItem(_0x2c0793){const _0x1c8bb6=a5_0x55fb13;if(!_0x2c0793[_0x1c8bb6(0x114)]&&!_0x2c0793['isoDate'])return!![];try{const _0x3d0499=new Date(_0x2c0793[_0x1c8bb6(0x114)]||_0x2c0793[_0x1c8bb6(0x122)]),_0x43f7c1=new Date(),_0x2a5619=new Date(_0x43f7c1[_0x1c8bb6(0x12b)](),_0x43f7c1[_0x1c8bb6(0xcd)](),_0x43f7c1['getDate']()),_0x4a6055=new Date(_0x2a5619);return _0x4a6055[_0x1c8bb6(0x102)](_0x4a6055['getDate']()-0x1),_0x3d0499>=_0x4a6055;}catch{return!![];}}function parseArgs(){const _0x28d0f8=a5_0x55fb13,_0x4e75ab=process['argv']['slice'](0x2);let _0x33478a=null,_0x215ed0=null,_0x54add6=![];for(const _0x2a72f0 of _0x4e75ab){if(_0x2a72f0['startsWith'](_0x28d0f8(0x121)))_0x33478a=parseInt(_0x2a72f0[_0x28d0f8(0x160)]('=')[0x1],0xa);else{if(_0x2a72f0[_0x28d0f8(0x168)]('--total-batches='))_0x215ed0=parseInt(_0x2a72f0[_0x28d0f8(0x160)]('=')[0x1],0xa);else _0x2a72f0===_0x28d0f8(0x158)&&(_0x54add6=!![]);}}return{'batch':_0x33478a,'totalBatches':_0x215ed0,'test':_0x54add6};}function cleanCdata(_0x130c22){const _0x5820ef=a5_0x55fb13;return _0x130c22[_0x5820ef(0x16b)](/<!\[CDATA\[|\]\]>/g,'')[_0x5820ef(0xe7)]();}function stripHtml(_0x7305da){const _0x2790c7=a5_0x55fb13;return(0x0,node_html_parser_1[_0x2790c7(0x148)])(_0x7305da)[_0x2790c7(0xe1)]||'';}function removePhrases(_0x432a85,_0x1ad1b6){const _0x398086=a5_0x55fb13;if(!_0x432a85)return null;let _0x33ac86=_0x432a85;for(const _0x24f738 of _0x1ad1b6){_0x33ac86=_0x33ac86[_0x398086(0x16b)](_0x24f738,'')['trim']();}return _0x33ac86;}function truncateDescription(_0x1f1240){const _0x76236a=a5_0x55fb13;if(!_0x1f1240)return null;const _0x1353f9=_0x1f1240[_0x76236a(0x160)](/\n\s*\n/);let _0x5ad588=_0x1353f9[0x0]||'';const _0x297411=_0x5ad588['match'](/[^.!?]+[.!?]+|[^.!?]+$/g)||[];_0x297411['length']>0x5?_0x5ad588=_0x297411[_0x76236a(0x140)](0x0,0x5)[_0x76236a(0x153)]('')[_0x76236a(0xe7)]():_0x5ad588=_0x297411[_0x76236a(0x153)]('')[_0x76236a(0xe7)]();if(_0x5ad588[_0x76236a(0x13b)]<_0x1f1240['length']&&!/[.!?]$/[_0x76236a(0x125)](_0x5ad588)){const _0x4d0dd2=_0x5ad588[_0x76236a(0xda)]('\x20');_0x4d0dd2>-0x1?_0x5ad588=_0x5ad588[_0x76236a(0xd5)](0x0,_0x4d0dd2)+'...':_0x5ad588=_0x5ad588+_0x76236a(0xcf);}return _0x5ad588['length']>0x0?_0x5ad588:null;}async function isImageLargeEnough(_0x109839){const _0x336558=a5_0x55fb13;try{const _0x45cbc6=await fetch(_0x109839,{'method':'HEAD','signal':AbortSignal['timeout'](0x7d0)});if(!_0x45cbc6['ok']){if(_0x45cbc6[_0x336558(0x157)]===0x194)return![];return!![];}const _0xd30a7e=_0x45cbc6[_0x336558(0x10e)]['get'](_0x336558(0x18a));if(_0xd30a7e){const _0x52c65f=parseInt(_0xd30a7e,0xa);if(_0x52c65f<0x3a98)return![];}return!![];}catch{return!![];}}async function fetchArticleMetadata(_0x51bdad){const _0x3840e0=a5_0x55fb13;try{const _0x53631d=await fetch(_0x51bdad,{'signal':AbortSignal[_0x3840e0(0xf8)](0x3a98),'headers':{'User-Agent':_0x3840e0(0xbf),'Accept':_0x3840e0(0x187)}});if(!_0x53631d['ok'])throw new Error(_0x3840e0(0x101)+_0x53631d[_0x3840e0(0x157)]);const _0x35943a=await _0x53631d[_0x3840e0(0xf7)](),_0x332348=(0x0,node_html_parser_1[_0x3840e0(0x148)])(_0x35943a);let _0x45b6c8=null;const _0x7135fa=[_0x3840e0(0x141),_0x3840e0(0xba),_0x3840e0(0xf9)];for(const _0x46b2ea of _0x7135fa){const _0x2ecbe2=_0x332348['querySelector'](_0x46b2ea);if(_0x2ecbe2&&_0x2ecbe2[_0x3840e0(0xf1)](_0x3840e0(0xe9))){_0x45b6c8=stripHtml(_0x2ecbe2[_0x3840e0(0xf1)](_0x3840e0(0xe9)))||null,_0x45b6c8=removePhrases(_0x45b6c8,phrasesToRemoveFromDescription),_0x45b6c8=cleanDescriptionBylines(_0x45b6c8),_0x45b6c8=truncateDescription(_0x45b6c8);break;}}let _0x2ba126=null;const _0x33d50a=['meta[property=\x22og:image\x22]',_0x3840e0(0xb4)];for(const _0x6059d7 of _0x33d50a){const _0x51e75a=_0x332348[_0x3840e0(0xf2)](_0x6059d7);if(_0x51e75a&&_0x51e75a['getAttribute'](_0x3840e0(0xe9))){_0x2ba126=_0x51e75a['getAttribute'](_0x3840e0(0xe9));break;}}return{'description':_0x45b6c8,'thumbnail_url':_0x2ba126,'html':_0x35943a};}catch{return{'description':null,'thumbnail_url':null,'html':null};}}let errorLog=[];function logError(_0xb897f4,_0x212dfd,_0x37f656){errorLog['push']({'source':_0xb897f4,'url':_0x212dfd,'error':_0x37f656,'timestamp':new Date()['toISOString']()});}function a5_0x4568(){const _0x5497c4=['sports\x20betting','affiliate\x20link','get\x20it\x20now','pubDate','min','init','nsfw','readingTime','holiday\x20sale','we\x20earn\x20commission','3149733xUlIZg','Running\x20batch\x20','description','5255655UXHjlw','price\x20match','top\x20picks','--batch=','isoDate','Starting\x20job...','./sources','test','boxing\x20day','__setModuleDefault','Error\x20fetching\x20source\x20','add','in\x20stock','getFullYear','writeFileSync','door\x20buster','massive\x20discount','content:encoded','Form\x2013F','now','prime\x20day','best\x20price','./bucket-manager','4Aahrla','memorial\x20day\x20sale','s.\x20Classified\x20','media:content','best\x20of\x202025','node-html-parser','length','singles\x20day','error','\x20|\x20Processing\x20sources\x20','value','slice','meta[property=\x22og:description\x22]','Tell\x20HN:','\x20cached\x20|\x20','fast\x20shipping','shop\x20now','back\x20in\x20stock','\x20batches\x20required\x20for\x20','parse','prototype','doorbuster','sourcesData','allSettled','title','unbeatable\x20price','limited\x20time\x20offer','black\x20friday','catch','best\x20of\x202024','join','error-log.json','map','we\x20may\x20earn','status','--test','Only\x20Fans','resolveTopicFromUrl','deal\x20of\x20the\x20day','link','hot\x20deals','\x20of\x20','utf-8','split','call','keywords','get','cyber\x20monday','porn','fullText','flash\x20sale','startsWith','discount\x20code','pornography','replace','budget\x20pick','paid\x20partnership','we\x20tested','best\x20deals','create','amazon\x20prime\x20day','holiday\x20deals','parseURL','readFileSync','from','contentSnippet','push','name','âš ï¸\x20RUNNING\x20IN\x20TEST\x20MODE:\x20Limiting\x20to\x201\x20source\x20and\x2010\x20items.','Error\x20reading\x20daily\x20file,\x20starting\x20fresh.','affordable\x20pick','toFixed','lowest\x20price','top\x20deals','https://s.yimg.com/cv/apiv2/social/images/yahoo_default_logo-1200x1200.png','529662zzdjHw','â­ï¸\x20Batch\x20','default','3747663LllTUc','max','Read\x20more\x20of\x20this\x20story\x20at\x20Slashdot.','race','text/html,application/xhtml+xml','[Filter]\x20Blocked\x20by\x20content\x20check:\x20','gift\x20guide','content-length','BucketManager','as\x20an\x20amazon\x20associate','configurable','budget\x20friendly','sponsored\x20post','extractArticle','includes','rss-parser','our\x20picks','width','meta[name=\x22twitter:image\x22]','\x20posts.','log','sort','year\x20end\x20sale','last\x20chance','meta[name=\x22twitter:description\x22]','christmas\x20deals','price\x20cut','Form\x20144','writable','Mozilla/5.0\x20(compatible;\x20NewsBot/1.0)','save\x20money','Fetch\x20failed','filter','huge\x20savings','16YmvLob','enclosure','https://www.investing.com/rss/news.rss','__importStar','\x20new\x20|\x20','save\x20big','Article\x20URL:','act\x20fast','852592XFwjeX','getMonth','(Source:\x20Bloomberg)','...','Classifier','topic','items','media:thumbnail','\x20sources).\x20Skipping.','substring','some','https://rss.slashdot.org/Slashdot/slashdot','flush','Show\x20HN:','lastIndexOf','deals\x20today','order\x20now','clearance\x20sale','url','qualityScore','index.json','textContent','\x20\x20Skipped\x20duplicate:\x20','casino','getOwnPropertyNames','grab\x20it\x20now','checkout','trim','.json','content','holiday\x20gift','has','price\x20drop','promo\x20code','Scrape\x20finished.\x20Added\x20','\x20complete\x20in\x20','\x20items.','getAttribute','querySelector','then','Feed\x20fetch\x20failed','isArray','editors\x20choice','text','timeout','meta[name=\x22description\x22]','buying\x20guide','staff\x20picks','limited\x20time\x20deal','__esModule','coupon\x20code','ðŸ”„\x20Batch\x20','SEC\x20filing','HTTP\x20error!\x20status:\x20','setDate','Job\x20Complete\x20in\x20','existsSync','./classifier','toLowerCase','addPost','p\x20a','defineProperty','path','daily\x20deals','toISOString','message','headers','490702OfkLgQ','4879000GyMWmx'];a5_0x4568=function(){return _0x5497c4;};return a5_0x4568();}function saveErrorLog(){const _0xed0edb=a5_0x55fb13;if(errorLog[_0xed0edb(0x13b)]===0x0)return;let _0x2857cc=[];if(fs[_0xed0edb(0x104)](ERROR_LOG_FILE))try{_0x2857cc=JSON[_0xed0edb(0x148)](fs['readFileSync'](ERROR_LOG_FILE,_0xed0edb(0x15f)));}catch{}const _0x16541c=[..._0x2857cc,...errorLog][_0xed0edb(0x140)](-0x64);fs[_0xed0edb(0x12c)](ERROR_LOG_FILE,JSON['stringify'](_0x16541c,null,0x2),_0xed0edb(0x15f));}async function processItem(_0x1cb4ce,_0x45caa7){const _0x3ecd7b=a5_0x55fb13;let _0x422112=_0x1cb4ce[_0x3ecd7b(0x14d)]?stripHtml(cleanCdata(_0x1cb4ce['title'])):null;_0x422112=removePhrases(_0x422112,phrasesToRemoveFromTitle);let _0x543a61=_0x1cb4ce[_0x3ecd7b(0x15c)],_0x431789=null;if(_0x45caa7[_0x3ecd7b(0xde)][_0x3ecd7b(0xb0)]('hnrss.org')){if(_0x1cb4ce[_0x3ecd7b(0xe9)]){const _0x5687c9=(0x0,node_html_parser_1['parse'])(_0x1cb4ce[_0x3ecd7b(0xe9)]),_0x32cee0=_0x5687c9['querySelector'](_0x3ecd7b(0x108));_0x32cee0&&_0x32cee0[_0x3ecd7b(0xf7)]['startsWith'](_0x3ecd7b(0xca))&&(_0x543a61=_0x32cee0['getAttribute']('href'));}_0x431789=null;}else _0x1cb4ce[_0x3ecd7b(0x176)]&&(_0x431789=stripHtml(cleanCdata(_0x1cb4ce[_0x3ecd7b(0x176)]))||null,_0x431789=removePhrases(_0x431789,phrasesToRemoveFromDescription),_0x431789=cleanDescriptionBylines(_0x431789),_0x431789=truncateDescription(_0x431789));!_0x431789&&_0x1cb4ce[_0x3ecd7b(0x12f)]&&(_0x431789=stripHtml(cleanCdata(_0x1cb4ce['content:encoded']))||null,_0x431789=removePhrases(_0x431789,phrasesToRemoveFromDescription),_0x431789=cleanDescriptionBylines(_0x431789),_0x431789=truncateDescription(_0x431789));_0x45caa7[_0x3ecd7b(0xde)]===_0x3ecd7b(0xd7)&&_0x1cb4ce[_0x3ecd7b(0x11d)]&&(_0x431789=stripHtml(cleanCdata(_0x1cb4ce[_0x3ecd7b(0x11d)]))||null,_0x431789=removePhrases(_0x431789,phrasesToRemoveFromDescription),_0x431789=cleanDescriptionBylines(_0x431789),_0x431789=truncateDescription(_0x431789));if(!_0x422112||!_0x543a61)return null;const _0x2f6d55=_0x422112+'\x20'+(_0x1cb4ce[_0x3ecd7b(0x176)]?stripHtml(_0x1cb4ce[_0x3ecd7b(0x176)]):'')+'\x20'+(_0x1cb4ce[_0x3ecd7b(0x11d)]?stripHtml(_0x1cb4ce[_0x3ecd7b(0x11d)]):'');if(isPromotionalContent(_0x2f6d55))return null;let _0x3db999=_0x1cb4ce[_0x3ecd7b(0xc5)]?_0x1cb4ce[_0x3ecd7b(0xc5)][_0x3ecd7b(0xde)]:null;if(_0x1cb4ce[_0x3ecd7b(0x138)]){if(Array[_0x3ecd7b(0xf5)](_0x1cb4ce[_0x3ecd7b(0x138)])){const _0xc32043=_0x1cb4ce[_0x3ecd7b(0x138)][_0x3ecd7b(0xb7)]((_0x47b3bb,_0x18c579)=>{const _0x54a4a3=_0x3ecd7b,_0x5a3d6e=_0x47b3bb['$']&&_0x47b3bb['$'][_0x54a4a3(0xb3)]?parseInt(_0x47b3bb['$'][_0x54a4a3(0xb3)],0xa):0x0,_0x44989=_0x18c579['$']&&_0x18c579['$'][_0x54a4a3(0xb3)]?parseInt(_0x18c579['$']['width'],0xa):0x0;return _0x44989-_0x5a3d6e;}),_0x407dbb=_0xc32043[0x0];if(_0x407dbb){const _0x59e363=_0x407dbb['$']&&_0x407dbb['$']['width']?parseInt(_0x407dbb['$'][_0x3ecd7b(0xb3)],0xa):0x0;if(_0x59e363===0x0||_0x59e363>=0x12c){if(_0x407dbb['$']&&_0x407dbb['$']['url'])_0x3db999=_0x407dbb['$'][_0x3ecd7b(0xde)];else{if(_0x407dbb[_0x3ecd7b(0xde)])_0x3db999=_0x407dbb['url'];}}}}else{const _0x37b689=_0x1cb4ce[_0x3ecd7b(0x138)],_0x3759aa=_0x37b689['$']&&_0x37b689['$'][_0x3ecd7b(0xb3)]?parseInt(_0x37b689['$']['width'],0xa):_0x37b689['width']?parseInt(_0x37b689[_0x3ecd7b(0xb3)],0xa):0x0;if(_0x3759aa===0x0||_0x3759aa>=0x12c){if(_0x37b689['$']&&_0x37b689['$'][_0x3ecd7b(0xde)])_0x3db999=_0x37b689['$'][_0x3ecd7b(0xde)];else{if(_0x37b689['url'])_0x3db999=_0x37b689[_0x3ecd7b(0xde)];}}}}if(!_0x3db999&&_0x1cb4ce[_0x3ecd7b(0xd3)]){if(_0x1cb4ce[_0x3ecd7b(0xd3)]['$']&&_0x1cb4ce[_0x3ecd7b(0xd3)]['$'][_0x3ecd7b(0xde)])_0x3db999=_0x1cb4ce[_0x3ecd7b(0xd3)]['$']['url'];else _0x1cb4ce[_0x3ecd7b(0xd3)][_0x3ecd7b(0xde)]&&(_0x3db999=_0x1cb4ce[_0x3ecd7b(0xd3)][_0x3ecd7b(0xde)]);}_0x3db999&&bannedThumbnails[_0x3ecd7b(0xb0)](_0x3db999)&&(_0x3db999=null);let _0x4a2b9f=null,_0x5c5592={'fullText':null,'readingTime':0x0,'keywords':[],'qualityScore':0x0};const _0x2a7043=!_0x431789||!_0x3db999||_0x45caa7[_0x3ecd7b(0xde)]['includes']('hnrss.org')||_0x45caa7[_0x3ecd7b(0xde)]==='https://rss.slashdot.org/Slashdot/slashdot'||_0x45caa7[_0x3ecd7b(0xde)]===_0x3ecd7b(0xc6);try{const _0x2e33f0=await fetchArticleMetadata(_0x543a61);_0x4a2b9f=_0x2e33f0['html'],!_0x431789&&(_0x431789=_0x2e33f0['description']),!_0x3db999&&(_0x3db999=_0x2e33f0['thumbnail_url']);}catch(_0x364004){logError(_0x45caa7[_0x3ecd7b(0x178)],_0x543a61,_0x364004[_0x3ecd7b(0x10d)]||_0x3ecd7b(0xc1));}if(_0x4a2b9f){_0x5c5592=(0x0,article_extractor_1[_0x3ecd7b(0xaf)])(_0x4a2b9f,_0x543a61);if(_0x5c5592[_0x3ecd7b(0x166)]&&isPromotionalContent(_0x5c5592['fullText']))return console[_0x3ecd7b(0xb6)](_0x3ecd7b(0x188)+_0x422112),null;}_0x3db999&&bannedThumbnails[_0x3ecd7b(0xb0)](_0x3db999)&&(_0x3db999=null);if(_0x3db999){const _0x44f473=await isImageLargeEnough(_0x3db999);!_0x44f473&&(_0x3db999=null);}if(!_0x3db999)return null;const _0x20d90b=_0x422112[_0x3ecd7b(0x106)]()[_0x3ecd7b(0x16b)](/[^a-z0-9\s]/g,'')[_0x3ecd7b(0xe7)]()[_0x3ecd7b(0x16b)](/\s+/g,'-');let _0x9127ea=_0x20d90b[_0x3ecd7b(0xd5)](0x0,0x78);if(_0x20d90b['length']>0x78){const _0x3a2d54=_0x9127ea[_0x3ecd7b(0xda)]('-');_0x3a2d54>0x0&&(_0x9127ea=_0x9127ea[_0x3ecd7b(0xd5)](0x0,_0x3a2d54));}_0x9127ea=_0x9127ea['replace'](/-+$/,'');!_0x9127ea&&(_0x9127ea='post-'+Date[_0x3ecd7b(0x131)]());const _0x4858b4=(0x0,sources_1[_0x3ecd7b(0x15a)])(_0x543a61,_0x45caa7[_0x3ecd7b(0x178)],_0x45caa7[_0x3ecd7b(0xd1)]||'news');return{'slug':_0x9127ea,'title':_0x422112,'description':_0x431789,'fullText':_0x5c5592['fullText'],'readingTime':_0x5c5592[_0x3ecd7b(0x118)],'keywords':_0x5c5592[_0x3ecd7b(0x162)],'qualityScore':_0x5c5592[_0x3ecd7b(0xdf)],'link':_0x543a61,'thumbnail_url':_0x3db999,'created_at':new Date()[_0x3ecd7b(0x10c)](),'topic':_0x4858b4};}async function processInParallel(_0x54a700,_0x475e14,_0x1ce79e){const _0x268863=a5_0x55fb13,_0x5d298c=[],_0x3ad3d6=[];for(const _0x20a0d1 of _0x54a700){const _0x3c97cf=_0x475e14(_0x20a0d1)[_0x268863(0xf3)](_0x447460=>{const _0x93f0d7=_0x268863;_0x5d298c[_0x93f0d7(0x177)](_0x447460);})['catch'](()=>{const _0x50af99=_0x268863;_0x5d298c[_0x50af99(0x177)](null);});_0x3ad3d6[_0x268863(0x177)](_0x3c97cf);if(_0x3ad3d6[_0x268863(0x13b)]>=_0x1ce79e){await Promise[_0x268863(0x186)](_0x3ad3d6);const _0x3eb9ad=_0x3ad3d6[_0x268863(0xc2)](_0x1ca10f=>{const _0x3f6aaa=_0x268863;let _0x2f258e=![];return _0x1ca10f[_0x3f6aaa(0xf3)](()=>{_0x2f258e=!![];})[_0x3f6aaa(0x151)](()=>{_0x2f258e=!![];}),!_0x2f258e;});_0x3ad3d6[_0x268863(0x13b)]=0x0,_0x3ad3d6[_0x268863(0x177)](..._0x3eb9ad);}}return await Promise['all'](_0x3ad3d6),_0x5d298c;}async function processBatch(_0x21bdd1,_0x2dbcee,_0x40a6f5=MAX_CONCURRENT_FETCHES){const _0x34c1fb=a5_0x55fb13,_0x33d194=[];for(let _0x4784aa=0x0;_0x4784aa<_0x21bdd1['length'];_0x4784aa+=_0x40a6f5){const _0x497127=_0x21bdd1[_0x34c1fb(0x140)](_0x4784aa,_0x4784aa+_0x40a6f5),_0x32b576=await Promise[_0x34c1fb(0x14c)](_0x497127[_0x34c1fb(0x155)](_0x3d4c84=>_0x2dbcee(_0x3d4c84)));for(const _0x28a61f of _0x32b576){_0x28a61f['status']==='fulfilled'?_0x33d194[_0x34c1fb(0x177)](_0x28a61f[_0x34c1fb(0x13f)]):_0x33d194[_0x34c1fb(0x177)](null);}}return _0x33d194;}async function run(){const _0x223780=a5_0x55fb13,{batch:_0x31b9ff,totalBatches:_0x354a74,test:_0x5c5297}=parseArgs();console['log'](_0x223780(0x123));_0x31b9ff!==null&&_0x354a74!==null&&console[_0x223780(0xb6)](_0x223780(0x11c)+(_0x31b9ff+0x1)+'\x20of\x20'+_0x354a74);const _0x649d9b=Date[_0x223780(0x131)](),_0x467871=new Date()[_0x223780(0x10c)]()[_0x223780(0x160)]('T')[0x0],_0x4af3ec=path['join'](OUTPUT_DIR,_0x467871+_0x223780(0xe8));let _0x51fd03=[];if(fs['existsSync'](INDEX_FILE))try{_0x51fd03=JSON['parse'](fs[_0x223780(0x174)](INDEX_FILE,_0x223780(0x15f)));}catch{console[_0x223780(0x13d)]('Error\x20reading\x20index\x20file,\x20starting\x20fresh.');}const _0x286033=new Set(_0x51fd03),_0x28a8c7=new Set();let _0xea9344=[];if(fs[_0x223780(0x104)](_0x4af3ec))try{_0xea9344=JSON[_0x223780(0x148)](fs[_0x223780(0x174)](_0x4af3ec,_0x223780(0x15f)));for(const _0x3f261e of _0xea9344){_0x3f261e[_0x223780(0x166)]&&_0x28a8c7[_0x223780(0x129)](_0x3f261e[_0x223780(0x166)][_0x223780(0xd5)](0x0,0x64));}}catch{console[_0x223780(0x13d)](_0x223780(0x17a));}let _0x10ac0b=[...sources_1['sourcesData']],_0xdae179=null;if(_0x5c5297)console[_0x223780(0xb6)](_0x223780(0x179)),_0x10ac0b=sources_1[_0x223780(0x14b)]['slice'](0x0,0x1),_0xdae179=0xa;else{if(_0x31b9ff!==null&&_0x354a74!==null){const _0x5c5255=0x5,_0x479c1c=Math['min'](_0x354a74,Math[_0x223780(0x184)](0x1,Math['ceil'](sources_1[_0x223780(0x14b)][_0x223780(0x13b)]/_0x5c5255)));if(_0x31b9ff>=_0x479c1c){console['log'](_0x223780(0x181)+(_0x31b9ff+0x1)+'\x20not\x20needed\x20(only\x20'+_0x479c1c+_0x223780(0x147)+sources_1[_0x223780(0x14b)][_0x223780(0x13b)]+_0x223780(0xd4));return;}const _0x21a046=Math['ceil'](sources_1[_0x223780(0x14b)][_0x223780(0x13b)]/_0x479c1c),_0x3352c7=_0x31b9ff*_0x21a046,_0x213c6f=Math[_0x223780(0x115)](_0x3352c7+_0x21a046,sources_1['sourcesData']['length']);_0x10ac0b=sources_1[_0x223780(0x14b)][_0x223780(0x140)](_0x3352c7,_0x213c6f),console[_0x223780(0xb6)](_0x223780(0xff)+(_0x31b9ff+0x1)+'/'+_0x479c1c+_0x223780(0x13e)+(_0x3352c7+0x1)+'-'+_0x213c6f+_0x223780(0x15e)+sources_1[_0x223780(0x14b)][_0x223780(0x13b)]);}}let _0x20f9ea=0x0;for(const _0x3af9ef of _0x10ac0b){console[_0x223780(0xb6)]('Processing\x20source:\x20'+_0x3af9ef[_0x223780(0x178)]);try{const _0x1621dc=await parser[_0x223780(0x173)](_0x3af9ef['url']),_0x27106f=_0xdae179||MAX_ITEMS_PER_SOURCE,_0x2fe4c1=_0x1621dc[_0x223780(0xd2)]['filter'](isRecentItem)[_0x223780(0x140)](0x0,_0x27106f),_0x22cc02=_0x1621dc[_0x223780(0xd2)][_0x223780(0x13b)]-_0x2fe4c1[_0x223780(0x13b)]-(_0x1621dc[_0x223780(0xd2)][_0x223780(0x13b)]>_0x27106f?_0x1621dc['items']['length']-_0x27106f:0x0),_0x466f5e=_0x2fe4c1['filter'](_0x3da58a=>{const _0x215638=_0x223780,_0x5bae6b=_0x3da58a[_0x215638(0x15c)];return _0x5bae6b&&!_0x286033[_0x215638(0xeb)](_0x5bae6b);}),_0x4e0635=_0x2fe4c1['length']-_0x466f5e[_0x223780(0x13b)];console['log']('\x20\x20'+_0x466f5e[_0x223780(0x13b)]+_0x223780(0xc8)+_0x4e0635+_0x223780(0x143)+_0x22cc02+'\x20old\x20(filtered)');const _0x250e4d=await processBatch(_0x466f5e,_0x511965=>processItem(_0x511965,_0x3af9ef),MAX_CONCURRENT_FETCHES);for(const _0x2ce856 of _0x250e4d){if(_0x2ce856&&_0x2ce856[_0x223780(0x15c)]){if(_0x2ce856[_0x223780(0x166)]){const _0x3e9426=_0x2ce856[_0x223780(0x166)][_0x223780(0xd5)](0x0,0x64);if(_0x28a8c7[_0x223780(0xeb)](_0x3e9426)){console[_0x223780(0xb6)](_0x223780(0xe2)+_0x2ce856[_0x223780(0x14d)][_0x223780(0xd5)](0x0,0x28)+_0x223780(0xcf));continue;}_0x28a8c7[_0x223780(0x129)](_0x3e9426);}_0xea9344[_0x223780(0x177)](_0x2ce856),_0x286033[_0x223780(0x129)](_0x2ce856['link']),_0x20f9ea++;}}}catch(_0x418e4b){console[_0x223780(0x13d)](_0x223780(0x128)+_0x3af9ef[_0x223780(0x178)]+':',_0x418e4b[_0x223780(0x10d)]),logError(_0x3af9ef[_0x223780(0x178)],_0x3af9ef[_0x223780(0xde)],_0x418e4b[_0x223780(0x10d)]||_0x223780(0xf4));}}fs[_0x223780(0x12c)](_0x4af3ec,JSON['stringify'](_0xea9344,null,0x2),_0x223780(0x15f)),fs[_0x223780(0x12c)](INDEX_FILE,JSON['stringify'](Array[_0x223780(0x175)](_0x286033),null,0x2),_0x223780(0x15f)),saveErrorLog(),console[_0x223780(0xb6)](_0x223780(0xee)+_0x20f9ea+_0x223780(0xf0));if(_0x31b9ff===null){console['log']('Starting\x20Aggregation\x20&\x20Classification...');const _0x4eb414=new classifier_1[(_0x223780(0xd0))](),_0x145bec=new bucket_manager_1[(_0x223780(0x18b))](OUTPUT_DIR);await _0x145bec[_0x223780(0x116)]();let _0x2f7de1=0x0;for(const _0xbbeaae of _0xea9344){const _0x4fc052=_0x4eb414['classify'](_0xbbeaae['title'],_0xbbeaae[_0x223780(0x11d)]);if(_0x4fc052[_0x223780(0x13b)]>0x0){for(const _0x59438e of _0x4fc052){_0x145bec[_0x223780(0x107)](_0xbbeaae,_0x59438e);}_0x2f7de1++;}}await _0x145bec[_0x223780(0xd8)]();const _0x4a804e=Date[_0x223780(0x131)]();console[_0x223780(0xb6)](_0x223780(0x103)+((_0x4a804e-_0x649d9b)/0x3e8)[_0x223780(0x17c)](0x2)+_0x223780(0x137)+_0x2f7de1+_0x223780(0xb5));}else{const _0x5b8af8=Date[_0x223780(0x131)]();console['log']('Batch\x20'+_0x31b9ff+_0x223780(0xef)+((_0x5b8af8-_0x649d9b)/0x3e8)[_0x223780(0x17c)](0x2)+'s.\x20Classification\x20will\x20run\x20in\x20merge\x20step.');}}run()[a5_0x55fb13(0x151)](console['error']);
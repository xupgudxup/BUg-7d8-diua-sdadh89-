'use strict';const a4_0x47ecec=a4_0xc16a;(function(_0x50a9df,_0x1c8f84){const _0x1f5ce5=a4_0xc16a,_0x4ffd03=_0x50a9df();while(!![]){try{const _0xcaaa6f=-parseInt(_0x1f5ce5(0x140))/0x1*(parseInt(_0x1f5ce5(0xde))/0x2)+-parseInt(_0x1f5ce5(0x123))/0x3*(parseInt(_0x1f5ce5(0xf5))/0x4)+parseInt(_0x1f5ce5(0xe7))/0x5+-parseInt(_0x1f5ce5(0xfa))/0x6+parseInt(_0x1f5ce5(0xd3))/0x7*(parseInt(_0x1f5ce5(0x116))/0x8)+parseInt(_0x1f5ce5(0x103))/0x9*(-parseInt(_0x1f5ce5(0x111))/0xa)+-parseInt(_0x1f5ce5(0xb9))/0xb*(-parseInt(_0x1f5ce5(0xb2))/0xc);if(_0xcaaa6f===_0x1c8f84)break;else _0x4ffd03['push'](_0x4ffd03['shift']());}catch(_0x31e449){_0x4ffd03['push'](_0x4ffd03['shift']());}}}(a4_0x1264,0xe26d3));var __createBinding=this&&this[a4_0x47ecec(0x100)]||(Object[a4_0x47ecec(0xda)]?function(_0x159e92,_0x51e266,_0x20779d,_0x149a00){const _0xa6c8ff=a4_0x47ecec;if(_0x149a00===undefined)_0x149a00=_0x20779d;var _0x3950fb=Object['getOwnPropertyDescriptor'](_0x51e266,_0x20779d);(!_0x3950fb||(_0xa6c8ff(0x10e)in _0x3950fb?!_0x51e266[_0xa6c8ff(0xc4)]:_0x3950fb[_0xa6c8ff(0x126)]||_0x3950fb[_0xa6c8ff(0xb7)]))&&(_0x3950fb={'enumerable':!![],'get':function(){return _0x51e266[_0x20779d];}}),Object['defineProperty'](_0x159e92,_0x149a00,_0x3950fb);}:function(_0x231df5,_0x5a3f56,_0x4c7afd,_0x2deec7){if(_0x2deec7===undefined)_0x2deec7=_0x4c7afd;_0x231df5[_0x2deec7]=_0x5a3f56[_0x4c7afd];}),__setModuleDefault=this&&this[a4_0x47ecec(0x13a)]||(Object['create']?function(_0x372a5e,_0x45e18f){const _0x5441e0=a4_0x47ecec;Object['defineProperty'](_0x372a5e,_0x5441e0(0x118),{'enumerable':!![],'value':_0x45e18f});}:function(_0x2ce307,_0x5baa64){const _0x47a738=a4_0x47ecec;_0x2ce307[_0x47a738(0x118)]=_0x5baa64;}),__importStar=this&&this[a4_0x47ecec(0xf7)]||(function(){var _0x25a24e=function(_0x3f0165){return _0x25a24e=Object['getOwnPropertyNames']||function(_0x4fb422){const _0xc74b17=a4_0xc16a;var _0x1b6dca=[];for(var _0x2290b4 in _0x4fb422)if(Object[_0xc74b17(0x119)]['hasOwnProperty'][_0xc74b17(0x138)](_0x4fb422,_0x2290b4))_0x1b6dca[_0x1b6dca[_0xc74b17(0x136)]]=_0x2290b4;return _0x1b6dca;},_0x25a24e(_0x3f0165);};return function(_0x43baa9){const _0x496d83=a4_0xc16a;if(_0x43baa9&&_0x43baa9[_0x496d83(0xc4)])return _0x43baa9;var _0x404c06={};if(_0x43baa9!=null){for(var _0x2f1626=_0x25a24e(_0x43baa9),_0x19f4a6=0x0;_0x19f4a6<_0x2f1626[_0x496d83(0x136)];_0x19f4a6++)if(_0x2f1626[_0x19f4a6]!==_0x496d83(0x118))__createBinding(_0x404c06,_0x43baa9,_0x2f1626[_0x19f4a6]);}return __setModuleDefault(_0x404c06,_0x43baa9),_0x404c06;};}()),__importDefault=this&&this[a4_0x47ecec(0xf2)]||function(_0x4a1d22){const _0x1af12e=a4_0x47ecec;return _0x4a1d22&&_0x4a1d22[_0x1af12e(0xc4)]?_0x4a1d22:{'default':_0x4a1d22};};Object['defineProperty'](exports,a4_0x47ecec(0xc4),{'value':!![]});const fs=__importStar(require('fs')),path=__importStar(require(a4_0x47ecec(0x144))),rss_parser_1=__importDefault(require('rss-parser')),node_html_parser_1=require('node-html-parser'),sources_1=require('./sources'),article_extractor_1=require('./article-extractor'),classifier_1=require(a4_0x47ecec(0xb5)),bucket_manager_1=require(a4_0x47ecec(0xce)),parser=new rss_parser_1[(a4_0x47ecec(0x118))](),OUTPUT_DIR=path[a4_0x47ecec(0xc8)](__dirname,a4_0x47ecec(0x122));!fs[a4_0x47ecec(0x10f)](OUTPUT_DIR)&&fs['mkdirSync'](OUTPUT_DIR,{'recursive':!![]});const INDEX_FILE=path[a4_0x47ecec(0xc8)](OUTPUT_DIR,a4_0x47ecec(0x10d)),ERROR_LOG_FILE=path['join'](OUTPUT_DIR,a4_0x47ecec(0x135)),bannedKeywords=[a4_0x47ecec(0x125),a4_0x47ecec(0x137),a4_0x47ecec(0x133),'gambling',a4_0x47ecec(0x107),a4_0x47ecec(0xbc),'Form\x20144',a4_0x47ecec(0xef),a4_0x47ecec(0xd6),'discount','best'],bannedThumbnails=['https://s.yimg.com/cv/apiv2/social/images/yahoo_default_logo-1200x1200.png'],phrasesToRemoveFromDescription=[a4_0x47ecec(0xe3),a4_0x47ecec(0x11c)],descriptionBylinePatterns=[/^By\s+[A-Z][a-z]+\s+[A-Z][a-z]+(\s+and\s+[A-Z][a-z]+\s+[A-Z][a-z]+)?\s+[A-Z]{2,}.*?\(Reuters\)\s*-?\s*/i,/^By\s+[A-Z][a-z]+\s+[A-Z][a-z]+(\s+and\s+[A-Z][a-z]+\s+[A-Z][a-z]+)?\s+[A-Z]{2,}.*?\(AP\)\s*-?\s*/i,/^By\s+[A-Z][a-z]+\s+[A-Z][a-z]+(\s+and\s+[A-Z][a-z]+\s+[A-Z][a-z]+)?\s+[A-Z]{2,}.*?\(AFP\)\s*-?\s*/i,/^By\s+[A-Z][a-z]+\s+[A-Z][a-z]+\s*/i,/^[A-Z]{2,}[A-Z\s,]+\(Reuters\)\s*-?\s*/i,/^[A-Z]{2,}[A-Z\s,]+\(AP\)\s*-?\s*/i,/^[A-Z]{2,}[A-Z\s,]+\(AFP\)\s*-?\s*/i,/^[A-Z]{3,},?\s+(Jan|Feb|Mar|Apr|May|Jun|Jul|Aug|Sep|Oct|Nov|Dec)\s+\d{1,2}\s+\([^)]+\)\s*-?\s*/i,/^(Jan|Feb|Mar|Apr|May|Jun|Jul|Aug|Sep|Oct|Nov|Dec)\s+\d{1,2}\s+\([^)]+\)\s*-?\s*/i];function cleanDescriptionBylines(_0x5e115b){const _0x1a5dc3=a4_0x47ecec;if(!_0x5e115b)return null;let _0x202b34=_0x5e115b;for(const _0xeff5f5 of descriptionBylinePatterns){_0x202b34=_0x202b34['replace'](_0xeff5f5,'');}return _0x202b34[_0x1a5dc3(0xcd)]();}const phrasesToRemoveFromTitle=['Tell\x20HN:',a4_0x47ecec(0x127)],MAX_CONCURRENT_FETCHES=0x5,MAX_ITEMS_PER_SOURCE=0x64;function isRecentItem(_0x1387bc){const _0x3bfcef=a4_0x47ecec;if(!_0x1387bc[_0x3bfcef(0xdd)]&&!_0x1387bc[_0x3bfcef(0xfb)])return!![];try{const _0x3ce8d7=new Date(_0x1387bc[_0x3bfcef(0xdd)]||_0x1387bc['isoDate']),_0x430d3f=new Date(),_0x2a75a8=new Date(_0x430d3f[_0x3bfcef(0x132)](),_0x430d3f['getMonth'](),_0x430d3f['getDate']()),_0x3bc053=new Date(_0x2a75a8);return _0x3bc053['setDate'](_0x3bc053[_0x3bfcef(0xfc)]()-0x1),_0x3ce8d7>=_0x3bc053;}catch{return!![];}}function parseArgs(){const _0x333a8f=a4_0x47ecec,_0x182226=process[_0x333a8f(0xf8)][_0x333a8f(0xee)](0x2);let _0x3ba802=null,_0x3311ab=null,_0x11a171=![];for(const _0x1bf15d of _0x182226){if(_0x1bf15d[_0x333a8f(0x10a)]('--batch='))_0x3ba802=parseInt(_0x1bf15d[_0x333a8f(0x106)]('=')[0x1],0xa);else{if(_0x1bf15d[_0x333a8f(0x10a)](_0x333a8f(0xc1)))_0x3311ab=parseInt(_0x1bf15d[_0x333a8f(0x106)]('=')[0x1],0xa);else _0x1bf15d===_0x333a8f(0x104)&&(_0x11a171=!![]);}}return{'batch':_0x3ba802,'totalBatches':_0x3311ab,'test':_0x11a171};}function cleanCdata(_0xc13fb1){const _0x55c150=a4_0x47ecec;return _0xc13fb1[_0x55c150(0x121)](/<!\[CDATA\[|\]\]>/g,'')['trim']();}function stripHtml(_0x594794){const _0x57a918=a4_0x47ecec;return(0x0,node_html_parser_1[_0x57a918(0xd2)])(_0x594794)['textContent']||'';}function removePhrases(_0x569d06,_0x592a86){const _0x3673c4=a4_0x47ecec;if(!_0x569d06)return null;let _0x5ed186=_0x569d06;for(const _0x5634eb of _0x592a86){_0x5ed186=_0x5ed186['replace'](_0x5634eb,'')[_0x3673c4(0xcd)]();}return _0x5ed186;}function a4_0xc16a(_0x9067a4,_0x2912bf){const _0x12647a=a4_0x1264();return a4_0xc16a=function(_0xc16a2c,_0x58b4e9){_0xc16a2c=_0xc16a2c-0xad;let _0x2e798d=_0x12647a[_0xc16a2c];return _0x2e798d;},a4_0xc16a(_0x9067a4,_0x2912bf);}function truncateDescription(_0x1d29e0){const _0xb4802c=a4_0x47ecec;if(!_0x1d29e0)return null;const _0x24885a=_0x1d29e0['split'](/\n\s*\n/);let _0x34da5c=_0x24885a[0x0]||'';const _0x445b42=_0x34da5c['match'](/[^.!?]+[.!?]+|[^.!?]+$/g)||[];_0x445b42[_0xb4802c(0x136)]>0x5?_0x34da5c=_0x445b42[_0xb4802c(0xee)](0x0,0x5)['join']('')['trim']():_0x34da5c=_0x445b42[_0xb4802c(0xc8)]('')[_0xb4802c(0xcd)]();if(_0x34da5c[_0xb4802c(0x136)]<_0x1d29e0[_0xb4802c(0x136)]&&!/[.!?]$/[_0xb4802c(0x11a)](_0x34da5c)){const _0x2a69f1=_0x34da5c[_0xb4802c(0xca)]('\x20');_0x2a69f1>-0x1?_0x34da5c=_0x34da5c[_0xb4802c(0xc9)](0x0,_0x2a69f1)+'...':_0x34da5c=_0x34da5c+_0xb4802c(0x13e);}return _0x34da5c[_0xb4802c(0x136)]>0x0?_0x34da5c:null;}async function isImageLargeEnough(_0x3a7526){const _0x1f796c=a4_0x47ecec;try{const _0x1e1e91=await fetch(_0x3a7526,{'method':_0x1f796c(0xcf),'signal':AbortSignal[_0x1f796c(0x109)](0x7d0)});if(!_0x1e1e91['ok']){if(_0x1e1e91[_0x1f796c(0x113)]===0x194)return![];return!![];}const _0x2d8f4d=_0x1e1e91['headers'][_0x1f796c(0x10e)](_0x1f796c(0x146));if(_0x2d8f4d){const _0x5e3a02=parseInt(_0x2d8f4d,0xa);if(_0x5e3a02<0x3a98)return![];}return!![];}catch{return!![];}}async function fetchArticleMetadata(_0x55d669){const _0x538855=a4_0x47ecec;try{const _0x22cf8d=await fetch(_0x55d669,{'signal':AbortSignal[_0x538855(0x109)](0x3a98),'headers':{'User-Agent':'Mozilla/5.0\x20(compatible;\x20NewsBot/1.0)','Accept':'text/html,application/xhtml+xml'}});if(!_0x22cf8d['ok'])throw new Error('HTTP\x20error!\x20status:\x20'+_0x22cf8d[_0x538855(0x113)]);const _0x1bc749=await _0x22cf8d['text'](),_0x4a4b73=(0x0,node_html_parser_1[_0x538855(0xd2)])(_0x1bc749);let _0x198f95=null;const _0x40c5f1=['meta[property=\x22og:description\x22]','meta[name=\x22twitter:description\x22]',_0x538855(0x147)];for(const _0x1cc8e4 of _0x40c5f1){const _0x39a781=_0x4a4b73['querySelector'](_0x1cc8e4);if(_0x39a781&&_0x39a781[_0x538855(0x105)]('content')){_0x198f95=stripHtml(_0x39a781[_0x538855(0x105)](_0x538855(0xeb)))||null,_0x198f95=removePhrases(_0x198f95,phrasesToRemoveFromDescription),_0x198f95=cleanDescriptionBylines(_0x198f95),_0x198f95=truncateDescription(_0x198f95);break;}}let _0x55c5a3=null;const _0x2d2a59=[_0x538855(0x110),_0x538855(0xe8)];for(const _0xd9c5be of _0x2d2a59){const _0x52f56f=_0x4a4b73[_0x538855(0x128)](_0xd9c5be);if(_0x52f56f&&_0x52f56f[_0x538855(0x105)]('content')){_0x55c5a3=_0x52f56f[_0x538855(0x105)](_0x538855(0xeb));break;}}return{'description':_0x198f95,'thumbnail_url':_0x55c5a3,'html':_0x1bc749};}catch{return{'description':null,'thumbnail_url':null,'html':null};}}function a4_0x1264(){const _0x208d1f=['9hMrFam','media:content','s.\x20Classification\x20will\x20run\x20in\x20merge\x20step.','filter','path','has','content-length','meta[name=\x22description\x22]','writeFileSync','ðŸ”„\x20Batch\x20','\x20new\x20|\x20','qualityScore','https://rss.slashdot.org/Slashdot/slashdot','message','s.\x20Classified\x20','24lzxwUO','contentSnippet','description','./classifier','now','configurable','min','19682245GyFUJJ','width','allSettled','Form\x2013G','media:thumbnail','Starting\x20Aggregation\x20&\x20Classification...','stringify','then','--total-batches=','url','add','__esModule','items','value','toISOString','join','substring','lastIndexOf','push','map','trim','./bucket-manager','HEAD','from','classify','parse','147PRQndU','extractArticle','\x20\x20Skipped\x20duplicate:\x20','black\x20friday','â­ï¸\x20Batch\x20','readFileSync','\x20of\x20','create','content:encoded','topic','pubDate','363920SjwOKP','news','error','flush','Fetch\x20failed','(Source:\x20Bloomberg)','BucketManager','\x20not\x20needed\x20(only\x20','\x20old\x20(filtered)','5564400xikatu','meta[name=\x22twitter:image\x22]','toLowerCase','Scrape\x20finished.\x20Added\x20','content','readingTime','post-','slice','deals','catch','all','__importDefault','html','title','12SAzLin','p\x20a','__importStar','argv','endsWith','2061570ygBIls','isoDate','getDate','Batch\x20','Starting\x20job...','parseURL','__createBinding','text','Classifier','1971fRHXHJ','--test','getAttribute','split','Form\x2013F','\x20complete\x20in\x20','timeout','startsWith','isArray','log','index.json','get','existsSync','meta[property=\x22og:image\x22]','14770GJADaD','Error\x20fetching\x20source\x20','status','keywords','includes','94568EuvFwZ','âš ï¸\x20RUNNING\x20IN\x20TEST\x20MODE:\x20Limiting\x20to\x201\x20source\x20and\x2010\x20items.','default','prototype','test','sourcesData','Read\x20more\x20of\x20this\x20story\x20at\x20Slashdot.','.json','hnrss.org','link','fullText','replace','../output','1707570YpMfKr','enclosure','Only\x20Fans','writable','Show\x20HN:','querySelector','Error\x20reading\x20daily\x20file,\x20starting\x20fresh.','fulfilled','init','race','max','\x20posts.','href','ceil','toFixed','getFullYear','sex','https://www.investing.com/rss/news.rss','error-log.json','length','porn','call','Article\x20URL:','__setModuleDefault','thumbnail_url','name','utf-8','...','some'];a4_0x1264=function(){return _0x208d1f;};return a4_0x1264();}let errorLog=[];function logError(_0x5dbc83,_0x187ae6,_0x2c8168){const _0x26ee1b=a4_0x47ecec;errorLog[_0x26ee1b(0xcb)]({'source':_0x5dbc83,'url':_0x187ae6,'error':_0x2c8168,'timestamp':new Date()[_0x26ee1b(0xc7)]()});}function saveErrorLog(){const _0x3ea55f=a4_0x47ecec;if(errorLog[_0x3ea55f(0x136)]===0x0)return;let _0x51f65c=[];if(fs[_0x3ea55f(0x10f)](ERROR_LOG_FILE))try{_0x51f65c=JSON['parse'](fs[_0x3ea55f(0xd8)](ERROR_LOG_FILE,_0x3ea55f(0x13d)));}catch{}const _0x58e949=[..._0x51f65c,...errorLog]['slice'](-0x64);fs['writeFileSync'](ERROR_LOG_FILE,JSON[_0x3ea55f(0xbf)](_0x58e949,null,0x2),_0x3ea55f(0x13d));}async function processItem(_0x5b7d30,_0x5e5f67){const _0x3699da=a4_0x47ecec;let _0xb2f63f=_0x5b7d30[_0x3699da(0xf4)]?stripHtml(cleanCdata(_0x5b7d30['title'])):null;_0xb2f63f=removePhrases(_0xb2f63f,phrasesToRemoveFromTitle);let _0x3a4ca8=_0x5b7d30[_0x3699da(0x11f)],_0x9bb8c8=null;if(_0x5e5f67['url']['includes'](_0x3699da(0x11e))){if(_0x5b7d30['content']){const _0xd44158=(0x0,node_html_parser_1[_0x3699da(0xd2)])(_0x5b7d30['content']),_0x506933=_0xd44158['querySelector'](_0x3699da(0xf6));_0x506933&&_0x506933[_0x3699da(0x101)][_0x3699da(0x10a)](_0x3699da(0x139))&&(_0x3a4ca8=_0x506933[_0x3699da(0x105)](_0x3699da(0x12f)));}_0x9bb8c8=null;}else _0x5b7d30[_0x3699da(0xb3)]&&(_0x9bb8c8=stripHtml(cleanCdata(_0x5b7d30[_0x3699da(0xb3)]))||null,_0x9bb8c8=removePhrases(_0x9bb8c8,phrasesToRemoveFromDescription),_0x9bb8c8=cleanDescriptionBylines(_0x9bb8c8),_0x9bb8c8=truncateDescription(_0x9bb8c8));!_0x9bb8c8&&_0x5b7d30[_0x3699da(0xdb)]&&(_0x9bb8c8=stripHtml(cleanCdata(_0x5b7d30['content:encoded']))||null,_0x9bb8c8=removePhrases(_0x9bb8c8,phrasesToRemoveFromDescription),_0x9bb8c8=cleanDescriptionBylines(_0x9bb8c8),_0x9bb8c8=truncateDescription(_0x9bb8c8));_0x5e5f67[_0x3699da(0xc2)]===_0x3699da(0xaf)&&_0x5b7d30[_0x3699da(0xb4)]&&(_0x9bb8c8=stripHtml(cleanCdata(_0x5b7d30[_0x3699da(0xb4)]))||null,_0x9bb8c8=removePhrases(_0x9bb8c8,phrasesToRemoveFromDescription),_0x9bb8c8=cleanDescriptionBylines(_0x9bb8c8),_0x9bb8c8=truncateDescription(_0x9bb8c8));if(!_0xb2f63f||!_0x3a4ca8)return null;const _0x242cd5=(_0xb2f63f+'\x20'+(_0x5b7d30[_0x3699da(0xb3)]?stripHtml(_0x5b7d30[_0x3699da(0xb3)]):'')+'\x20'+(_0x5b7d30['description']?stripHtml(_0x5b7d30[_0x3699da(0xb4)]):''))['toLowerCase']();if(bannedKeywords[_0x3699da(0x13f)](_0x559876=>_0x242cd5[_0x3699da(0x115)](_0x559876['toLowerCase']())))return null;let _0x5935b5=_0x5b7d30[_0x3699da(0x124)]?_0x5b7d30[_0x3699da(0x124)][_0x3699da(0xc2)]:null;if(_0x5b7d30[_0x3699da(0x141)]){if(Array[_0x3699da(0x10b)](_0x5b7d30[_0x3699da(0x141)])){const _0x38fd43=_0x5b7d30[_0x3699da(0x141)]['sort']((_0x5802e3,_0x517705)=>{const _0x23f05c=_0x3699da,_0x499930=_0x5802e3['$']&&_0x5802e3['$'][_0x23f05c(0xba)]?parseInt(_0x5802e3['$'][_0x23f05c(0xba)],0xa):0x0,_0x571347=_0x517705['$']&&_0x517705['$'][_0x23f05c(0xba)]?parseInt(_0x517705['$'][_0x23f05c(0xba)],0xa):0x0;return _0x571347-_0x499930;}),_0x3e62cc=_0x38fd43[0x0];if(_0x3e62cc){const _0x5e6d22=_0x3e62cc['$']&&_0x3e62cc['$']['width']?parseInt(_0x3e62cc['$']['width'],0xa):0x0;if(_0x5e6d22===0x0||_0x5e6d22>=0x12c){if(_0x3e62cc['$']&&_0x3e62cc['$'][_0x3699da(0xc2)])_0x5935b5=_0x3e62cc['$'][_0x3699da(0xc2)];else{if(_0x3e62cc[_0x3699da(0xc2)])_0x5935b5=_0x3e62cc['url'];}}}}else{const _0x53cf3a=_0x5b7d30[_0x3699da(0x141)],_0x305f2b=_0x53cf3a['$']&&_0x53cf3a['$'][_0x3699da(0xba)]?parseInt(_0x53cf3a['$'][_0x3699da(0xba)],0xa):_0x53cf3a[_0x3699da(0xba)]?parseInt(_0x53cf3a[_0x3699da(0xba)],0xa):0x0;if(_0x305f2b===0x0||_0x305f2b>=0x12c){if(_0x53cf3a['$']&&_0x53cf3a['$'][_0x3699da(0xc2)])_0x5935b5=_0x53cf3a['$'][_0x3699da(0xc2)];else{if(_0x53cf3a['url'])_0x5935b5=_0x53cf3a[_0x3699da(0xc2)];}}}}if(!_0x5935b5&&_0x5b7d30[_0x3699da(0xbd)]){if(_0x5b7d30['media:thumbnail']['$']&&_0x5b7d30[_0x3699da(0xbd)]['$']['url'])_0x5935b5=_0x5b7d30['media:thumbnail']['$'][_0x3699da(0xc2)];else _0x5b7d30[_0x3699da(0xbd)][_0x3699da(0xc2)]&&(_0x5935b5=_0x5b7d30[_0x3699da(0xbd)][_0x3699da(0xc2)]);}_0x5935b5&&bannedThumbnails[_0x3699da(0x115)](_0x5935b5)&&(_0x5935b5=null);let _0x5d4eae=null,_0x575216={'fullText':null,'readingTime':0x0,'keywords':[],'qualityScore':0x0};const _0x154205=!_0x9bb8c8||!_0x5935b5||_0x5e5f67[_0x3699da(0xc2)]['includes']('hnrss.org')||_0x5e5f67[_0x3699da(0xc2)]===_0x3699da(0xaf)||_0x5e5f67[_0x3699da(0xc2)]===_0x3699da(0x134);try{const _0xc58704=await fetchArticleMetadata(_0x3a4ca8);_0x5d4eae=_0xc58704[_0x3699da(0xf3)],!_0x9bb8c8&&(_0x9bb8c8=_0xc58704[_0x3699da(0xb4)]),!_0x5935b5&&(_0x5935b5=_0xc58704[_0x3699da(0x13b)]);}catch(_0x528831){logError(_0x5e5f67['name'],_0x3a4ca8,_0x528831[_0x3699da(0xb0)]||_0x3699da(0xe2));}_0x5d4eae&&(_0x575216=(0x0,article_extractor_1[_0x3699da(0xd4)])(_0x5d4eae,_0x3a4ca8));_0x5935b5&&bannedThumbnails[_0x3699da(0x115)](_0x5935b5)&&(_0x5935b5=null);if(_0x5935b5){const _0x1cc363=await isImageLargeEnough(_0x5935b5);!_0x1cc363&&(_0x5935b5=null);}if(!_0x5935b5)return null;const _0x3248ee=_0xb2f63f[_0x3699da(0xe9)]()[_0x3699da(0x121)](/[^a-z0-9\s]/g,'')[_0x3699da(0xcd)]()[_0x3699da(0x121)](/\s+/g,'-');let _0x53ff0e=_0x3248ee[_0x3699da(0xc9)](0x0,0x3c);_0x53ff0e[_0x3699da(0xf9)]('-')&&(_0x53ff0e=_0x53ff0e[_0x3699da(0xee)](0x0,-0x1));!_0x53ff0e&&(_0x53ff0e=_0x3699da(0xed)+Date[_0x3699da(0xb6)]());const _0x2d0702=(0x0,sources_1['resolveTopicFromUrl'])(_0x3a4ca8,_0x5e5f67[_0x3699da(0x13c)],_0x5e5f67[_0x3699da(0xdc)]||_0x3699da(0xdf));return{'slug':_0x53ff0e,'title':_0xb2f63f,'description':_0x9bb8c8,'fullText':_0x575216[_0x3699da(0x120)],'readingTime':_0x575216[_0x3699da(0xec)],'keywords':_0x575216[_0x3699da(0x114)],'qualityScore':_0x575216[_0x3699da(0xae)],'link':_0x3a4ca8,'thumbnail_url':_0x5935b5,'created_at':new Date()[_0x3699da(0xc7)](),'topic':_0x2d0702};}async function processInParallel(_0x80b868,_0x252bc4,_0x1485c5){const _0x44d8d4=a4_0x47ecec,_0x28a75c=[],_0x30a5b0=[];for(const _0x301136 of _0x80b868){const _0x4cd505=_0x252bc4(_0x301136)[_0x44d8d4(0xc0)](_0x4fc1f5=>{const _0x3c2099=_0x44d8d4;_0x28a75c[_0x3c2099(0xcb)](_0x4fc1f5);})['catch'](()=>{_0x28a75c['push'](null);});_0x30a5b0[_0x44d8d4(0xcb)](_0x4cd505);if(_0x30a5b0[_0x44d8d4(0x136)]>=_0x1485c5){await Promise[_0x44d8d4(0x12c)](_0x30a5b0);const _0x1c7532=_0x30a5b0[_0x44d8d4(0x143)](_0x1500d5=>{const _0x4f3373=_0x44d8d4;let _0x3e99d6=![];return _0x1500d5[_0x4f3373(0xc0)](()=>{_0x3e99d6=!![];})[_0x4f3373(0xf0)](()=>{_0x3e99d6=!![];}),!_0x3e99d6;});_0x30a5b0['length']=0x0,_0x30a5b0['push'](..._0x1c7532);}}return await Promise[_0x44d8d4(0xf1)](_0x30a5b0),_0x28a75c;}async function processBatch(_0x281282,_0x4dc74d,_0x4118fd=MAX_CONCURRENT_FETCHES){const _0x4fe143=a4_0x47ecec,_0x1e90ba=[];for(let _0xc54221=0x0;_0xc54221<_0x281282[_0x4fe143(0x136)];_0xc54221+=_0x4118fd){const _0x5a80b6=_0x281282[_0x4fe143(0xee)](_0xc54221,_0xc54221+_0x4118fd),_0x45192d=await Promise[_0x4fe143(0xbb)](_0x5a80b6[_0x4fe143(0xcc)](_0x289b23=>_0x4dc74d(_0x289b23)));for(const _0x33f757 of _0x45192d){_0x33f757[_0x4fe143(0x113)]===_0x4fe143(0x12a)?_0x1e90ba['push'](_0x33f757[_0x4fe143(0xc6)]):_0x1e90ba[_0x4fe143(0xcb)](null);}}return _0x1e90ba;}async function run(){const _0x463b8a=a4_0x47ecec,{batch:_0x79141f,totalBatches:_0x1e41fd,test:_0x55b83d}=parseArgs();console[_0x463b8a(0x10c)](_0x463b8a(0xfe));_0x79141f!==null&&_0x1e41fd!==null&&console[_0x463b8a(0x10c)]('Running\x20batch\x20'+(_0x79141f+0x1)+_0x463b8a(0xd9)+_0x1e41fd);const _0x3aa89d=Date[_0x463b8a(0xb6)](),_0x4689c3=new Date()['toISOString']()[_0x463b8a(0x106)]('T')[0x0],_0x38383c=path[_0x463b8a(0xc8)](OUTPUT_DIR,_0x4689c3+_0x463b8a(0x11d));let _0x16d90=[];if(fs[_0x463b8a(0x10f)](INDEX_FILE))try{_0x16d90=JSON[_0x463b8a(0xd2)](fs['readFileSync'](INDEX_FILE,_0x463b8a(0x13d)));}catch{console[_0x463b8a(0xe0)]('Error\x20reading\x20index\x20file,\x20starting\x20fresh.');}const _0xa39af1=new Set(_0x16d90),_0x1e1bff=new Set();let _0x435b01=[];if(fs['existsSync'](_0x38383c))try{_0x435b01=JSON['parse'](fs[_0x463b8a(0xd8)](_0x38383c,_0x463b8a(0x13d)));for(const _0x49752e of _0x435b01){_0x49752e['fullText']&&_0x1e1bff[_0x463b8a(0xc3)](_0x49752e['fullText'][_0x463b8a(0xc9)](0x0,0x64));}}catch{console[_0x463b8a(0xe0)](_0x463b8a(0x129));}let _0x528a94=[...sources_1[_0x463b8a(0x11b)]],_0x58a946=null;if(_0x55b83d)console['log'](_0x463b8a(0x117)),_0x528a94=sources_1[_0x463b8a(0x11b)][_0x463b8a(0xee)](0x0,0x1),_0x58a946=0xa;else{if(_0x79141f!==null&&_0x1e41fd!==null){const _0x5df93e=0x5,_0x6ef5e9=Math[_0x463b8a(0xb8)](_0x1e41fd,Math[_0x463b8a(0x12d)](0x1,Math['ceil'](sources_1[_0x463b8a(0x11b)]['length']/_0x5df93e)));if(_0x79141f>=_0x6ef5e9){console[_0x463b8a(0x10c)](_0x463b8a(0xd7)+(_0x79141f+0x1)+_0x463b8a(0xe5)+_0x6ef5e9+'\x20batches\x20required\x20for\x20'+sources_1[_0x463b8a(0x11b)]['length']+'\x20sources).\x20Skipping.');return;}const _0x194239=Math[_0x463b8a(0x130)](sources_1[_0x463b8a(0x11b)][_0x463b8a(0x136)]/_0x6ef5e9),_0x4f586a=_0x79141f*_0x194239,_0x126616=Math[_0x463b8a(0xb8)](_0x4f586a+_0x194239,sources_1['sourcesData']['length']);_0x528a94=sources_1[_0x463b8a(0x11b)]['slice'](_0x4f586a,_0x126616),console[_0x463b8a(0x10c)](_0x463b8a(0x149)+(_0x79141f+0x1)+'/'+_0x6ef5e9+'\x20|\x20Processing\x20sources\x20'+(_0x4f586a+0x1)+'-'+_0x126616+'\x20of\x20'+sources_1['sourcesData'][_0x463b8a(0x136)]);}}let _0x5c0b30=0x0;for(const _0x51a109 of _0x528a94){console['log']('Processing\x20source:\x20'+_0x51a109[_0x463b8a(0x13c)]);try{const _0x438ea7=await parser[_0x463b8a(0xff)](_0x51a109['url']),_0x568bce=_0x58a946||MAX_ITEMS_PER_SOURCE,_0x4c7c96=_0x438ea7['items'][_0x463b8a(0x143)](isRecentItem)['slice'](0x0,_0x568bce),_0x370409=_0x438ea7[_0x463b8a(0xc5)][_0x463b8a(0x136)]-_0x4c7c96['length']-(_0x438ea7[_0x463b8a(0xc5)]['length']>_0x568bce?_0x438ea7['items'][_0x463b8a(0x136)]-_0x568bce:0x0),_0x108639=_0x4c7c96[_0x463b8a(0x143)](_0x3ee43c=>{const _0x3bee45=_0x463b8a,_0x216157=_0x3ee43c['link'];return _0x216157&&!_0xa39af1[_0x3bee45(0x145)](_0x216157);}),_0x2d49d6=_0x4c7c96[_0x463b8a(0x136)]-_0x108639[_0x463b8a(0x136)];console[_0x463b8a(0x10c)]('\x20\x20'+_0x108639[_0x463b8a(0x136)]+_0x463b8a(0xad)+_0x2d49d6+'\x20cached\x20|\x20'+_0x370409+_0x463b8a(0xe6));const _0x111cf5=await processBatch(_0x108639,_0x4c43d0=>processItem(_0x4c43d0,_0x51a109),MAX_CONCURRENT_FETCHES);for(const _0x51afb9 of _0x111cf5){if(_0x51afb9&&_0x51afb9[_0x463b8a(0x11f)]){if(_0x51afb9[_0x463b8a(0x120)]){const _0x573755=_0x51afb9['fullText']['substring'](0x0,0x64);if(_0x1e1bff[_0x463b8a(0x145)](_0x573755)){console['log'](_0x463b8a(0xd5)+_0x51afb9['title'][_0x463b8a(0xc9)](0x0,0x28)+_0x463b8a(0x13e));continue;}_0x1e1bff[_0x463b8a(0xc3)](_0x573755);}_0x435b01[_0x463b8a(0xcb)](_0x51afb9),_0xa39af1[_0x463b8a(0xc3)](_0x51afb9[_0x463b8a(0x11f)]),_0x5c0b30++;}}}catch(_0x2e39b2){console[_0x463b8a(0xe0)](_0x463b8a(0x112)+_0x51a109['name']+':',_0x2e39b2[_0x463b8a(0xb0)]),logError(_0x51a109[_0x463b8a(0x13c)],_0x51a109['url'],_0x2e39b2['message']||'Feed\x20fetch\x20failed');}}fs[_0x463b8a(0x148)](_0x38383c,JSON[_0x463b8a(0xbf)](_0x435b01,null,0x2),_0x463b8a(0x13d)),fs[_0x463b8a(0x148)](INDEX_FILE,JSON['stringify'](Array[_0x463b8a(0xd0)](_0xa39af1),null,0x2),_0x463b8a(0x13d)),saveErrorLog(),console[_0x463b8a(0x10c)](_0x463b8a(0xea)+_0x5c0b30+'\x20items.');if(_0x79141f===null){console[_0x463b8a(0x10c)](_0x463b8a(0xbe));const _0x17b58c=new classifier_1[(_0x463b8a(0x102))](),_0x90b7c8=new bucket_manager_1[(_0x463b8a(0xe4))](OUTPUT_DIR);await _0x90b7c8[_0x463b8a(0x12b)]();let _0x44a335=0x0;for(const _0x5ee2c1 of _0x435b01){const _0x470e7c=_0x17b58c[_0x463b8a(0xd1)](_0x5ee2c1['title'],_0x5ee2c1[_0x463b8a(0xb4)]);if(_0x470e7c[_0x463b8a(0x136)]>0x0){for(const _0x25649f of _0x470e7c){_0x90b7c8['addPost'](_0x5ee2c1,_0x25649f);}_0x44a335++;}}await _0x90b7c8[_0x463b8a(0xe1)]();const _0x14e2ec=Date[_0x463b8a(0xb6)]();console['log']('Job\x20Complete\x20in\x20'+((_0x14e2ec-_0x3aa89d)/0x3e8)['toFixed'](0x2)+_0x463b8a(0xb1)+_0x44a335+_0x463b8a(0x12e));}else{const _0x580603=Date['now']();console[_0x463b8a(0x10c)](_0x463b8a(0xfd)+_0x79141f+_0x463b8a(0x108)+((_0x580603-_0x3aa89d)/0x3e8)[_0x463b8a(0x131)](0x2)+_0x463b8a(0x142));}}run()[a4_0x47ecec(0xf0)](console['error']);
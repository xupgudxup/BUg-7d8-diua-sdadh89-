'use strict';const a5_0x3be7b3=a5_0x4c19;(function(_0x37143c,_0x5ccfbf){const _0x2b2786=a5_0x4c19,_0x29593e=_0x37143c();while(!![]){try{const _0x2b67fd=parseInt(_0x2b2786(0x1c1))/0x1+-parseInt(_0x2b2786(0x1ff))/0x2+parseInt(_0x2b2786(0x24a))/0x3+-parseInt(_0x2b2786(0x192))/0x4+parseInt(_0x2b2786(0x1f6))/0x5*(-parseInt(_0x2b2786(0x222))/0x6)+parseInt(_0x2b2786(0x244))/0x7+parseInt(_0x2b2786(0x18a))/0x8;if(_0x2b67fd===_0x5ccfbf)break;else _0x29593e['push'](_0x29593e['shift']());}catch(_0x27a5c5){_0x29593e['push'](_0x29593e['shift']());}}}(a5_0x5d6f,0x8402d));var __createBinding=this&&this[a5_0x3be7b3(0x1a8)]||(Object[a5_0x3be7b3(0x254)]?function(_0x1b0341,_0x10e086,_0x171795,_0x567326){const _0x21fb65=a5_0x3be7b3;if(_0x567326===undefined)_0x567326=_0x171795;var _0x33d830=Object[_0x21fb65(0x1c0)](_0x10e086,_0x171795);(!_0x33d830||(_0x21fb65(0x227)in _0x33d830?!_0x10e086[_0x21fb65(0x223)]:_0x33d830['writable']||_0x33d830['configurable']))&&(_0x33d830={'enumerable':!![],'get':function(){return _0x10e086[_0x171795];}}),Object['defineProperty'](_0x1b0341,_0x567326,_0x33d830);}:function(_0x511914,_0xd1873e,_0x8238b0,_0x454108){if(_0x454108===undefined)_0x454108=_0x8238b0;_0x511914[_0x454108]=_0xd1873e[_0x8238b0];}),__setModuleDefault=this&&this[a5_0x3be7b3(0x200)]||(Object['create']?function(_0x4d51cf,_0x52234b){const _0x17fe56=a5_0x3be7b3;Object['defineProperty'](_0x4d51cf,_0x17fe56(0x248),{'enumerable':!![],'value':_0x52234b});}:function(_0x830b8e,_0x4ab5d6){const _0x427ec0=a5_0x3be7b3;_0x830b8e[_0x427ec0(0x248)]=_0x4ab5d6;}),__importStar=this&&this[a5_0x3be7b3(0x250)]||(function(){var _0x19994e=function(_0x411601){const _0x146148=a5_0x4c19;return _0x19994e=Object[_0x146148(0x257)]||function(_0xcc549f){const _0x536b63=_0x146148;var _0x2f973d=[];for(var _0x2ade95 in _0xcc549f)if(Object[_0x536b63(0x1b1)][_0x536b63(0x23f)][_0x536b63(0x253)](_0xcc549f,_0x2ade95))_0x2f973d[_0x2f973d[_0x536b63(0x259)]]=_0x2ade95;return _0x2f973d;},_0x19994e(_0x411601);};return function(_0xc69631){const _0x3c1b5f=a5_0x4c19;if(_0xc69631&&_0xc69631[_0x3c1b5f(0x223)])return _0xc69631;var _0x191fd7={};if(_0xc69631!=null){for(var _0x181c8b=_0x19994e(_0xc69631),_0x3d953d=0x0;_0x3d953d<_0x181c8b[_0x3c1b5f(0x259)];_0x3d953d++)if(_0x181c8b[_0x3d953d]!=='default')__createBinding(_0x191fd7,_0xc69631,_0x181c8b[_0x3d953d]);}return __setModuleDefault(_0x191fd7,_0xc69631),_0x191fd7;};}()),__importDefault=this&&this['__importDefault']||function(_0xee25ca){return _0xee25ca&&_0xee25ca['__esModule']?_0xee25ca:{'default':_0xee25ca};};function a5_0x4c19(_0x2977f5,_0x2e77ed){const _0x5d6f8e=a5_0x5d6f();return a5_0x4c19=function(_0x4c1982,_0x5eb463){_0x4c1982=_0x4c1982-0x183;let _0x24c3b6=_0x5d6f8e[_0x4c1982];return _0x24c3b6;},a5_0x4c19(_0x2977f5,_0x2e77ed);}Object['defineProperty'](exports,a5_0x3be7b3(0x223),{'value':!![]});const fs=__importStar(require('fs')),path=__importStar(require('path')),rss_parser_1=__importDefault(require(a5_0x3be7b3(0x185))),node_html_parser_1=require(a5_0x3be7b3(0x1aa)),sources_1=require(a5_0x3be7b3(0x1fc)),article_extractor_1=require(a5_0x3be7b3(0x242)),classifier_1=require('./classifier'),bucket_manager_1=require(a5_0x3be7b3(0x1a1)),parser=new rss_parser_1[(a5_0x3be7b3(0x248))](),OUTPUT_DIR=path[a5_0x3be7b3(0x1c5)](__dirname,a5_0x3be7b3(0x1f3));!fs[a5_0x3be7b3(0x1b4)](OUTPUT_DIR)&&fs[a5_0x3be7b3(0x1ae)](OUTPUT_DIR,{'recursive':!![]});const INDEX_FILE=path['join'](OUTPUT_DIR,a5_0x3be7b3(0x18f)),ERROR_LOG_FILE=path[a5_0x3be7b3(0x1c5)](OUTPUT_DIR,a5_0x3be7b3(0x1c2)),bannedKeywords=['Only\x20Fans','onlyfans','porn',a5_0x3be7b3(0x1df),'xxx',a5_0x3be7b3(0x1c3),a5_0x3be7b3(0x226),a5_0x3be7b3(0x1a9),a5_0x3be7b3(0x202),a5_0x3be7b3(0x19f),a5_0x3be7b3(0x1b2),a5_0x3be7b3(0x206),a5_0x3be7b3(0x1d0),a5_0x3be7b3(0x183),a5_0x3be7b3(0x189),'black\x20friday',a5_0x3be7b3(0x239),a5_0x3be7b3(0x20a),a5_0x3be7b3(0x240),a5_0x3be7b3(0x1f1),a5_0x3be7b3(0x245),'boxing\x20day','memorial\x20day\x20sale',a5_0x3be7b3(0x1d3),'holiday\x20sale','holiday\x20deals',a5_0x3be7b3(0x22a),a5_0x3be7b3(0x1f4),a5_0x3be7b3(0x23b),a5_0x3be7b3(0x18d),'clearance\x20sale','flash\x20sale',a5_0x3be7b3(0x258),'door\x20buster',a5_0x3be7b3(0x232),a5_0x3be7b3(0x256),a5_0x3be7b3(0x21f),a5_0x3be7b3(0x262),a5_0x3be7b3(0x219),a5_0x3be7b3(0x20b),a5_0x3be7b3(0x1cf),a5_0x3be7b3(0x24d),a5_0x3be7b3(0x23c),a5_0x3be7b3(0x23a),a5_0x3be7b3(0x1af),a5_0x3be7b3(0x1d5),a5_0x3be7b3(0x20c),a5_0x3be7b3(0x21a),a5_0x3be7b3(0x1c7),a5_0x3be7b3(0x221),a5_0x3be7b3(0x18b),a5_0x3be7b3(0x1b9),a5_0x3be7b3(0x1b0),a5_0x3be7b3(0x224),a5_0x3be7b3(0x1f7),a5_0x3be7b3(0x1e2),'unbeatable\x20price',a5_0x3be7b3(0x213),a5_0x3be7b3(0x24c),a5_0x3be7b3(0x1e9),'best\x20of\x202024',a5_0x3be7b3(0x22d),a5_0x3be7b3(0x1dd),a5_0x3be7b3(0x1a4),a5_0x3be7b3(0x197),a5_0x3be7b3(0x1eb),a5_0x3be7b3(0x24e),a5_0x3be7b3(0x23e),a5_0x3be7b3(0x1fb),a5_0x3be7b3(0x21d),a5_0x3be7b3(0x25d),a5_0x3be7b3(0x1ac),'buy\x20now',a5_0x3be7b3(0x1a2),a5_0x3be7b3(0x1b8),a5_0x3be7b3(0x1f5),a5_0x3be7b3(0x184),a5_0x3be7b3(0x1b7),'checkout','free\x20shipping',a5_0x3be7b3(0x25f),'in\x20stock',a5_0x3be7b3(0x1f9),a5_0x3be7b3(0x237),a5_0x3be7b3(0x19e),a5_0x3be7b3(0x203),a5_0x3be7b3(0x25b),a5_0x3be7b3(0x212),a5_0x3be7b3(0x235),'final\x20hours',a5_0x3be7b3(0x25a),'sponsored\x20post',a5_0x3be7b3(0x1d7),a5_0x3be7b3(0x1ed),'we\x20may\x20earn',a5_0x3be7b3(0x1d1)],bannedPatterns=[/\b\d{1,2}%\s*(off|discount|savings?)\b/i,/\bsave\s+\d{1,2}%/i,/\bup\s+to\s+\d{1,2}%\s*off\b/i,/\bsave\s+\$\d+/i,/\$\d+\s*off\b/i,/\bunder\s+\$\d+/i,/\bjust\s+\$\d+/i,/\bonly\s+\$\d+/i,/\bfrom\s+\$\d+/i,/\bstarting\s+at\s+\$\d+/i,/\bwas\s+\$\d+[,\s]+now\s+\$\d+/i,/\bregularly?\s+\$\d+/i,/\bnormally\s+\$\d+/i,/\b\d+\s+best\s+(deals?|products?|items?|gifts?|picks?|things?|ways?)\b/i,/\bbest\s+\d+\b/i,/\b(today|tonight|this\s+week)\s+only\b/i,/\bends?\s+(soon|today|tonight|tomorrow)\b/i,/\b(hours?|days?|minutes?)\s+left\b/i,/\b(limited\s+)?stock\s+(remaining|left|available)\b/i,/\b(grab|snag|score|get)\s+(this|these|the)\s+deal/i,/\bdeal\s+of\s+the\s+(day|week|month|year)\b/i,/\b(massive|huge|incredible|amazing|insane)\s+(deal|discount|savings?|sale)\b/i,/\b(don't|do\s+not)\s+miss\s+(this|these|out)\b/i];function isPromotionalContent(_0x4f743f){const _0x331d42=a5_0x3be7b3,_0x465a2a=_0x4f743f[_0x331d42(0x195)]();if(bannedKeywords[_0x331d42(0x1cb)](_0x181c72=>_0x465a2a[_0x331d42(0x243)](_0x181c72[_0x331d42(0x195)]())))return!![];if(bannedPatterns[_0x331d42(0x1cb)](_0x15eb19=>_0x15eb19['test'](_0x4f743f)))return!![];return![];}const bannedThumbnails=[a5_0x3be7b3(0x1b3)],phrasesToRemoveFromDescription=[a5_0x3be7b3(0x19d),a5_0x3be7b3(0x22f)],descriptionBylinePatterns=[/^By\s+[A-Z][a-z]+\s+[A-Z][a-z]+(\s+and\s+[A-Z][a-z]+\s+[A-Z][a-z]+)?\s+[A-Z]{2,}.*?\(Reuters\)\s*-?\s*/i,/^By\s+[A-Z][a-z]+\s+[A-Z][a-z]+(\s+and\s+[A-Z][a-z]+\s+[A-Z][a-z]+)?\s+[A-Z]{2,}.*?\(AP\)\s*-?\s*/i,/^By\s+[A-Z][a-z]+\s+[A-Z][a-z]+(\s+and\s+[A-Z][a-z]+\s+[A-Z][a-z]+)?\s+[A-Z]{2,}.*?\(AFP\)\s*-?\s*/i,/^By\s+[A-Z][a-z]+\s+[A-Z][a-z]+\s*/i,/^[A-Z]{2,}[A-Z\s,]+\(Reuters\)\s*-?\s*/i,/^[A-Z]{2,}[A-Z\s,]+\(AP\)\s*-?\s*/i,/^[A-Z]{2,}[A-Z\s,]+\(AFP\)\s*-?\s*/i,/^[A-Z]{3,},?\s+(Jan|Feb|Mar|Apr|May|Jun|Jul|Aug|Sep|Oct|Nov|Dec)\s+\d{1,2}\s+\([^)]+\)\s*-?\s*/i,/^(Jan|Feb|Mar|Apr|May|Jun|Jul|Aug|Sep|Oct|Nov|Dec)\s+\d{1,2}\s+\([^)]+\)\s*-?\s*/i];function cleanDescriptionBylines(_0x3646dc){const _0x296928=a5_0x3be7b3;if(!_0x3646dc)return null;let _0xe76a82=_0x3646dc;for(const _0x1fbe2c of descriptionBylinePatterns){_0xe76a82=_0xe76a82[_0x296928(0x1a6)](_0x1fbe2c,'');}return _0xe76a82[_0x296928(0x1d8)]();}const phrasesToRemoveFromTitle=[a5_0x3be7b3(0x1a0),'Show\x20HN:'],MAX_CONCURRENT_FETCHES=0x5,MAX_ITEMS_PER_SOURCE=0x64;function isRecentItem(_0x425d6d){const _0x4fe15c=a5_0x3be7b3;if(!_0x425d6d[_0x4fe15c(0x263)]&&!_0x425d6d[_0x4fe15c(0x186)])return!![];try{const _0x6e5d3b=new Date(_0x425d6d[_0x4fe15c(0x263)]||_0x425d6d[_0x4fe15c(0x186)]),_0x146479=new Date(),_0x225418=new Date(_0x146479[_0x4fe15c(0x1ef)](),_0x146479[_0x4fe15c(0x1e6)](),_0x146479[_0x4fe15c(0x251)]()),_0x3769f0=new Date(_0x225418);return _0x3769f0[_0x4fe15c(0x252)](_0x3769f0[_0x4fe15c(0x251)]()-0x1),_0x6e5d3b>=_0x3769f0;}catch{return!![];}}function parseArgs(){const _0x235280=a5_0x3be7b3,_0x1787d2=process[_0x235280(0x246)]['slice'](0x2);let _0x429629=null,_0x3872f7=null,_0x4201c1=![];for(const _0x588e2a of _0x1787d2){if(_0x588e2a[_0x235280(0x21e)](_0x235280(0x234)))_0x429629=parseInt(_0x588e2a['split']('=')[0x1],0xa);else{if(_0x588e2a[_0x235280(0x21e)]('--total-batches='))_0x3872f7=parseInt(_0x588e2a[_0x235280(0x1ec)]('=')[0x1],0xa);else _0x588e2a===_0x235280(0x1ca)&&(_0x4201c1=!![]);}}return{'batch':_0x429629,'totalBatches':_0x3872f7,'test':_0x4201c1};}function cleanCdata(_0x38ee93){const _0x20105c=a5_0x3be7b3;return _0x38ee93[_0x20105c(0x1a6)](/<!\[CDATA\[|\]\]>/g,'')[_0x20105c(0x1d8)]();}function stripHtml(_0x59620a){const _0x2a4fa6=a5_0x3be7b3;return(0x0,node_html_parser_1[_0x2a4fa6(0x230)])(_0x59620a)['textContent']||'';}function removePhrases(_0x42e9bb,_0x34266a){const _0x3a4649=a5_0x3be7b3;if(!_0x42e9bb)return null;let _0x527e9f=_0x42e9bb;for(const _0x473597 of _0x34266a){_0x527e9f=_0x527e9f[_0x3a4649(0x1a6)](_0x473597,'')['trim']();}return _0x527e9f;}function truncateDescription(_0x167c84){const _0x4ea603=a5_0x3be7b3;if(!_0x167c84)return null;const _0x3c4068=_0x167c84[_0x4ea603(0x1ec)](/\n\s*\n/);let _0x1754fc=_0x3c4068[0x0]||'';const _0x24b2c0=_0x1754fc[_0x4ea603(0x1bf)](/[^.!?]+[.!?]+|[^.!?]+$/g)||[];_0x24b2c0[_0x4ea603(0x259)]>0x5?_0x1754fc=_0x24b2c0['slice'](0x0,0x5)[_0x4ea603(0x1c5)]('')[_0x4ea603(0x1d8)]():_0x1754fc=_0x24b2c0['join']('')['trim']();if(_0x1754fc['length']<_0x167c84[_0x4ea603(0x259)]&&!/[.!?]$/['test'](_0x1754fc)){const _0x1afd4a=_0x1754fc['lastIndexOf']('\x20');_0x1afd4a>-0x1?_0x1754fc=_0x1754fc[_0x4ea603(0x261)](0x0,_0x1afd4a)+_0x4ea603(0x1e1):_0x1754fc=_0x1754fc+'...';}return _0x1754fc['length']>0x0?_0x1754fc:null;}function a5_0x5d6f(){const _0x3a83a9=['we\x20reviewed','hasOwnProperty','prime\x20week','stringify','./article-extractor','includes','3978856CaZOEI','singles\x20day','argv','https://www.investing.com/rss/news.rss','default','extractArticle','215736xoSZaO','link','budget\x20friendly','deal\x20of\x20the\x20day','we\x20tested','fulfilled','__importStar','getDate','setDate','call','create','Scrape\x20finished.\x20Added\x20','limited\x20time\x20deal','getOwnPropertyNames','doorbuster','length','affiliate\x20link','act\x20fast','has','holiday\x20gift','href','fast\x20shipping','log','substring','top\x20deals','pubDate','Form\x20144','grab\x20it\x20now','rss-parser','isoDate','status','Fetch\x20failed','SEC\x20filing','10105936LmppEc','save\x20big','Batch\x20','year\x20end\x20sale','fullText','index.json','text/html,application/xhtml+xml','name','2102112vrZccj','‚è≠Ô∏è\x20Batch\x20','addPost','toLowerCase','üîÑ\x20Batch\x20','editors\x20choice','HEAD','\x20|\x20Processing\x20sources\x20','flush','Starting\x20Aggregation\x20&\x20Classification...','\x20new\x20|\x20','(Source:\x20Bloomberg)','selling\x20out','slot\x20machine','Tell\x20HN:','./bucket-manager','shop\x20now','getAttribute','our\x20picks','\x20complete\x20in\x20','replace','[Filter]\x20Blocked\x20by\x20content\x20check:\x20','__createBinding','gambling','node-html-parser','keywords','gift\x20ideas','now','mkdirSync','price\x20cut','massive\x20discount','prototype','sports\x20betting','https://s.yimg.com/cv/apiv2/social/images/yahoo_default_logo-1200x1200.png','existsSync','enclosure','description','add\x20to\x20cart','order\x20now','huge\x20savings','lastIndexOf','thumbnail_url','width','post-','media:thumbnail','match','getOwnPropertyDescriptor','376784gUukzM','error-log.json','sex\x20tape','topic','join','Feed\x20fetch\x20failed','voucher\x20code','s.\x20Classification\x20will\x20run\x20in\x20merge\x20step.','url','--test','some','push','then','Processing\x20source:\x20','hot\x20deals','Form\x2013G','as\x20an\x20amazon\x20associate','writeFileSync','labor\x20day\x20sale','\x20sources).\x20Skipping.','discount\x20code','init','paid\x20partnership','trim','Error\x20reading\x20index\x20file,\x20starting\x20fresh.','min','p\x20a','\x20old\x20(filtered)','top\x20picks','\x20of\x20','pornography','classify','...','price\x20match','\x20posts.','content:encoded','message','getMonth','headers','Job\x20Complete\x20in\x20','affordable\x20pick','media:content','staff\x20picks','split','we\x20earn\x20commission','sourcesData','getFullYear','title','amazon\x20prime\x20day','items','../output','christmas\x20deals','get\x20it\x20now','5345AOffgn','best\x20price','contentSnippet','back\x20in\x20stock','\x20\x20Skipped\x20duplicate:\x20','buying\x20guide','./sources','utf-8','ceil','1857356XSTzzV','__setModuleDefault','error','casino','hurry','toISOString','meta[property=\x22og:description\x22]','Form\x2013F','meta[name=\x22twitter:image\x22]','sort','Starting\x20job...','prime\x20day','daily\x20deals','coupon\x20code','toFixed','meta[name=\x22description\x22]','catch','HTTP\x20error!\x20status:\x20','text','dont\x20miss','budget\x20pick','BucketManager','‚ö†Ô∏è\x20RUNNING\x20IN\x20TEST\x20MODE:\x20Limiting\x20to\x201\x20source\x20and\x2010\x20items.','content','qualityScore','news','deals\x20today','promo\x20code','Article\x20URL:','content-length','gift\x20guide','startsWith','best\x20deals','readFileSync','save\x20money','1602CeeMMd','__esModule','lowest\x20price','\x20items.','nsfw','get','map','filter','christmas\x20sale','https://rss.slashdot.org/Slashdot/slashdot','Error\x20fetching\x20source\x20','best\x20of\x202025','parseURL','Read\x20more\x20of\x20this\x20story\x20at\x20Slashdot.','parse','add','limited\x20time\x20offer','from','--batch=','last\x20chance','\x20cached\x20|\x20','selling\x20fast','race','cyber\x20monday','price\x20drop','end\x20of\x20year\x20sale','deal\x20alert','slice'];a5_0x5d6f=function(){return _0x3a83a9;};return a5_0x5d6f();}async function isImageLargeEnough(_0x22bd97){const _0x973307=a5_0x3be7b3;try{const _0x3ffbe3=await fetch(_0x22bd97,{'method':_0x973307(0x198),'signal':AbortSignal['timeout'](0x7d0)});if(!_0x3ffbe3['ok']){if(_0x3ffbe3[_0x973307(0x187)]===0x194)return![];return!![];}const _0x5a2916=_0x3ffbe3[_0x973307(0x1e7)]['get'](_0x973307(0x21c));if(_0x5a2916){const _0x35069e=parseInt(_0x5a2916,0xa);if(_0x35069e<0x3a98)return![];}return!![];}catch{return!![];}}async function fetchArticleMetadata(_0x2616fe){const _0x19a67e=a5_0x3be7b3;try{const _0x1e0d64=await fetch(_0x2616fe,{'signal':AbortSignal['timeout'](0x3a98),'headers':{'User-Agent':'Mozilla/5.0\x20(compatible;\x20NewsBot/1.0)','Accept':_0x19a67e(0x190)}});if(!_0x1e0d64['ok'])throw new Error(_0x19a67e(0x210)+_0x1e0d64[_0x19a67e(0x187)]);const _0x4f4ec1=await _0x1e0d64[_0x19a67e(0x211)](),_0x1dcf75=(0x0,node_html_parser_1[_0x19a67e(0x230)])(_0x4f4ec1);let _0x2748d6=null;const _0xd18e0c=[_0x19a67e(0x205),'meta[name=\x22twitter:description\x22]',_0x19a67e(0x20e)];for(const _0x48ab31 of _0xd18e0c){const _0x54cb15=_0x1dcf75['querySelector'](_0x48ab31);if(_0x54cb15&&_0x54cb15[_0x19a67e(0x1a3)](_0x19a67e(0x216))){_0x2748d6=stripHtml(_0x54cb15[_0x19a67e(0x1a3)](_0x19a67e(0x216)))||null,_0x2748d6=removePhrases(_0x2748d6,phrasesToRemoveFromDescription),_0x2748d6=cleanDescriptionBylines(_0x2748d6),_0x2748d6=truncateDescription(_0x2748d6);break;}}let _0x1bc1f2=null;const _0x5bbfd2=['meta[property=\x22og:image\x22]',_0x19a67e(0x207)];for(const _0x289c68 of _0x5bbfd2){const _0x31c7ce=_0x1dcf75['querySelector'](_0x289c68);if(_0x31c7ce&&_0x31c7ce[_0x19a67e(0x1a3)]('content')){_0x1bc1f2=_0x31c7ce[_0x19a67e(0x1a3)](_0x19a67e(0x216));break;}}return{'description':_0x2748d6,'thumbnail_url':_0x1bc1f2,'html':_0x4f4ec1};}catch{return{'description':null,'thumbnail_url':null,'html':null};}}let errorLog=[];function logError(_0x45e0a0,_0x2df457,_0x5c483c){const _0x15532d=a5_0x3be7b3;errorLog['push']({'source':_0x45e0a0,'url':_0x2df457,'error':_0x5c483c,'timestamp':new Date()[_0x15532d(0x204)]()});}function saveErrorLog(){const _0xaf7a49=a5_0x3be7b3;if(errorLog[_0xaf7a49(0x259)]===0x0)return;let _0x2cd9cb=[];if(fs[_0xaf7a49(0x1b4)](ERROR_LOG_FILE))try{_0x2cd9cb=JSON['parse'](fs['readFileSync'](ERROR_LOG_FILE,_0xaf7a49(0x1fd)));}catch{}const _0x70eafd=[..._0x2cd9cb,...errorLog]['slice'](-0x64);fs[_0xaf7a49(0x1d2)](ERROR_LOG_FILE,JSON[_0xaf7a49(0x241)](_0x70eafd,null,0x2),_0xaf7a49(0x1fd));}async function processItem(_0x11d613,_0xb47cb1){const _0x1c83f7=a5_0x3be7b3;let _0x58cdea=_0x11d613[_0x1c83f7(0x1f0)]?stripHtml(cleanCdata(_0x11d613[_0x1c83f7(0x1f0)])):null;_0x58cdea=removePhrases(_0x58cdea,phrasesToRemoveFromTitle);let _0x5ec4a4=_0x11d613[_0x1c83f7(0x24b)],_0x5b978e=null;if(_0xb47cb1[_0x1c83f7(0x1c9)][_0x1c83f7(0x243)]('hnrss.org')){if(_0x11d613['content']){const _0x26d629=(0x0,node_html_parser_1[_0x1c83f7(0x230)])(_0x11d613[_0x1c83f7(0x216)]),_0x342d39=_0x26d629['querySelector'](_0x1c83f7(0x1db));_0x342d39&&_0x342d39[_0x1c83f7(0x211)][_0x1c83f7(0x21e)](_0x1c83f7(0x21b))&&(_0x5ec4a4=_0x342d39[_0x1c83f7(0x1a3)](_0x1c83f7(0x25e)));}_0x5b978e=null;}else _0x11d613[_0x1c83f7(0x1f8)]&&(_0x5b978e=stripHtml(cleanCdata(_0x11d613[_0x1c83f7(0x1f8)]))||null,_0x5b978e=removePhrases(_0x5b978e,phrasesToRemoveFromDescription),_0x5b978e=cleanDescriptionBylines(_0x5b978e),_0x5b978e=truncateDescription(_0x5b978e));!_0x5b978e&&_0x11d613[_0x1c83f7(0x1e4)]&&(_0x5b978e=stripHtml(cleanCdata(_0x11d613['content:encoded']))||null,_0x5b978e=removePhrases(_0x5b978e,phrasesToRemoveFromDescription),_0x5b978e=cleanDescriptionBylines(_0x5b978e),_0x5b978e=truncateDescription(_0x5b978e));_0xb47cb1[_0x1c83f7(0x1c9)]===_0x1c83f7(0x22b)&&_0x11d613[_0x1c83f7(0x1b6)]&&(_0x5b978e=stripHtml(cleanCdata(_0x11d613[_0x1c83f7(0x1b6)]))||null,_0x5b978e=removePhrases(_0x5b978e,phrasesToRemoveFromDescription),_0x5b978e=cleanDescriptionBylines(_0x5b978e),_0x5b978e=truncateDescription(_0x5b978e));if(!_0x58cdea||!_0x5ec4a4)return null;const _0x26ccf6=_0x58cdea+'\x20'+(_0x11d613[_0x1c83f7(0x1f8)]?stripHtml(_0x11d613['contentSnippet']):'')+'\x20'+(_0x11d613[_0x1c83f7(0x1b6)]?stripHtml(_0x11d613[_0x1c83f7(0x1b6)]):'');if(isPromotionalContent(_0x26ccf6))return null;let _0x3372fe=_0x11d613['enclosure']?_0x11d613[_0x1c83f7(0x1b5)][_0x1c83f7(0x1c9)]:null;if(_0x11d613[_0x1c83f7(0x1ea)]){if(Array['isArray'](_0x11d613[_0x1c83f7(0x1ea)])){const _0x129a92=_0x11d613['media:content'][_0x1c83f7(0x208)]((_0x3cd0f6,_0x4377fa)=>{const _0x409f40=_0x1c83f7,_0xd68d6c=_0x3cd0f6['$']&&_0x3cd0f6['$']['width']?parseInt(_0x3cd0f6['$'][_0x409f40(0x1bc)],0xa):0x0,_0x5674cc=_0x4377fa['$']&&_0x4377fa['$'][_0x409f40(0x1bc)]?parseInt(_0x4377fa['$']['width'],0xa):0x0;return _0x5674cc-_0xd68d6c;}),_0x3bd204=_0x129a92[0x0];if(_0x3bd204){const _0x1e2130=_0x3bd204['$']&&_0x3bd204['$'][_0x1c83f7(0x1bc)]?parseInt(_0x3bd204['$'][_0x1c83f7(0x1bc)],0xa):0x0;if(_0x1e2130===0x0||_0x1e2130>=0x12c){if(_0x3bd204['$']&&_0x3bd204['$']['url'])_0x3372fe=_0x3bd204['$'][_0x1c83f7(0x1c9)];else{if(_0x3bd204[_0x1c83f7(0x1c9)])_0x3372fe=_0x3bd204['url'];}}}}else{const _0x1ca797=_0x11d613[_0x1c83f7(0x1ea)],_0x4e3b76=_0x1ca797['$']&&_0x1ca797['$'][_0x1c83f7(0x1bc)]?parseInt(_0x1ca797['$'][_0x1c83f7(0x1bc)],0xa):_0x1ca797[_0x1c83f7(0x1bc)]?parseInt(_0x1ca797[_0x1c83f7(0x1bc)],0xa):0x0;if(_0x4e3b76===0x0||_0x4e3b76>=0x12c){if(_0x1ca797['$']&&_0x1ca797['$'][_0x1c83f7(0x1c9)])_0x3372fe=_0x1ca797['$'][_0x1c83f7(0x1c9)];else{if(_0x1ca797[_0x1c83f7(0x1c9)])_0x3372fe=_0x1ca797[_0x1c83f7(0x1c9)];}}}}if(!_0x3372fe&&_0x11d613['media:thumbnail']){if(_0x11d613[_0x1c83f7(0x1be)]['$']&&_0x11d613[_0x1c83f7(0x1be)]['$'][_0x1c83f7(0x1c9)])_0x3372fe=_0x11d613['media:thumbnail']['$'][_0x1c83f7(0x1c9)];else _0x11d613[_0x1c83f7(0x1be)][_0x1c83f7(0x1c9)]&&(_0x3372fe=_0x11d613[_0x1c83f7(0x1be)][_0x1c83f7(0x1c9)]);}_0x3372fe&&bannedThumbnails['includes'](_0x3372fe)&&(_0x3372fe=null);let _0x35731a=null,_0x13c87f={'fullText':null,'readingTime':0x0,'keywords':[],'qualityScore':0x0};const _0x2877fe=!_0x5b978e||!_0x3372fe||_0xb47cb1['url'][_0x1c83f7(0x243)]('hnrss.org')||_0xb47cb1[_0x1c83f7(0x1c9)]===_0x1c83f7(0x22b)||_0xb47cb1[_0x1c83f7(0x1c9)]===_0x1c83f7(0x247);try{const _0x435d9c=await fetchArticleMetadata(_0x5ec4a4);_0x35731a=_0x435d9c['html'],!_0x5b978e&&(_0x5b978e=_0x435d9c['description']),!_0x3372fe&&(_0x3372fe=_0x435d9c[_0x1c83f7(0x1bb)]);}catch(_0x21538b){logError(_0xb47cb1[_0x1c83f7(0x191)],_0x5ec4a4,_0x21538b[_0x1c83f7(0x1e5)]||_0x1c83f7(0x188));}if(_0x35731a){_0x13c87f=(0x0,article_extractor_1[_0x1c83f7(0x249)])(_0x35731a,_0x5ec4a4);if(_0x13c87f[_0x1c83f7(0x18e)]&&isPromotionalContent(_0x13c87f[_0x1c83f7(0x18e)]))return console['log'](_0x1c83f7(0x1a7)+_0x58cdea),null;}_0x3372fe&&bannedThumbnails[_0x1c83f7(0x243)](_0x3372fe)&&(_0x3372fe=null);if(_0x3372fe){const _0x23cdef=await isImageLargeEnough(_0x3372fe);!_0x23cdef&&(_0x3372fe=null);}if(!_0x3372fe)return null;const _0x338651=_0x58cdea['toLowerCase']()[_0x1c83f7(0x1a6)](/[^a-z0-9\s]/g,'')[_0x1c83f7(0x1d8)]()['replace'](/\s+/g,'-');let _0x12eca9=_0x338651[_0x1c83f7(0x261)](0x0,0x78);if(_0x338651[_0x1c83f7(0x259)]>0x78){const _0xab9524=_0x12eca9[_0x1c83f7(0x1ba)]('-');_0xab9524>0x0&&(_0x12eca9=_0x12eca9['substring'](0x0,_0xab9524));}_0x12eca9=_0x12eca9[_0x1c83f7(0x1a6)](/-+$/,'');!_0x12eca9&&(_0x12eca9=_0x1c83f7(0x1bd)+Date[_0x1c83f7(0x1ad)]());const _0x4fe7c5=(0x0,sources_1['resolveTopicFromUrl'])(_0x5ec4a4,_0xb47cb1[_0x1c83f7(0x191)],_0xb47cb1[_0x1c83f7(0x1c4)]||_0x1c83f7(0x218));return{'slug':_0x12eca9,'title':_0x58cdea,'description':_0x5b978e,'fullText':_0x13c87f['fullText'],'readingTime':_0x13c87f['readingTime'],'keywords':_0x13c87f[_0x1c83f7(0x1ab)],'qualityScore':_0x13c87f[_0x1c83f7(0x217)],'link':_0x5ec4a4,'thumbnail_url':_0x3372fe,'created_at':new Date()[_0x1c83f7(0x204)](),'topic':_0x4fe7c5};}async function processInParallel(_0x1959ad,_0x5a1af5,_0x2518f5){const _0x590eab=a5_0x3be7b3,_0x1d7606=[],_0x3c4882=[];for(const _0x47cdcd of _0x1959ad){const _0x547ebb=_0x5a1af5(_0x47cdcd)['then'](_0x99ad8d=>{const _0x3b2991=a5_0x4c19;_0x1d7606[_0x3b2991(0x1cc)](_0x99ad8d);})[_0x590eab(0x20f)](()=>{_0x1d7606['push'](null);});_0x3c4882[_0x590eab(0x1cc)](_0x547ebb);if(_0x3c4882[_0x590eab(0x259)]>=_0x2518f5){await Promise[_0x590eab(0x238)](_0x3c4882);const _0x14c1dd=_0x3c4882[_0x590eab(0x229)](_0x1b875d=>{const _0x1b5b52=_0x590eab;let _0x445ceb=![];return _0x1b875d[_0x1b5b52(0x1cd)](()=>{_0x445ceb=!![];})['catch'](()=>{_0x445ceb=!![];}),!_0x445ceb;});_0x3c4882['length']=0x0,_0x3c4882[_0x590eab(0x1cc)](..._0x14c1dd);}}return await Promise['all'](_0x3c4882),_0x1d7606;}async function processBatch(_0x493488,_0x112964,_0x5eb3e5=MAX_CONCURRENT_FETCHES){const _0x39216f=a5_0x3be7b3,_0x443e86=[];for(let _0x565ae5=0x0;_0x565ae5<_0x493488[_0x39216f(0x259)];_0x565ae5+=_0x5eb3e5){const _0x23f60e=_0x493488['slice'](_0x565ae5,_0x565ae5+_0x5eb3e5),_0x1670a5=await Promise['allSettled'](_0x23f60e[_0x39216f(0x228)](_0x9dbc48=>_0x112964(_0x9dbc48)));for(const _0x2e7ad4 of _0x1670a5){_0x2e7ad4[_0x39216f(0x187)]===_0x39216f(0x24f)?_0x443e86['push'](_0x2e7ad4['value']):_0x443e86[_0x39216f(0x1cc)](null);}}return _0x443e86;}async function run(){const _0x584e4d=a5_0x3be7b3,{batch:_0xfdf9c4,totalBatches:_0x476983,test:_0x62e37f}=parseArgs();console[_0x584e4d(0x260)](_0x584e4d(0x209));_0xfdf9c4!==null&&_0x476983!==null&&console[_0x584e4d(0x260)]('Running\x20batch\x20'+(_0xfdf9c4+0x1)+_0x584e4d(0x1de)+_0x476983);const _0x5c0c18=Date['now'](),_0x1c477b=new Date()['toISOString']()[_0x584e4d(0x1ec)]('T')[0x0],_0x47a2d9=path['join'](OUTPUT_DIR,_0x1c477b+'.json');let _0x2ab384=[];if(fs[_0x584e4d(0x1b4)](INDEX_FILE))try{_0x2ab384=JSON[_0x584e4d(0x230)](fs[_0x584e4d(0x220)](INDEX_FILE,_0x584e4d(0x1fd)));}catch{console['error'](_0x584e4d(0x1d9));}const _0x3e037c=new Set(_0x2ab384),_0x1980c9=new Set();let _0x166e55=[];if(fs[_0x584e4d(0x1b4)](_0x47a2d9))try{_0x166e55=JSON[_0x584e4d(0x230)](fs[_0x584e4d(0x220)](_0x47a2d9,_0x584e4d(0x1fd)));for(const _0x1c97f8 of _0x166e55){_0x1c97f8[_0x584e4d(0x18e)]&&_0x1980c9[_0x584e4d(0x231)](_0x1c97f8[_0x584e4d(0x18e)][_0x584e4d(0x261)](0x0,0x64));}}catch{console[_0x584e4d(0x201)]('Error\x20reading\x20daily\x20file,\x20starting\x20fresh.');}let _0x58f080=[...sources_1[_0x584e4d(0x1ee)]],_0x5be50f=null;if(_0x62e37f)console[_0x584e4d(0x260)](_0x584e4d(0x215)),_0x58f080=sources_1[_0x584e4d(0x1ee)][_0x584e4d(0x23d)](0x0,0x1),_0x5be50f=0xa;else{if(_0xfdf9c4!==null&&_0x476983!==null){const _0x1d9e1d=0x5,_0x53f523=Math[_0x584e4d(0x1da)](_0x476983,Math['max'](0x1,Math['ceil'](sources_1[_0x584e4d(0x1ee)]['length']/_0x1d9e1d)));if(_0xfdf9c4>=_0x53f523){console[_0x584e4d(0x260)](_0x584e4d(0x193)+(_0xfdf9c4+0x1)+'\x20not\x20needed\x20(only\x20'+_0x53f523+'\x20batches\x20required\x20for\x20'+sources_1['sourcesData'][_0x584e4d(0x259)]+_0x584e4d(0x1d4));return;}const _0x3e24bc=Math[_0x584e4d(0x1fe)](sources_1[_0x584e4d(0x1ee)][_0x584e4d(0x259)]/_0x53f523),_0x3312b2=_0xfdf9c4*_0x3e24bc,_0x2364aa=Math['min'](_0x3312b2+_0x3e24bc,sources_1['sourcesData']['length']);_0x58f080=sources_1[_0x584e4d(0x1ee)][_0x584e4d(0x23d)](_0x3312b2,_0x2364aa),console[_0x584e4d(0x260)](_0x584e4d(0x196)+(_0xfdf9c4+0x1)+'/'+_0x53f523+_0x584e4d(0x199)+(_0x3312b2+0x1)+'-'+_0x2364aa+_0x584e4d(0x1de)+sources_1[_0x584e4d(0x1ee)][_0x584e4d(0x259)]);}}let _0x4e51d7=0x0;for(const _0x2c44b2 of _0x58f080){console[_0x584e4d(0x260)](_0x584e4d(0x1ce)+_0x2c44b2[_0x584e4d(0x191)]);try{const _0x33d409=await parser[_0x584e4d(0x22e)](_0x2c44b2[_0x584e4d(0x1c9)]),_0x3c227f=_0x5be50f||MAX_ITEMS_PER_SOURCE,_0x7b7be2=_0x33d409[_0x584e4d(0x1f2)]['filter'](isRecentItem)[_0x584e4d(0x23d)](0x0,_0x3c227f),_0x2751ac=_0x33d409[_0x584e4d(0x1f2)][_0x584e4d(0x259)]-_0x7b7be2[_0x584e4d(0x259)]-(_0x33d409['items']['length']>_0x3c227f?_0x33d409[_0x584e4d(0x1f2)][_0x584e4d(0x259)]-_0x3c227f:0x0),_0x4f8130=_0x7b7be2[_0x584e4d(0x229)](_0x813f92=>{const _0x12d54d=_0x813f92['link'];return _0x12d54d&&!_0x3e037c['has'](_0x12d54d);}),_0x4a0111=_0x7b7be2['length']-_0x4f8130[_0x584e4d(0x259)];console['log']('\x20\x20'+_0x4f8130[_0x584e4d(0x259)]+_0x584e4d(0x19c)+_0x4a0111+_0x584e4d(0x236)+_0x2751ac+_0x584e4d(0x1dc));const _0x2d81a6=await processBatch(_0x4f8130,_0x263fee=>processItem(_0x263fee,_0x2c44b2),MAX_CONCURRENT_FETCHES);for(const _0x52d69e of _0x2d81a6){if(_0x52d69e&&_0x52d69e[_0x584e4d(0x24b)]){if(_0x52d69e[_0x584e4d(0x18e)]){const _0x17aa5b=_0x52d69e['fullText'][_0x584e4d(0x261)](0x0,0x64);if(_0x1980c9[_0x584e4d(0x25c)](_0x17aa5b)){console[_0x584e4d(0x260)](_0x584e4d(0x1fa)+_0x52d69e[_0x584e4d(0x1f0)]['substring'](0x0,0x28)+_0x584e4d(0x1e1));continue;}_0x1980c9[_0x584e4d(0x231)](_0x17aa5b);}_0x166e55[_0x584e4d(0x1cc)](_0x52d69e),_0x3e037c[_0x584e4d(0x231)](_0x52d69e[_0x584e4d(0x24b)]),_0x4e51d7++;}}}catch(_0x55c9e6){console['error'](_0x584e4d(0x22c)+_0x2c44b2[_0x584e4d(0x191)]+':',_0x55c9e6[_0x584e4d(0x1e5)]),logError(_0x2c44b2['name'],_0x2c44b2[_0x584e4d(0x1c9)],_0x55c9e6['message']||_0x584e4d(0x1c6));}}fs[_0x584e4d(0x1d2)](_0x47a2d9,JSON['stringify'](_0x166e55,null,0x2),'utf-8'),fs[_0x584e4d(0x1d2)](INDEX_FILE,JSON[_0x584e4d(0x241)](Array[_0x584e4d(0x233)](_0x3e037c),null,0x2),_0x584e4d(0x1fd)),saveErrorLog(),console[_0x584e4d(0x260)](_0x584e4d(0x255)+_0x4e51d7+_0x584e4d(0x225));if(_0xfdf9c4===null){console[_0x584e4d(0x260)](_0x584e4d(0x19b));const _0x341309=new classifier_1['Classifier'](),_0x1b4314=new bucket_manager_1[(_0x584e4d(0x214))](OUTPUT_DIR);await _0x1b4314[_0x584e4d(0x1d6)]();let _0x50ec6c=0x0;for(const _0x267f11 of _0x166e55){const _0xc7847f=_0x341309[_0x584e4d(0x1e0)](_0x267f11[_0x584e4d(0x1f0)],_0x267f11[_0x584e4d(0x1b6)]);if(_0xc7847f[_0x584e4d(0x259)]>0x0){for(const _0xfbd038 of _0xc7847f){_0x1b4314[_0x584e4d(0x194)](_0x267f11,_0xfbd038);}_0x50ec6c++;}}await _0x1b4314[_0x584e4d(0x19a)]();const _0x190e43=Date[_0x584e4d(0x1ad)]();console[_0x584e4d(0x260)](_0x584e4d(0x1e8)+((_0x190e43-_0x5c0c18)/0x3e8)[_0x584e4d(0x20d)](0x2)+'s.\x20Classified\x20'+_0x50ec6c+_0x584e4d(0x1e3));}else{const _0x389c36=Date[_0x584e4d(0x1ad)]();console[_0x584e4d(0x260)](_0x584e4d(0x18c)+_0xfdf9c4+_0x584e4d(0x1a5)+((_0x389c36-_0x5c0c18)/0x3e8)[_0x584e4d(0x20d)](0x2)+_0x584e4d(0x1c8));}}run()[a5_0x3be7b3(0x20f)](console['error']);
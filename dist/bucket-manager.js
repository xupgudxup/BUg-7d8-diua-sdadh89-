'use strict';const a1_0x2ff153=a1_0x5030;(function(_0x2c741e,_0x212400){const _0xba6395=a1_0x5030,_0x7096ee=_0x2c741e();while(!![]){try{const _0x2ed9b4=-parseInt(_0xba6395(0x1ee))/0x1+parseInt(_0xba6395(0x1ec))/0x2*(-parseInt(_0xba6395(0x1de))/0x3)+parseInt(_0xba6395(0x1ea))/0x4*(-parseInt(_0xba6395(0x1f2))/0x5)+parseInt(_0xba6395(0x1d8))/0x6*(-parseInt(_0xba6395(0x1cd))/0x7)+-parseInt(_0xba6395(0x1d3))/0x8+parseInt(_0xba6395(0x1f5))/0x9*(parseInt(_0xba6395(0x1d5))/0xa)+parseInt(_0xba6395(0x206))/0xb;if(_0x2ed9b4===_0x212400)break;else _0x7096ee['push'](_0x7096ee['shift']());}catch(_0x4b967e){_0x7096ee['push'](_0x7096ee['shift']());}}}(a1_0x2e8e,0xa3423));function a1_0x5030(_0x4ec66b,_0x19c354){const _0x2e8eec=a1_0x2e8e();return a1_0x5030=function(_0x50304d,_0x305063){_0x50304d=_0x50304d-0x1ca;let _0x5ea7b2=_0x2e8eec[_0x50304d];return _0x5ea7b2;},a1_0x5030(_0x4ec66b,_0x19c354);}var __createBinding=this&&this['__createBinding']||(Object[a1_0x2ff153(0x1cf)]?function(_0x5ccde1,_0x41c0a7,_0x46bec9,_0x13465c){const _0x531ae7=a1_0x2ff153;if(_0x13465c===undefined)_0x13465c=_0x46bec9;var _0xc74fa3=Object['getOwnPropertyDescriptor'](_0x41c0a7,_0x46bec9);(!_0xc74fa3||(_0x531ae7(0x1e4)in _0xc74fa3?!_0x41c0a7[_0x531ae7(0x1f7)]:_0xc74fa3['writable']||_0xc74fa3[_0x531ae7(0x1f8)]))&&(_0xc74fa3={'enumerable':!![],'get':function(){return _0x41c0a7[_0x46bec9];}}),Object[_0x531ae7(0x1dd)](_0x5ccde1,_0x13465c,_0xc74fa3);}:function(_0x596615,_0x27ef58,_0x3dfbd7,_0x255fbd){if(_0x255fbd===undefined)_0x255fbd=_0x3dfbd7;_0x596615[_0x255fbd]=_0x27ef58[_0x3dfbd7];}),__setModuleDefault=this&&this['__setModuleDefault']||(Object['create']?function(_0x511a60,_0xf73f1f){const _0x561321=a1_0x2ff153;Object['defineProperty'](_0x511a60,_0x561321(0x1ca),{'enumerable':!![],'value':_0xf73f1f});}:function(_0x6df1f5,_0x429cde){const _0x3f2086=a1_0x2ff153;_0x6df1f5[_0x3f2086(0x1ca)]=_0x429cde;}),__importStar=this&&this['__importStar']||(function(){var _0x557186=function(_0x5c291f){const _0x195ad9=a1_0x5030;return _0x557186=Object[_0x195ad9(0x20b)]||function(_0x24de81){const _0x7c6682=_0x195ad9;var _0x58b11a=[];for(var _0x9e6a96 in _0x24de81)if(Object['prototype'][_0x7c6682(0x200)][_0x7c6682(0x1f0)](_0x24de81,_0x9e6a96))_0x58b11a[_0x58b11a[_0x7c6682(0x20a)]]=_0x9e6a96;return _0x58b11a;},_0x557186(_0x5c291f);};return function(_0x414899){const _0x1491cf=a1_0x5030;if(_0x414899&&_0x414899[_0x1491cf(0x1f7)])return _0x414899;var _0x428e8d={};if(_0x414899!=null){for(var _0x6437af=_0x557186(_0x414899),_0x3996f8=0x0;_0x3996f8<_0x6437af[_0x1491cf(0x20a)];_0x3996f8++)if(_0x6437af[_0x3996f8]!==_0x1491cf(0x1ca))__createBinding(_0x428e8d,_0x414899,_0x6437af[_0x3996f8]);}return __setModuleDefault(_0x428e8d,_0x414899),_0x428e8d;};}());function a1_0x2e8e(){const _0xcc9d60=['toISOString','call','some','93890utsQnQ','set','\x0a</sitemapindex>','27bWZRww','map','__esModule','configurable','category','generateSitemap','</lastmod>\x0a\x20\x20\x20\x20<changefreq>daily</changefreq>\x0a\x20\x20</url>','stringify','<?xml\x20version=\x221.0\x22\x20encoding=\x22UTF-8\x22?>\x0a<urlset\x20xmlns=\x22http://www.sitemaps.org/schemas/sitemap/0.9\x22>\x0a','sitemaps','slug','hasOwnProperty','sort','sitemapsDir','flat','Flushing\x20buckets...','keys','39052981dwoFzU','now','<?xml\x20version=\x221.0\x22\x20encoding=\x22UTF-8\x22?>\x0a<sitemapindex\x20xmlns=\x22http://www.sitemaps.org/schemas/sitemap/0.9\x22>\x0a','join','length','getOwnPropertyNames','params','mkdirSync','BucketManager','generateSitemapIndex','\x20\x20<sitemap>\x0a\x20\x20\x20\x20<loc>','getTime','.xml</loc>\x0a\x20\x20\x20\x20<lastmod>','.json','manifestsDir','default','manifest','</loc>\x0a\x20\x20\x20\x20<lastmod>','56KdtHJp','values','create','dataDir','addPost','entries','9396840sjJwrb','existsSync','3421120HOGWCV','\x20\x20<url>\x0a\x20\x20\x20\x20<loc>','manifests','646278DQkveR','writeFileSync','push','path','split','defineProperty','3jITgvy','baseUrl','manifest.json','log','link','buckets','get','\x0a</urlset>','created_at','outputDir','flush','data','136kMyUzq','has','1038926JlAJPQ','readFileSync','713676PQaDbp'];a1_0x2e8e=function(){return _0xcc9d60;};return a1_0x2e8e();}Object['defineProperty'](exports,a1_0x2ff153(0x1f7),{'value':!![]}),exports[a1_0x2ff153(0x20e)]=void 0x0;const fs=__importStar(require('fs')),path=__importStar(require(a1_0x2ff153(0x1db)));class BucketManager{constructor(_0x1e3fde){const _0x48dae2=a1_0x2ff153;this['buckets']=new Map(),this[_0x48dae2(0x1cb)]=[],this[_0x48dae2(0x1df)]='https://headlined.app',this['outputDir']=_0x1e3fde,this[_0x48dae2(0x1d0)]=path[_0x48dae2(0x209)](_0x1e3fde,_0x48dae2(0x1e9)),this['manifestsDir']=path[_0x48dae2(0x209)](_0x1e3fde,_0x48dae2(0x1d7)),this[_0x48dae2(0x202)]=path[_0x48dae2(0x209)](_0x1e3fde,_0x48dae2(0x1fe));}async['init'](){const _0x323270=a1_0x2ff153;if(!fs['existsSync'](this[_0x323270(0x1d0)]))fs[_0x323270(0x20d)](this[_0x323270(0x1d0)],{'recursive':!![]});if(!fs[_0x323270(0x1d4)](this[_0x323270(0x214)]))fs['mkdirSync'](this[_0x323270(0x214)],{'recursive':!![]});if(!fs[_0x323270(0x1d4)](this['sitemapsDir']))fs['mkdirSync'](this[_0x323270(0x202)],{'recursive':!![]});}[a1_0x2ff153(0x1d1)](_0x2a8f68,_0x526a97){const _0x2b9f30=a1_0x2ff153,_0x5c40ea=_0x526a97[_0x2b9f30(0x1f9)]+'/'+_0x526a97['slug'];if(!this[_0x2b9f30(0x1e3)][_0x2b9f30(0x1eb)](_0x5c40ea)){const _0x490f8f=path[_0x2b9f30(0x209)](this[_0x2b9f30(0x1d0)],_0x526a97['category'],_0x526a97['slug']+_0x2b9f30(0x213));if(fs[_0x2b9f30(0x1d4)](_0x490f8f))try{const _0x58c3e8=JSON['parse'](fs[_0x2b9f30(0x1ed)](_0x490f8f,'utf-8'));this[_0x2b9f30(0x1e3)][_0x2b9f30(0x1f3)](_0x5c40ea,_0x58c3e8);}catch(_0x5829f9){this[_0x2b9f30(0x1e3)][_0x2b9f30(0x1f3)](_0x5c40ea,[]);}else this[_0x2b9f30(0x1e3)][_0x2b9f30(0x1f3)](_0x5c40ea,[]);}const _0x245931=this[_0x2b9f30(0x1e3)][_0x2b9f30(0x1e4)](_0x5c40ea);!_0x245931[_0x2b9f30(0x1f1)](_0x403a15=>_0x403a15[_0x2b9f30(0x1e2)]===_0x2a8f68['link'])&&_0x245931[_0x2b9f30(0x1da)](_0x2a8f68);}async[a1_0x2ff153(0x1e8)](){const _0x14d78d=a1_0x2ff153;console[_0x14d78d(0x1e1)](_0x14d78d(0x204));const _0x53b3d7=[],_0x24ee5f={};for(const [_0x2537fb,_0x5af1b3]of this[_0x14d78d(0x1e3)][_0x14d78d(0x1d2)]()){const [_0x5db25d,_0x2d687d]=_0x2537fb[_0x14d78d(0x1dc)]('/');_0x5af1b3[_0x14d78d(0x201)]((_0xe30ec0,_0x37a0ae)=>new Date(_0x37a0ae['created_at'])['getTime']()-new Date(_0xe30ec0[_0x14d78d(0x1e6)])[_0x14d78d(0x211)]());if(_0x5af1b3['length']<0x3)continue;const _0xda7250=new Date(_0x5af1b3[0x0][_0x14d78d(0x1e6)]),_0xe76590=(Date[_0x14d78d(0x207)]()-_0xda7250['getTime']())/(0x3e8*0x3c*0x3c*0x18);if(_0xe76590>0x3c)continue;const _0x545333=path[_0x14d78d(0x209)](this['dataDir'],_0x5db25d);if(!fs[_0x14d78d(0x1d4)](_0x545333))fs[_0x14d78d(0x20d)](_0x545333,{'recursive':!![]});const _0x407c2f=_0x5af1b3['slice'](0x0,0x64);fs[_0x14d78d(0x1d9)](path[_0x14d78d(0x209)](_0x545333,_0x2d687d+_0x14d78d(0x213)),JSON['stringify'](_0x407c2f,null,0x2));const _0x350528={'params':{'category':_0x5db25d,'slug':_0x2d687d},'lastUpdated':new Date()[_0x14d78d(0x1ef)](),'count':_0x5af1b3['length']};if(!_0x24ee5f[_0x5db25d])_0x24ee5f[_0x5db25d]=[];_0x24ee5f[_0x5db25d][_0x14d78d(0x1da)](_0x350528),_0x53b3d7['push']({'category':_0x5db25d,'slug':_0x2d687d});}for(const _0x5176df in _0x24ee5f){fs[_0x14d78d(0x1d9)](path[_0x14d78d(0x209)](this['manifestsDir'],_0x5176df+'.json'),JSON['stringify'](_0x24ee5f[_0x5176df],null,0x2)),this[_0x14d78d(0x1fa)](_0x5176df,_0x24ee5f[_0x5176df]);}this[_0x14d78d(0x20f)](Object[_0x14d78d(0x205)](_0x24ee5f));const _0x442243=Object[_0x14d78d(0x1ce)](_0x24ee5f)[_0x14d78d(0x203)]();fs['writeFileSync'](path[_0x14d78d(0x209)](this['outputDir'],_0x14d78d(0x1e0)),JSON[_0x14d78d(0x1fc)](_0x442243,null,0x2));}[a1_0x2ff153(0x1fa)](_0x42b643,_0x46fa03){const _0x55039d=a1_0x2ff153,_0x29e6a0=_0x55039d(0x1fd)+_0x46fa03['map'](_0xb68bf5=>_0x55039d(0x1d6)+this[_0x55039d(0x1df)]+'/'+_0xb68bf5[_0x55039d(0x20c)][_0x55039d(0x1f9)]+'/'+_0xb68bf5['params'][_0x55039d(0x1ff)]+_0x55039d(0x1cc)+_0xb68bf5['lastUpdated'][_0x55039d(0x1dc)]('T')[0x0]+_0x55039d(0x1fb))[_0x55039d(0x209)]('\x0a')+_0x55039d(0x1e5);fs[_0x55039d(0x1d9)](path['join'](this[_0x55039d(0x202)],_0x42b643+'.xml'),_0x29e6a0);}[a1_0x2ff153(0x20f)](_0x16fbee){const _0x576bed=a1_0x2ff153,_0x59d5a2=_0x576bed(0x208)+_0x16fbee[_0x576bed(0x1f6)](_0x11a6dd=>_0x576bed(0x210)+this['baseUrl']+'/sitemaps/'+_0x11a6dd+_0x576bed(0x212)+new Date()[_0x576bed(0x1ef)]()[_0x576bed(0x1dc)]('T')[0x0]+'</lastmod>\x0a\x20\x20</sitemap>')[_0x576bed(0x209)]('\x0a')+_0x576bed(0x1f4);fs['writeFileSync'](path['join'](this[_0x576bed(0x1e7)],'sitemap-index.xml'),_0x59d5a2);}}exports[a1_0x2ff153(0x20e)]=BucketManager;